{"version":3,"file":"509.bundle.js","mappings":"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","sources":["webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/sdfShader/shader-bits/localUniformMSDFBit.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/sdfShader/shader-bits/mSDFBit.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/sdfShader/SdfShader.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-bitmap/AbstractBitmapFont.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-bitmap/DynamicBitmapFont.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-bitmap/utils/getBitmapTextLayout.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-bitmap/BitmapFontManager.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-bitmap/utils/resolveCharacters.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-bitmap/BitmapTextPipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-bitmap/init.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/canvas/utils/fontStringFromTextStyle.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/rendering/high-shader/shader-bits/localUniformBit.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/utils/updateTextBounds.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/utils/getPo2TextureFromSource.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/BatchableHTMLText.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/HTMLTextPipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/HTMLTextRenderData.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/utils/getFontCss.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/utils/measureHtmlText.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/HTMLTextSystem.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/utils/extractFontFamilies.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/utils/loadFontCSS.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/utils/loadFontAsBase64.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/utils/getSVGUrl.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/utils/loadSVGImage.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/utils/browser/isSafari.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/utils/getTemporaryCanvasFromImage.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text-html/init.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/graphics/gpu/colorToUniform.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/canvas/utils/getCanvasFillStyle.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/filters/FilterPipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/filters/defaults/passthrough/passthrough.wgsl.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/filters/defaults/passthrough/PassthroughFilter.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/filters/defaults/defaultFilter.vert.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/filters/defaults/passthrough/passthrough.frag.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/container/bounds/getRenderableBounds.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/filters/FilterSystem.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/filters/init.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/canvas/CanvasTextMetrics.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/app/ResizePlugin.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/app/TickerPlugin.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/app/init.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/mesh/shared/MeshGeometry.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/canvas/BatchableText.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/canvas/CanvasTextPipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/utils/canvas/getCanvasBoundingBox.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/canvas/CanvasTextGenerator.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/canvas/CanvasTextSystem.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/init.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/mesh/shared/MeshPipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/mesh/init.mjs","webpack://tetris-game/./node_modules/tiny-lru/dist/tiny-lru.js","webpack://tetris-game/./node_modules/pixi.js/lib/filters/Filter.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/mesh-plane/PlaneGeometry.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-nine-slice/NineSliceGeometry.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-nine-slice/NineSliceSpritePipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-nine-slice/init.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/rendering/renderers/shared/state/State.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/rendering/renderers/shared/texture/CanvasPool.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/text/TextStyle.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite/BatchableSprite.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-tiling/shader/tilingBit.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-tiling/shader/TilingSpriteShader.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-tiling/utils/QuadGeometry.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-tiling/TilingSpritePipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-tiling/utils/setUvs.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-tiling/utils/applyMatrix.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-tiling/utils/setPositions.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/sprite-tiling/init.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/mesh/shared/BatchableMesh.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/graphics/shared/GraphicsPipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/graphics/init.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/gl/GlParticleContainerAdaptor.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/utils/createIndicesForQuads.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/utils/generateParticleUpdateFunction.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/ParticleBuffer.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/shader/particles.wgsl.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/shader/ParticleShader.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/shader/particles.vert.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/shader/particles.frag.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/ParticleContainerPipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/GlParticleContainerPipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/gpu/GpuParticleContainerAdaptor.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/shared/GpuParticleContainerPipe.mjs","webpack://tetris-game/./node_modules/pixi.js/lib/scene/particle-container/init.mjs"],"sourcesContent":["\"use strict\";\nconst localUniformMSDFBit = {\n  name: \"local-uniform-msdf-bit\",\n  vertex: {\n    header: (\n      /* wgsl */\n      `\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32,\n                uRound:f32,\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        `\n    ),\n    main: (\n      /* wgsl */\n      `\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        `\n    ),\n    end: (\n      /* wgsl */\n      `\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        `\n    )\n  },\n  fragment: {\n    header: (\n      /* wgsl */\n      `\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n         `\n    ),\n    main: (\n      /* wgsl */\n      `\n            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));\n        `\n    )\n  }\n};\nconst localUniformMSDFBitGl = {\n  name: \"local-uniform-msdf-bit\",\n  vertex: {\n    header: (\n      /* glsl */\n      `\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        `\n    ),\n    main: (\n      /* glsl */\n      `\n            vColor *= uColor;\n            modelMatrix *= uTransformMatrix;\n        `\n    ),\n    end: (\n      /* glsl */\n      `\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        `\n    )\n  },\n  fragment: {\n    header: (\n      /* glsl */\n      `\n            uniform float uDistance;\n         `\n    ),\n    main: (\n      /* glsl */\n      `\n            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));\n        `\n    )\n  }\n};\n\nexport { localUniformMSDFBit, localUniformMSDFBitGl };\n//# sourceMappingURL=localUniformMSDFBit.mjs.map\n","\"use strict\";\nconst mSDFBit = {\n  name: \"msdf-bit\",\n  fragment: {\n    header: (\n      /* wgsl */\n      `\n            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {\n\n                // MSDF\n                var median = msdfColor.r + msdfColor.g + msdfColor.b -\n                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n\n                // SDF\n                median = min(median, msdfColor.a);\n\n                var screenPxDistance = distance * (median - 0.5);\n                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));\n                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);\n                var coverage: f32 = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n\n            }\n        `\n    )\n  }\n};\nconst mSDFBitGl = {\n  name: \"msdf-bit\",\n  fragment: {\n    header: (\n      /* glsl */\n      `\n            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {\n\n                // MSDF\n                float median = msdfColor.r + msdfColor.g + msdfColor.b -\n                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n\n                // SDF\n                median = min(median, msdfColor.a);\n\n                float screenPxDistance = distance * (median - 0.5);\n                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));\n                float gamma = mix(1.0, 1.0 / 2.2, luma);\n                float coverage = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n            }\n        `\n    )\n  }\n};\n\nexport { mSDFBit, mSDFBitGl };\n//# sourceMappingURL=mSDFBit.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { compileHighShaderGpuProgram, compileHighShaderGlProgram } from '../../../rendering/high-shader/compileHighShaderToProgram.mjs';\nimport { colorBit, colorBitGl } from '../../../rendering/high-shader/shader-bits/colorBit.mjs';\nimport { generateTextureBatchBit, generateTextureBatchBitGl } from '../../../rendering/high-shader/shader-bits/generateTextureBatchBit.mjs';\nimport { roundPixelsBit, roundPixelsBitGl } from '../../../rendering/high-shader/shader-bits/roundPixelsBit.mjs';\nimport { getBatchSamplersUniformGroup } from '../../../rendering/renderers/gl/shader/getBatchSamplersUniformGroup.mjs';\nimport { Shader } from '../../../rendering/renderers/shared/shader/Shader.mjs';\nimport { UniformGroup } from '../../../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { localUniformMSDFBit, localUniformMSDFBitGl } from './shader-bits/localUniformMSDFBit.mjs';\nimport { mSDFBit, mSDFBitGl } from './shader-bits/mSDFBit.mjs';\n\n\"use strict\";\nlet gpuProgram;\nlet glProgram;\nclass SdfShader extends Shader {\n  constructor(maxTextures) {\n    const uniforms = new UniformGroup({\n      uColor: { value: new Float32Array([1, 1, 1, 1]), type: \"vec4<f32>\" },\n      uTransformMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uDistance: { value: 4, type: \"f32\" },\n      uRound: { value: 0, type: \"f32\" }\n    });\n    gpuProgram ?? (gpuProgram = compileHighShaderGpuProgram({\n      name: \"sdf-shader\",\n      bits: [\n        colorBit,\n        generateTextureBatchBit(maxTextures),\n        localUniformMSDFBit,\n        mSDFBit,\n        roundPixelsBit\n      ]\n    }));\n    glProgram ?? (glProgram = compileHighShaderGlProgram({\n      name: \"sdf-shader\",\n      bits: [\n        colorBitGl,\n        generateTextureBatchBitGl(maxTextures),\n        localUniformMSDFBitGl,\n        mSDFBitGl,\n        roundPixelsBitGl\n      ]\n    }));\n    super({\n      glProgram,\n      gpuProgram,\n      resources: {\n        localUniforms: uniforms,\n        batchSamplers: getBatchSamplersUniformGroup(maxTextures)\n      }\n    });\n  }\n}\n\nexport { SdfShader };\n//# sourceMappingURL=SdfShader.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nclass AbstractBitmapFont extends EventEmitter {\n  constructor() {\n    super(...arguments);\n    /** The map of characters by character code. */\n    this.chars = /* @__PURE__ */ Object.create(null);\n    /**\n     * The line-height of the font face in pixels.\n     * @type {number}\n     */\n    this.lineHeight = 0;\n    /**\n     * The name of the font face\n     * @type {string}\n     */\n    this.fontFamily = \"\";\n    /** The metrics of the font face. */\n    this.fontMetrics = { fontSize: 0, ascent: 0, descent: 0 };\n    /**\n     * The offset of the font face from the baseline.\n     * @type {number}\n     */\n    this.baseLineOffset = 0;\n    /** The range and type of the distance field for this font. */\n    this.distanceField = { type: \"none\", range: 0 };\n    /** The map of base page textures (i.e., sheets of glyphs). */\n    this.pages = [];\n    /** should the fill for this font be applied as a tint to the text. */\n    this.applyFillAsTint = true;\n    /** The size of the font face in pixels. */\n    this.baseMeasurementFontSize = 100;\n    this.baseRenderedFontSize = 100;\n  }\n  /**\n   * The name of the font face.\n   * @deprecated since 8.0.0 Use `fontFamily` instead.\n   */\n  get font() {\n    deprecation(v8_0_0, \"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead.\");\n    return this.fontFamily;\n  }\n  /**\n   * The map of base page textures (i.e., sheets of glyphs).\n   * @deprecated since 8.0.0 Use `pages` instead.\n   */\n  get pageTextures() {\n    deprecation(v8_0_0, \"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.\");\n    return this.pages;\n  }\n  /**\n   * The size of the font face in pixels.\n   * @deprecated since 8.0.0 Use `fontMetrics.fontSize` instead.\n   */\n  get size() {\n    deprecation(v8_0_0, \"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead.\");\n    return this.fontMetrics.fontSize;\n  }\n  /**\n   * The kind of distance field for this font or \"none\".\n   * @deprecated since 8.0.0 Use `distanceField.type` instead.\n   */\n  get distanceFieldRange() {\n    deprecation(v8_0_0, \"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead.\");\n    return this.distanceField.range;\n  }\n  /**\n   * The range of the distance field in pixels.\n   * @deprecated since 8.0.0 Use `distanceField.range` instead.\n   */\n  get distanceFieldType() {\n    deprecation(v8_0_0, \"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead.\");\n    return this.distanceField.type;\n  }\n  destroy(destroyTextures = false) {\n    this.emit(\"destroy\", this);\n    this.removeAllListeners();\n    for (const i in this.chars) {\n      this.chars[i].texture?.destroy();\n    }\n    this.chars = null;\n    if (destroyTextures) {\n      this.pages.forEach((page) => page.texture.destroy(true));\n      this.pages = null;\n    }\n  }\n}\n\nexport { AbstractBitmapFont };\n//# sourceMappingURL=AbstractBitmapFont.mjs.map\n","import { Color } from '../../color/Color.mjs';\nimport { Rectangle } from '../../maths/shapes/Rectangle.mjs';\nimport { CanvasPool } from '../../rendering/renderers/shared/texture/CanvasPool.mjs';\nimport { ImageSource } from '../../rendering/renderers/shared/texture/sources/ImageSource.mjs';\nimport { Texture } from '../../rendering/renderers/shared/texture/Texture.mjs';\nimport { TextureStyle } from '../../rendering/renderers/shared/texture/TextureStyle.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { fontStringFromTextStyle } from '../text/canvas/utils/fontStringFromTextStyle.mjs';\nimport { getCanvasFillStyle } from '../text/canvas/utils/getCanvasFillStyle.mjs';\nimport { TextStyle } from '../text/TextStyle.mjs';\nimport { AbstractBitmapFont } from './AbstractBitmapFont.mjs';\n\n\"use strict\";\nconst _DynamicBitmapFont = class _DynamicBitmapFont extends AbstractBitmapFont {\n  /**\n   * @param options - The options for the dynamic bitmap font.\n   */\n  constructor(options) {\n    super();\n    /**\n     * this is a resolution modifier for the font size..\n     * texture resolution will also be used to scale texture according to its font size also\n     */\n    this.resolution = 1;\n    /** The pages of the font. */\n    this.pages = [];\n    this._padding = 0;\n    this._measureCache = /* @__PURE__ */ Object.create(null);\n    this._currentChars = [];\n    this._currentX = 0;\n    this._currentY = 0;\n    this._currentMaxCharHeight = 0;\n    this._currentPageIndex = -1;\n    this._skipKerning = false;\n    const dynamicOptions = { ..._DynamicBitmapFont.defaultOptions, ...options };\n    this._textureSize = dynamicOptions.textureSize;\n    this._mipmap = dynamicOptions.mipmap;\n    const style = dynamicOptions.style.clone();\n    if (dynamicOptions.overrideFill) {\n      style._fill.color = 16777215;\n      style._fill.alpha = 1;\n      style._fill.texture = Texture.WHITE;\n      style._fill.fill = null;\n    }\n    this.applyFillAsTint = dynamicOptions.overrideFill;\n    const requestedFontSize = style.fontSize;\n    style.fontSize = this.baseMeasurementFontSize;\n    const font = fontStringFromTextStyle(style);\n    if (dynamicOptions.overrideSize) {\n      if (style._stroke) {\n        style._stroke.width *= this.baseRenderedFontSize / requestedFontSize;\n      }\n    } else {\n      style.fontSize = this.baseRenderedFontSize = requestedFontSize;\n    }\n    this._style = style;\n    this._skipKerning = dynamicOptions.skipKerning ?? false;\n    this.resolution = dynamicOptions.resolution ?? 1;\n    this._padding = dynamicOptions.padding ?? 4;\n    if (dynamicOptions.textureStyle) {\n      this._textureStyle = dynamicOptions.textureStyle instanceof TextureStyle ? dynamicOptions.textureStyle : new TextureStyle(dynamicOptions.textureStyle);\n    }\n    this.fontMetrics = CanvasTextMetrics.measureFont(font);\n    this.lineHeight = style.lineHeight || this.fontMetrics.fontSize || style.fontSize;\n  }\n  ensureCharacters(chars) {\n    const charList = CanvasTextMetrics.graphemeSegmenter(chars).filter((char) => !this._currentChars.includes(char)).filter((char, index, self) => self.indexOf(char) === index);\n    if (!charList.length)\n      return;\n    this._currentChars = [...this._currentChars, ...charList];\n    let pageData;\n    if (this._currentPageIndex === -1) {\n      pageData = this._nextPage();\n    } else {\n      pageData = this.pages[this._currentPageIndex];\n    }\n    let { canvas, context } = pageData.canvasAndContext;\n    let textureSource = pageData.texture.source;\n    const style = this._style;\n    let currentX = this._currentX;\n    let currentY = this._currentY;\n    let currentMaxCharHeight = this._currentMaxCharHeight;\n    const fontScale = this.baseRenderedFontSize / this.baseMeasurementFontSize;\n    const padding = this._padding * fontScale;\n    let skipTexture = false;\n    const maxTextureWidth = canvas.width / this.resolution;\n    const maxTextureHeight = canvas.height / this.resolution;\n    for (let i = 0; i < charList.length; i++) {\n      const char = charList[i];\n      const metrics = CanvasTextMetrics.measureText(char, style, canvas, false);\n      metrics.lineHeight = metrics.height;\n      const width = metrics.width * fontScale;\n      const textureGlyphWidth = Math.ceil((style.fontStyle === \"italic\" ? 2 : 1) * width);\n      const height = metrics.height * fontScale;\n      const paddedWidth = textureGlyphWidth + padding * 2;\n      const paddedHeight = height + padding * 2;\n      skipTexture = false;\n      if (char !== \"\\n\" && char !== \"\\r\" && char !== \"\t\" && char !== \" \") {\n        skipTexture = true;\n        currentMaxCharHeight = Math.ceil(Math.max(paddedHeight, currentMaxCharHeight));\n      }\n      if (currentX + paddedWidth > maxTextureWidth) {\n        currentY += currentMaxCharHeight;\n        currentMaxCharHeight = paddedHeight;\n        currentX = 0;\n        if (currentY + currentMaxCharHeight > maxTextureHeight) {\n          textureSource.update();\n          const pageData2 = this._nextPage();\n          canvas = pageData2.canvasAndContext.canvas;\n          context = pageData2.canvasAndContext.context;\n          textureSource = pageData2.texture.source;\n          currentX = 0;\n          currentY = 0;\n          currentMaxCharHeight = 0;\n        }\n      }\n      const xAdvance = width / fontScale - (style.dropShadow?.distance ?? 0) - (style._stroke?.width ?? 0);\n      this.chars[char] = {\n        id: char.codePointAt(0),\n        xOffset: -this._padding,\n        yOffset: -this._padding,\n        xAdvance,\n        kerning: {}\n      };\n      if (skipTexture) {\n        this._drawGlyph(\n          context,\n          metrics,\n          currentX + padding,\n          currentY + padding,\n          fontScale,\n          style\n        );\n        const px = textureSource.width * fontScale;\n        const py = textureSource.height * fontScale;\n        const frame = new Rectangle(\n          currentX / px * textureSource.width,\n          currentY / py * textureSource.height,\n          paddedWidth / px * textureSource.width,\n          paddedHeight / py * textureSource.height\n        );\n        this.chars[char].texture = new Texture({\n          source: textureSource,\n          frame\n        });\n        currentX += Math.ceil(paddedWidth);\n      }\n    }\n    textureSource.update();\n    this._currentX = currentX;\n    this._currentY = currentY;\n    this._currentMaxCharHeight = currentMaxCharHeight;\n    this._skipKerning && this._applyKerning(charList, context);\n  }\n  /**\n   * @deprecated since 8.0.0\n   * The map of base page textures (i.e., sheets of glyphs).\n   */\n  get pageTextures() {\n    deprecation(v8_0_0, \"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.\");\n    return this.pages;\n  }\n  _applyKerning(newChars, context) {\n    const measureCache = this._measureCache;\n    for (let i = 0; i < newChars.length; i++) {\n      const first = newChars[i];\n      for (let j = 0; j < this._currentChars.length; j++) {\n        const second = this._currentChars[j];\n        let c1 = measureCache[first];\n        if (!c1)\n          c1 = measureCache[first] = context.measureText(first).width;\n        let c2 = measureCache[second];\n        if (!c2)\n          c2 = measureCache[second] = context.measureText(second).width;\n        let total = context.measureText(first + second).width;\n        let amount = total - (c1 + c2);\n        if (amount) {\n          this.chars[first].kerning[second] = amount;\n        }\n        total = context.measureText(first + second).width;\n        amount = total - (c1 + c2);\n        if (amount) {\n          this.chars[second].kerning[first] = amount;\n        }\n      }\n    }\n  }\n  _nextPage() {\n    this._currentPageIndex++;\n    const textureResolution = this.resolution;\n    const canvasAndContext = CanvasPool.getOptimalCanvasAndContext(\n      this._textureSize,\n      this._textureSize,\n      textureResolution\n    );\n    this._setupContext(canvasAndContext.context, this._style, textureResolution);\n    const resolution = textureResolution * (this.baseRenderedFontSize / this.baseMeasurementFontSize);\n    const texture = new Texture({\n      source: new ImageSource({\n        resource: canvasAndContext.canvas,\n        resolution,\n        alphaMode: \"premultiply-alpha-on-upload\",\n        autoGenerateMipmaps: this._mipmap\n      })\n    });\n    if (this._textureStyle) {\n      texture.source.style = this._textureStyle;\n    }\n    const pageData = {\n      canvasAndContext,\n      texture\n    };\n    this.pages[this._currentPageIndex] = pageData;\n    return pageData;\n  }\n  // canvas style!\n  _setupContext(context, style, resolution) {\n    style.fontSize = this.baseRenderedFontSize;\n    context.scale(resolution, resolution);\n    context.font = fontStringFromTextStyle(style);\n    style.fontSize = this.baseMeasurementFontSize;\n    context.textBaseline = style.textBaseline;\n    const stroke = style._stroke;\n    const strokeThickness = stroke?.width ?? 0;\n    if (stroke) {\n      context.lineWidth = strokeThickness;\n      context.lineJoin = stroke.join;\n      context.miterLimit = stroke.miterLimit;\n      context.strokeStyle = getCanvasFillStyle(stroke, context);\n    }\n    if (style._fill) {\n      context.fillStyle = getCanvasFillStyle(style._fill, context);\n    }\n    if (style.dropShadow) {\n      const shadowOptions = style.dropShadow;\n      const rgb = Color.shared.setValue(shadowOptions.color).toArray();\n      const dropShadowBlur = shadowOptions.blur * resolution;\n      const dropShadowDistance = shadowOptions.distance * resolution;\n      context.shadowColor = `rgba(${rgb[0] * 255},${rgb[1] * 255},${rgb[2] * 255},${shadowOptions.alpha})`;\n      context.shadowBlur = dropShadowBlur;\n      context.shadowOffsetX = Math.cos(shadowOptions.angle) * dropShadowDistance;\n      context.shadowOffsetY = Math.sin(shadowOptions.angle) * dropShadowDistance;\n    } else {\n      context.shadowColor = \"black\";\n      context.shadowBlur = 0;\n      context.shadowOffsetX = 0;\n      context.shadowOffsetY = 0;\n    }\n  }\n  _drawGlyph(context, metrics, x, y, fontScale, style) {\n    const char = metrics.text;\n    const fontProperties = metrics.fontProperties;\n    const stroke = style._stroke;\n    const strokeThickness = (stroke?.width ?? 0) * fontScale;\n    const tx = x + strokeThickness / 2;\n    const ty = y - strokeThickness / 2;\n    const descent = fontProperties.descent * fontScale;\n    const lineHeight = metrics.lineHeight * fontScale;\n    let removeShadow = false;\n    if (style.stroke && strokeThickness) {\n      removeShadow = true;\n      context.strokeText(char, tx, ty + lineHeight - descent);\n    }\n    const { shadowBlur, shadowOffsetX, shadowOffsetY } = context;\n    if (style._fill) {\n      if (removeShadow) {\n        context.shadowBlur = 0;\n        context.shadowOffsetX = 0;\n        context.shadowOffsetY = 0;\n      }\n      context.fillText(char, tx, ty + lineHeight - descent);\n    }\n    if (removeShadow) {\n      context.shadowBlur = shadowBlur;\n      context.shadowOffsetX = shadowOffsetX;\n      context.shadowOffsetY = shadowOffsetY;\n    }\n  }\n  destroy() {\n    super.destroy();\n    for (let i = 0; i < this.pages.length; i++) {\n      const { canvasAndContext, texture } = this.pages[i];\n      CanvasPool.returnCanvasAndContext(canvasAndContext);\n      texture.destroy(true);\n    }\n    this.pages = null;\n  }\n};\n_DynamicBitmapFont.defaultOptions = {\n  textureSize: 512,\n  style: new TextStyle(),\n  mipmap: true\n};\nlet DynamicBitmapFont = _DynamicBitmapFont;\n\nexport { DynamicBitmapFont };\n//# sourceMappingURL=DynamicBitmapFont.mjs.map\n","\"use strict\";\nfunction getBitmapTextLayout(chars, style, font, trimEnd) {\n  const layoutData = {\n    width: 0,\n    height: 0,\n    offsetY: 0,\n    scale: style.fontSize / font.baseMeasurementFontSize,\n    lines: [{\n      width: 0,\n      charPositions: [],\n      spaceWidth: 0,\n      spacesIndex: [],\n      chars: []\n    }]\n  };\n  layoutData.offsetY = font.baseLineOffset;\n  let currentLine = layoutData.lines[0];\n  let previousChar = null;\n  let firstWord = true;\n  const currentWord = {\n    spaceWord: false,\n    width: 0,\n    start: 0,\n    index: 0,\n    // use index to not modify the array as we use it a lot!\n    positions: [],\n    chars: []\n  };\n  const scale = font.baseMeasurementFontSize / style.fontSize;\n  const adjustedLetterSpacing = style.letterSpacing * scale;\n  const adjustedWordWrapWidth = style.wordWrapWidth * scale;\n  const adjustedLineHeight = style.lineHeight ? style.lineHeight * scale : font.lineHeight;\n  const breakWords = style.wordWrap && style.breakWords;\n  const nextWord = (word) => {\n    const start = currentLine.width;\n    for (let j = 0; j < currentWord.index; j++) {\n      const position = word.positions[j];\n      currentLine.chars.push(word.chars[j]);\n      currentLine.charPositions.push(position + start);\n    }\n    currentLine.width += word.width;\n    firstWord = false;\n    currentWord.width = 0;\n    currentWord.index = 0;\n    currentWord.chars.length = 0;\n  };\n  const nextLine = () => {\n    let index = currentLine.chars.length - 1;\n    if (trimEnd) {\n      let lastChar = currentLine.chars[index];\n      while (lastChar === \" \") {\n        currentLine.width -= font.chars[lastChar].xAdvance;\n        lastChar = currentLine.chars[--index];\n      }\n    }\n    layoutData.width = Math.max(layoutData.width, currentLine.width);\n    currentLine = {\n      width: 0,\n      charPositions: [],\n      chars: [],\n      spaceWidth: 0,\n      spacesIndex: []\n    };\n    firstWord = true;\n    layoutData.lines.push(currentLine);\n    layoutData.height += adjustedLineHeight;\n  };\n  const checkIsOverflow = (lineWidth) => lineWidth - adjustedLetterSpacing > adjustedWordWrapWidth;\n  for (let i = 0; i < chars.length + 1; i++) {\n    let char;\n    const isEnd = i === chars.length;\n    if (!isEnd) {\n      char = chars[i];\n    }\n    const charData = font.chars[char] || font.chars[\" \"];\n    const isSpace = /(?:\\s)/.test(char);\n    const isWordBreak = isSpace || char === \"\\r\" || char === \"\\n\" || isEnd;\n    if (isWordBreak) {\n      const addWordToNextLine = !firstWord && style.wordWrap && checkIsOverflow(currentLine.width + currentWord.width);\n      if (addWordToNextLine) {\n        nextLine();\n        nextWord(currentWord);\n        if (!isEnd) {\n          currentLine.charPositions.push(0);\n        }\n      } else {\n        currentWord.start = currentLine.width;\n        nextWord(currentWord);\n        if (!isEnd) {\n          currentLine.charPositions.push(0);\n        }\n      }\n      if (char === \"\\r\" || char === \"\\n\") {\n        nextLine();\n      } else if (!isEnd) {\n        const spaceWidth = charData.xAdvance + (charData.kerning[previousChar] || 0) + adjustedLetterSpacing;\n        currentLine.width += spaceWidth;\n        currentLine.spaceWidth = spaceWidth;\n        currentLine.spacesIndex.push(currentLine.charPositions.length);\n        currentLine.chars.push(char);\n      }\n    } else {\n      const kerning = charData.kerning[previousChar] || 0;\n      const nextCharWidth = charData.xAdvance + kerning + adjustedLetterSpacing;\n      const addWordToNextLine = breakWords && checkIsOverflow(currentLine.width + currentWord.width + nextCharWidth);\n      if (addWordToNextLine) {\n        nextWord(currentWord);\n        nextLine();\n      }\n      currentWord.positions[currentWord.index++] = currentWord.width + kerning;\n      currentWord.chars.push(char);\n      currentWord.width += nextCharWidth;\n    }\n    previousChar = char;\n  }\n  nextLine();\n  if (style.align === \"center\") {\n    alignCenter(layoutData);\n  } else if (style.align === \"right\") {\n    alignRight(layoutData);\n  } else if (style.align === \"justify\") {\n    alignJustify(layoutData);\n  }\n  return layoutData;\n}\nfunction alignCenter(measurementData) {\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    const offset = measurementData.width / 2 - line.width / 2;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      line.charPositions[j] += offset;\n    }\n  }\n}\nfunction alignRight(measurementData) {\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    const offset = measurementData.width - line.width;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      line.charPositions[j] += offset;\n    }\n  }\n}\nfunction alignJustify(measurementData) {\n  const width = measurementData.width;\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    let indy = 0;\n    let spaceIndex = line.spacesIndex[indy++];\n    let offset = 0;\n    const totalSpaces = line.spacesIndex.length;\n    const newSpaceWidth = (width - line.width) / totalSpaces;\n    const spaceWidth = newSpaceWidth;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      if (j === spaceIndex) {\n        spaceIndex = line.spacesIndex[indy++];\n        offset += spaceWidth;\n      }\n      line.charPositions[j] += offset;\n    }\n  }\n}\n\nexport { getBitmapTextLayout };\n//# sourceMappingURL=getBitmapTextLayout.mjs.map\n","import { lru } from 'tiny-lru';\nimport { Cache } from '../../assets/cache/Cache.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { TextStyle } from '../text/TextStyle.mjs';\nimport { DynamicBitmapFont } from './DynamicBitmapFont.mjs';\nimport { getBitmapTextLayout } from './utils/getBitmapTextLayout.mjs';\nimport { resolveCharacters } from './utils/resolveCharacters.mjs';\n\n\"use strict\";\nlet fontCount = 0;\nclass BitmapFontManagerClass {\n  constructor() {\n    /**\n     * This character set includes all the letters in the alphabet (both lower- and upper- case).\n     * @type {string[][]}\n     * @example\n     * BitmapFont.from('ExampleFont', style, { chars: BitmapFont.ALPHA })\n     */\n    this.ALPHA = [[\"a\", \"z\"], [\"A\", \"Z\"], \" \"];\n    /**\n     * This character set includes all decimal digits (from 0 to 9).\n     * @type {string[][]}\n     * @example\n     * BitmapFont.from('ExampleFont', style, { chars: BitmapFont.NUMERIC })\n     */\n    this.NUMERIC = [[\"0\", \"9\"]];\n    /**\n     * This character set is the union of `BitmapFont.ALPHA` and `BitmapFont.NUMERIC`.\n     * @type {string[][]}\n     */\n    this.ALPHANUMERIC = [[\"a\", \"z\"], [\"A\", \"Z\"], [\"0\", \"9\"], \" \"];\n    /**\n     * This character set consists of all the ASCII table.\n     * @type {string[][]}\n     * @see http://www.asciitable.com/\n     */\n    this.ASCII = [[\" \", \"~\"]];\n    /** Default options for installing a new BitmapFont. */\n    this.defaultOptions = {\n      chars: this.ALPHANUMERIC,\n      resolution: 1,\n      padding: 4,\n      skipKerning: false,\n      textureStyle: null\n    };\n    /** Cache for measured text layouts to avoid recalculating them multiple times. */\n    this.measureCache = lru(1e3);\n  }\n  /**\n   * Get a font for the specified text and style.\n   * @param text - The text to get the font for\n   * @param style - The style to use\n   */\n  getFont(text, style) {\n    let fontFamilyKey = `${style.fontFamily}-bitmap`;\n    let overrideFill = true;\n    if (style._fill.fill && !style._stroke) {\n      fontFamilyKey += style._fill.fill.styleKey;\n      overrideFill = false;\n    } else if (style._stroke || style.dropShadow) {\n      fontFamilyKey = `${style.styleKey}-bitmap`;\n      overrideFill = false;\n    }\n    if (!Cache.has(fontFamilyKey)) {\n      const styleCopy = Object.create(style);\n      styleCopy.lineHeight = 0;\n      const fnt = new DynamicBitmapFont({\n        style: styleCopy,\n        overrideFill,\n        overrideSize: true,\n        ...this.defaultOptions\n      });\n      fontCount++;\n      if (fontCount > 50) {\n        warn(\"BitmapText\", `You have dynamically created ${fontCount} bitmap fonts, this can be inefficient. Try pre installing your font styles using \\`BitmapFont.install({name:\"style1\", style})\\``);\n      }\n      fnt.once(\"destroy\", () => {\n        fontCount--;\n        Cache.remove(fontFamilyKey);\n      });\n      Cache.set(\n        fontFamilyKey,\n        fnt\n      );\n    }\n    const dynamicFont = Cache.get(fontFamilyKey);\n    dynamicFont.ensureCharacters?.(text);\n    return dynamicFont;\n  }\n  /**\n   * Get the layout of a text for the specified style.\n   * @param text - The text to get the layout for\n   * @param style - The style to use\n   * @param trimEnd - Whether to ignore whitespaces at the end of each line\n   */\n  getLayout(text, style, trimEnd = true) {\n    const bitmapFont = this.getFont(text, style);\n    const id = `${text}-${style.styleKey}-${trimEnd}`;\n    if (this.measureCache.has(id)) {\n      return this.measureCache.get(id);\n    }\n    const segments = CanvasTextMetrics.graphemeSegmenter(text);\n    const layoutData = getBitmapTextLayout(segments, style, bitmapFont, trimEnd);\n    this.measureCache.set(id, layoutData);\n    return layoutData;\n  }\n  /**\n   * Measure the text using the specified style.\n   * @param text - The text to measure\n   * @param style - The style to use\n   * @param trimEnd - Whether to ignore whitespaces at the end of each line\n   */\n  measureText(text, style, trimEnd = true) {\n    return this.getLayout(text, style, trimEnd);\n  }\n  // eslint-disable-next-line max-len\n  install(...args) {\n    let options = args[0];\n    if (typeof options === \"string\") {\n      options = {\n        name: options,\n        style: args[1],\n        chars: args[2]?.chars,\n        resolution: args[2]?.resolution,\n        padding: args[2]?.padding,\n        skipKerning: args[2]?.skipKerning\n      };\n      deprecation(v8_0_0, \"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})\");\n    }\n    const name = options?.name;\n    if (!name) {\n      throw new Error(\"[BitmapFontManager] Property `name` is required.\");\n    }\n    options = { ...this.defaultOptions, ...options };\n    const textStyle = options.style;\n    const style = textStyle instanceof TextStyle ? textStyle : new TextStyle(textStyle);\n    const overrideFill = options.dynamicFill ?? this._canUseTintForStyle(style);\n    const font = new DynamicBitmapFont({\n      style,\n      overrideFill,\n      skipKerning: options.skipKerning,\n      padding: options.padding,\n      resolution: options.resolution,\n      overrideSize: false,\n      textureStyle: options.textureStyle\n    });\n    const flatChars = resolveCharacters(options.chars);\n    font.ensureCharacters(flatChars.join(\"\"));\n    Cache.set(`${name}-bitmap`, font);\n    font.once(\"destroy\", () => Cache.remove(`${name}-bitmap`));\n    return font;\n  }\n  /**\n   * Uninstalls a bitmap font from the cache.\n   * @param {string} name - The name of the bitmap font to uninstall.\n   */\n  uninstall(name) {\n    const cacheKey = `${name}-bitmap`;\n    const font = Cache.get(cacheKey);\n    if (font) {\n      font.destroy();\n    }\n  }\n  /**\n   * Determines if a style can use tinting instead of baking colors into the bitmap.\n   * Tinting is more efficient as it allows reusing the same bitmap with different colors.\n   * @param style - The text style to evaluate\n   * @returns true if the style can use tinting, false if colors must be baked in\n   * @private\n   */\n  _canUseTintForStyle(style) {\n    return !style._stroke && (!style.dropShadow || style.dropShadow.color === 0) && !style._fill.fill && style._fill.color === 16777215;\n  }\n}\nconst BitmapFontManager = new BitmapFontManagerClass();\n\nexport { BitmapFontManager };\n//# sourceMappingURL=BitmapFontManager.mjs.map\n","\"use strict\";\nfunction resolveCharacters(chars) {\n  if (chars === \"\") {\n    return [];\n  }\n  if (typeof chars === \"string\") {\n    chars = [chars];\n  }\n  const result = [];\n  for (let i = 0, j = chars.length; i < j; i++) {\n    const item = chars[i];\n    if (Array.isArray(item)) {\n      if (item.length !== 2) {\n        throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${item.length}.`);\n      }\n      if (item[0].length === 0 || item[1].length === 0) {\n        throw new Error(\"[BitmapFont]: Invalid character delimiter.\");\n      }\n      const startCode = item[0].charCodeAt(0);\n      const endCode = item[1].charCodeAt(0);\n      if (endCode < startCode) {\n        throw new Error(\"[BitmapFont]: Invalid character range.\");\n      }\n      for (let i2 = startCode, j2 = endCode; i2 <= j2; i2++) {\n        result.push(String.fromCharCode(i2));\n      }\n    } else {\n      result.push(...Array.from(item));\n    }\n  }\n  if (result.length === 0) {\n    throw new Error(\"[BitmapFont]: Empty set when resolving characters.\");\n  }\n  return result;\n}\n\nexport { resolveCharacters };\n//# sourceMappingURL=resolveCharacters.mjs.map\n","import { Cache } from '../../assets/cache/Cache.mjs';\nimport { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { Graphics } from '../graphics/shared/Graphics.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { SdfShader } from '../text/sdfShader/SdfShader.mjs';\nimport { BitmapFontManager } from './BitmapFontManager.mjs';\nimport { getBitmapTextLayout } from './utils/getBitmapTextLayout.mjs';\n\n\"use strict\";\nclass BitmapTextGraphics extends Graphics {\n  destroy() {\n    if (this.context.customShader) {\n      this.context.customShader.destroy();\n    }\n    super.destroy();\n  }\n}\nclass BitmapTextPipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  validateRenderable(bitmapText) {\n    const graphicsRenderable = this._getGpuBitmapText(bitmapText);\n    return this._renderer.renderPipes.graphics.validateRenderable(graphicsRenderable);\n  }\n  addRenderable(bitmapText, instructionSet) {\n    const graphicsRenderable = this._getGpuBitmapText(bitmapText);\n    syncWithProxy(bitmapText, graphicsRenderable);\n    if (bitmapText._didTextUpdate) {\n      bitmapText._didTextUpdate = false;\n      this._updateContext(bitmapText, graphicsRenderable);\n    }\n    this._renderer.renderPipes.graphics.addRenderable(graphicsRenderable, instructionSet);\n    if (graphicsRenderable.context.customShader) {\n      this._updateDistanceField(bitmapText);\n    }\n  }\n  updateRenderable(bitmapText) {\n    const graphicsRenderable = this._getGpuBitmapText(bitmapText);\n    syncWithProxy(bitmapText, graphicsRenderable);\n    this._renderer.renderPipes.graphics.updateRenderable(graphicsRenderable);\n    if (graphicsRenderable.context.customShader) {\n      this._updateDistanceField(bitmapText);\n    }\n  }\n  _updateContext(bitmapText, proxyGraphics) {\n    const { context } = proxyGraphics;\n    const bitmapFont = BitmapFontManager.getFont(bitmapText.text, bitmapText._style);\n    context.clear();\n    if (bitmapFont.distanceField.type !== \"none\") {\n      if (!context.customShader) {\n        context.customShader = new SdfShader(this._renderer.limits.maxBatchableTextures);\n      }\n    }\n    const chars = CanvasTextMetrics.graphemeSegmenter(bitmapText.text);\n    const style = bitmapText._style;\n    let currentY = bitmapFont.baseLineOffset;\n    const bitmapTextLayout = getBitmapTextLayout(chars, style, bitmapFont, true);\n    const padding = style.padding;\n    const scale = bitmapTextLayout.scale;\n    let tx = bitmapTextLayout.width;\n    let ty = bitmapTextLayout.height + bitmapTextLayout.offsetY;\n    if (style._stroke) {\n      tx += style._stroke.width / scale;\n      ty += style._stroke.width / scale;\n    }\n    context.translate(-bitmapText._anchor._x * tx - padding, -bitmapText._anchor._y * ty - padding).scale(scale, scale);\n    const tint = bitmapFont.applyFillAsTint ? style._fill.color : 16777215;\n    let fontSize = bitmapFont.fontMetrics.fontSize;\n    let lineHeight = bitmapFont.lineHeight;\n    if (style.lineHeight) {\n      fontSize = style.fontSize / scale;\n      lineHeight = style.lineHeight / scale;\n    }\n    let linePositionYShift = (lineHeight - fontSize) / 2;\n    if (linePositionYShift - bitmapFont.baseLineOffset < 0) {\n      linePositionYShift = 0;\n    }\n    for (let i = 0; i < bitmapTextLayout.lines.length; i++) {\n      const line = bitmapTextLayout.lines[i];\n      for (let j = 0; j < line.charPositions.length; j++) {\n        const char = line.chars[j];\n        const charData = bitmapFont.chars[char];\n        if (charData?.texture) {\n          const texture = charData.texture;\n          context.texture(\n            texture,\n            tint ? tint : \"black\",\n            Math.round(line.charPositions[j] + charData.xOffset),\n            Math.round(currentY + charData.yOffset + linePositionYShift),\n            texture.orig.width,\n            texture.orig.height\n          );\n        }\n      }\n      currentY += lineHeight;\n    }\n  }\n  _getGpuBitmapText(bitmapText) {\n    return bitmapText._gpuData[this._renderer.uid] || this.initGpuText(bitmapText);\n  }\n  initGpuText(bitmapText) {\n    const proxyRenderable = new BitmapTextGraphics();\n    bitmapText._gpuData[this._renderer.uid] = proxyRenderable;\n    this._updateContext(bitmapText, proxyRenderable);\n    return proxyRenderable;\n  }\n  _updateDistanceField(bitmapText) {\n    const context = this._getGpuBitmapText(bitmapText).context;\n    const fontFamily = bitmapText._style.fontFamily;\n    const dynamicFont = Cache.get(`${fontFamily}-bitmap`);\n    const { a, b, c, d } = bitmapText.groupTransform;\n    const dx = Math.sqrt(a * a + b * b);\n    const dy = Math.sqrt(c * c + d * d);\n    const worldScale = (Math.abs(dx) + Math.abs(dy)) / 2;\n    const fontScale = dynamicFont.baseRenderedFontSize / bitmapText._style.fontSize;\n    const distance = worldScale * dynamicFont.distanceField.range * (1 / fontScale);\n    context.customShader.resources.localUniforms.uniforms.uDistance = distance;\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\n/** @ignore */\nBitmapTextPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"bitmapText\"\n};\nfunction syncWithProxy(container, proxy) {\n  proxy.groupTransform = container.groupTransform;\n  proxy.groupColorAlpha = container.groupColorAlpha;\n  proxy.groupColor = container.groupColor;\n  proxy.groupBlendMode = container.groupBlendMode;\n  proxy.globalDisplayStatus = container.globalDisplayStatus;\n  proxy.groupTransform = container.groupTransform;\n  proxy.localDisplayStatus = container.localDisplayStatus;\n  proxy.groupAlpha = container.groupAlpha;\n  proxy._roundPixels = container._roundPixels;\n}\n\nexport { BitmapTextGraphics, BitmapTextPipe };\n//# sourceMappingURL=BitmapTextPipe.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { BitmapTextPipe } from './BitmapTextPipe.mjs';\n\n\"use strict\";\nextensions.add(BitmapTextPipe);\n//# sourceMappingURL=init.mjs.map\n","\"use strict\";\nconst genericFontFamilies = [\n  \"serif\",\n  \"sans-serif\",\n  \"monospace\",\n  \"cursive\",\n  \"fantasy\",\n  \"system-ui\"\n];\nfunction fontStringFromTextStyle(style) {\n  const fontSizeString = typeof style.fontSize === \"number\" ? `${style.fontSize}px` : style.fontSize;\n  let fontFamilies = style.fontFamily;\n  if (!Array.isArray(style.fontFamily)) {\n    fontFamilies = style.fontFamily.split(\",\");\n  }\n  for (let i = fontFamilies.length - 1; i >= 0; i--) {\n    let fontFamily = fontFamilies[i].trim();\n    if (!/([\\\"\\'])[^\\'\\\"]+\\1/.test(fontFamily) && !genericFontFamilies.includes(fontFamily)) {\n      fontFamily = `\"${fontFamily}\"`;\n    }\n    fontFamilies[i] = fontFamily;\n  }\n  return `${style.fontStyle} ${style.fontVariant} ${style.fontWeight} ${fontSizeString} ${fontFamilies.join(\",\")}`;\n}\n\nexport { fontStringFromTextStyle };\n//# sourceMappingURL=fontStringFromTextStyle.mjs.map\n","\"use strict\";\nconst localUniformBit = {\n  name: \"local-uniform-bit\",\n  vertex: {\n    header: (\n      /* wgsl */\n      `\n\n            struct LocalUniforms {\n                uTransformMatrix:mat3x3<f32>,\n                uColor:vec4<f32>,\n                uRound:f32,\n            }\n\n            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        `\n    ),\n    main: (\n      /* wgsl */\n      `\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        `\n    ),\n    end: (\n      /* wgsl */\n      `\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        `\n    )\n  }\n};\nconst localUniformBitGroup2 = {\n  ...localUniformBit,\n  vertex: {\n    ...localUniformBit.vertex,\n    // replace the group!\n    header: localUniformBit.vertex.header.replace(\"group(1)\", \"group(2)\")\n  }\n};\nconst localUniformBitGl = {\n  name: \"local-uniform-bit\",\n  vertex: {\n    header: (\n      /* glsl */\n      `\n\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        `\n    ),\n    main: (\n      /* glsl */\n      `\n            vColor *= uColor;\n            modelMatrix = uTransformMatrix;\n        `\n    ),\n    end: (\n      /* glsl */\n      `\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        `\n    )\n  }\n};\n\nexport { localUniformBit, localUniformBitGl, localUniformBitGroup2 };\n//# sourceMappingURL=localUniformBit.mjs.map\n","import { updateQuadBounds } from '../../../utils/data/updateQuadBounds.mjs';\n\n\"use strict\";\nfunction updateTextBounds(batchableSprite, text) {\n  const { texture, bounds } = batchableSprite;\n  const padding = text._style._getFinalPadding();\n  updateQuadBounds(bounds, text._anchor, texture);\n  const paddingOffset = text._anchor._x * padding * 2;\n  const paddingOffsetY = text._anchor._y * padding * 2;\n  bounds.minX -= padding - paddingOffset;\n  bounds.minY -= padding - paddingOffsetY;\n  bounds.maxX -= padding - paddingOffset;\n  bounds.maxY -= padding - paddingOffsetY;\n}\n\nexport { updateTextBounds };\n//# sourceMappingURL=updateTextBounds.mjs.map\n","import { TexturePool } from '../../../rendering/renderers/shared/texture/TexturePool.mjs';\nimport { Bounds } from '../../container/bounds/Bounds.mjs';\n\n\"use strict\";\nconst tempBounds = new Bounds();\nfunction getPo2TextureFromSource(image, width, height, resolution) {\n  const bounds = tempBounds;\n  bounds.minX = 0;\n  bounds.minY = 0;\n  bounds.maxX = image.width / resolution | 0;\n  bounds.maxY = image.height / resolution | 0;\n  const texture = TexturePool.getOptimalTexture(\n    bounds.width,\n    bounds.height,\n    resolution,\n    false\n  );\n  texture.source.uploadMethodId = \"image\";\n  texture.source.resource = image;\n  texture.source.alphaMode = \"premultiply-alpha-on-upload\";\n  texture.frame.width = width / resolution;\n  texture.frame.height = height / resolution;\n  texture.source.emit(\"update\", texture.source);\n  texture.updateUvs();\n  return texture;\n}\n\nexport { getPo2TextureFromSource };\n//# sourceMappingURL=getPo2TextureFromSource.mjs.map\n","import { BatchableSprite } from '../sprite/BatchableSprite.mjs';\n\n\"use strict\";\nclass BatchableHTMLText extends BatchableSprite {\n  /**\n   * Creates an instance of BatchableHTMLText.\n   * @param renderer - The renderer instance to be used.\n   */\n  constructor(renderer) {\n    super();\n    this.generatingTexture = false;\n    this.currentKey = \"--\";\n    this._renderer = renderer;\n    renderer.runners.resolutionChange.add(this);\n  }\n  /** Handles resolution changes for the HTML text. If the text has auto resolution enabled, it triggers a view update. */\n  resolutionChange() {\n    const text = this.renderable;\n    if (text._autoResolution) {\n      text.onViewUpdate();\n    }\n  }\n  /** Destroys the BatchableHTMLText instance. Returns the texture promise to the renderer and cleans up references. */\n  destroy() {\n    const { htmlText } = this._renderer;\n    htmlText.getReferenceCount(this.currentKey) === null ? htmlText.returnTexturePromise(this.texturePromise) : htmlText.decreaseReferenceCount(this.currentKey);\n    this._renderer.runners.resolutionChange.remove(this);\n    this.texturePromise = null;\n    this._renderer = null;\n  }\n}\n\nexport { BatchableHTMLText };\n//# sourceMappingURL=BatchableHTMLText.mjs.map\n","import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { Texture } from '../../rendering/renderers/shared/texture/Texture.mjs';\nimport { updateTextBounds } from '../text/utils/updateTextBounds.mjs';\nimport { BatchableHTMLText } from './BatchableHTMLText.mjs';\n\n\"use strict\";\nclass HTMLTextPipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  validateRenderable(htmlText) {\n    const gpuText = this._getGpuText(htmlText);\n    const newKey = htmlText.styleKey;\n    if (gpuText.currentKey !== newKey) {\n      return true;\n    }\n    return false;\n  }\n  addRenderable(htmlText, instructionSet) {\n    const batchableHTMLText = this._getGpuText(htmlText);\n    if (htmlText._didTextUpdate) {\n      const resolution = htmlText._autoResolution ? this._renderer.resolution : htmlText.resolution;\n      if (batchableHTMLText.currentKey !== htmlText.styleKey || htmlText.resolution !== resolution) {\n        this._updateGpuText(htmlText).catch((e) => {\n          console.error(e);\n        });\n      }\n      htmlText._didTextUpdate = false;\n      updateTextBounds(batchableHTMLText, htmlText);\n    }\n    this._renderer.renderPipes.batch.addToBatch(batchableHTMLText, instructionSet);\n  }\n  updateRenderable(htmlText) {\n    const batchableHTMLText = this._getGpuText(htmlText);\n    batchableHTMLText._batcher.updateElement(batchableHTMLText);\n  }\n  async _updateGpuText(htmlText) {\n    htmlText._didTextUpdate = false;\n    const batchableHTMLText = this._getGpuText(htmlText);\n    if (batchableHTMLText.generatingTexture)\n      return;\n    const oldTexturePromise = batchableHTMLText.texturePromise;\n    batchableHTMLText.texturePromise = null;\n    batchableHTMLText.generatingTexture = true;\n    htmlText._resolution = htmlText._autoResolution ? this._renderer.resolution : htmlText.resolution;\n    let texturePromise = this._renderer.htmlText.getTexturePromise(htmlText);\n    if (oldTexturePromise) {\n      texturePromise = texturePromise.finally(() => {\n        this._renderer.htmlText.decreaseReferenceCount(batchableHTMLText.currentKey);\n        this._renderer.htmlText.returnTexturePromise(oldTexturePromise);\n      });\n    }\n    batchableHTMLText.texturePromise = texturePromise;\n    batchableHTMLText.currentKey = htmlText.styleKey;\n    batchableHTMLText.texture = await texturePromise;\n    const renderGroup = htmlText.renderGroup || htmlText.parentRenderGroup;\n    if (renderGroup) {\n      renderGroup.structureDidChange = true;\n    }\n    batchableHTMLText.generatingTexture = false;\n    updateTextBounds(batchableHTMLText, htmlText);\n  }\n  _getGpuText(htmlText) {\n    return htmlText._gpuData[this._renderer.uid] || this.initGpuText(htmlText);\n  }\n  initGpuText(htmlText) {\n    const batchableHTMLText = new BatchableHTMLText(this._renderer);\n    batchableHTMLText.renderable = htmlText;\n    batchableHTMLText.transform = htmlText.groupTransform;\n    batchableHTMLText.texture = Texture.EMPTY;\n    batchableHTMLText.bounds = { minX: 0, maxX: 1, minY: 0, maxY: 0 };\n    batchableHTMLText.roundPixels = this._renderer._roundPixels | htmlText._roundPixels;\n    htmlText._resolution = htmlText._autoResolution ? this._renderer.resolution : htmlText.resolution;\n    htmlText._gpuData[this._renderer.uid] = batchableHTMLText;\n    return batchableHTMLText;\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\n/** @ignore */\nHTMLTextPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"htmlText\"\n};\n\nexport { HTMLTextPipe };\n//# sourceMappingURL=HTMLTextPipe.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\n\n\"use strict\";\nconst nssvg = \"http://www.w3.org/2000/svg\";\nconst nsxhtml = \"http://www.w3.org/1999/xhtml\";\nclass HTMLTextRenderData {\n  constructor() {\n    this.svgRoot = document.createElementNS(nssvg, \"svg\");\n    this.foreignObject = document.createElementNS(nssvg, \"foreignObject\");\n    this.domElement = document.createElementNS(nsxhtml, \"div\");\n    this.styleElement = document.createElementNS(nsxhtml, \"style\");\n    const { foreignObject, svgRoot, styleElement, domElement } = this;\n    foreignObject.setAttribute(\"width\", \"10000\");\n    foreignObject.setAttribute(\"height\", \"10000\");\n    foreignObject.style.overflow = \"hidden\";\n    svgRoot.appendChild(foreignObject);\n    foreignObject.appendChild(styleElement);\n    foreignObject.appendChild(domElement);\n    this.image = DOMAdapter.get().createImage();\n  }\n  destroy() {\n    this.svgRoot.remove();\n    this.foreignObject.remove();\n    this.styleElement.remove();\n    this.domElement.remove();\n    this.image.src = \"\";\n    this.image.remove();\n    this.svgRoot = null;\n    this.foreignObject = null;\n    this.styleElement = null;\n    this.domElement = null;\n    this.image = null;\n    this.canvasAndContext = null;\n  }\n}\n\nexport { HTMLTextRenderData };\n//# sourceMappingURL=HTMLTextRenderData.mjs.map\n","import { Cache } from '../../../assets/cache/Cache.mjs';\nimport { loadFontCSS } from './loadFontCSS.mjs';\n\n\"use strict\";\nconst FontStylePromiseCache = /* @__PURE__ */ new Map();\nasync function getFontCss(fontFamilies) {\n  const fontPromises = fontFamilies.filter((fontFamily) => Cache.has(`${fontFamily}-and-url`)).map((fontFamily) => {\n    if (!FontStylePromiseCache.has(fontFamily)) {\n      const { entries } = Cache.get(`${fontFamily}-and-url`);\n      const promises = [];\n      entries.forEach((entry) => {\n        const url = entry.url;\n        const faces = entry.faces;\n        const out = faces.map((face) => ({ weight: face.weight, style: face.style }));\n        promises.push(\n          ...out.map(\n            (style) => loadFontCSS(\n              {\n                fontWeight: style.weight,\n                fontStyle: style.style,\n                fontFamily\n              },\n              url\n            )\n          )\n        );\n      });\n      FontStylePromiseCache.set(\n        fontFamily,\n        Promise.all(promises).then((css) => css.join(\"\\n\"))\n      );\n    }\n    return FontStylePromiseCache.get(fontFamily);\n  });\n  return (await Promise.all(fontPromises)).join(\"\\n\");\n}\n\nexport { FontStylePromiseCache, getFontCss };\n//# sourceMappingURL=getFontCss.mjs.map\n","import { HTMLTextRenderData } from '../HTMLTextRenderData.mjs';\n\n\"use strict\";\nlet tempHTMLTextRenderData;\nfunction measureHtmlText(text, style, fontStyleCSS, htmlTextRenderData) {\n  htmlTextRenderData || (htmlTextRenderData = tempHTMLTextRenderData || (tempHTMLTextRenderData = new HTMLTextRenderData()));\n  const { domElement, styleElement, svgRoot } = htmlTextRenderData;\n  domElement.innerHTML = `<style>${style.cssStyle};</style><div style='padding:0'>${text}</div>`;\n  domElement.setAttribute(\"style\", \"transform-origin: top left; display: inline-block\");\n  if (fontStyleCSS) {\n    styleElement.textContent = fontStyleCSS;\n  }\n  document.body.appendChild(svgRoot);\n  const contentBounds = domElement.getBoundingClientRect();\n  svgRoot.remove();\n  const doublePadding = style.padding * 2;\n  return {\n    width: contentBounds.width - doublePadding,\n    height: contentBounds.height - doublePadding\n  };\n}\n\nexport { measureHtmlText };\n//# sourceMappingURL=measureHtmlText.mjs.map\n","import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { CanvasPool } from '../../rendering/renderers/shared/texture/CanvasPool.mjs';\nimport { TexturePool } from '../../rendering/renderers/shared/texture/TexturePool.mjs';\nimport { RendererType } from '../../rendering/renderers/types.mjs';\nimport { isSafari } from '../../utils/browser/isSafari.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { BigPool } from '../../utils/pool/PoolGroup.mjs';\nimport { getPo2TextureFromSource } from '../text/utils/getPo2TextureFromSource.mjs';\nimport { HTMLTextRenderData } from './HTMLTextRenderData.mjs';\nimport { extractFontFamilies } from './utils/extractFontFamilies.mjs';\nimport { getFontCss } from './utils/getFontCss.mjs';\nimport { getSVGUrl } from './utils/getSVGUrl.mjs';\nimport { getTemporaryCanvasFromImage } from './utils/getTemporaryCanvasFromImage.mjs';\nimport { loadSVGImage } from './utils/loadSVGImage.mjs';\nimport { measureHtmlText } from './utils/measureHtmlText.mjs';\n\n\"use strict\";\nclass HTMLTextSystem {\n  constructor(renderer) {\n    this._activeTextures = {};\n    this._renderer = renderer;\n    this._createCanvas = renderer.type === RendererType.WEBGPU;\n  }\n  /**\n   * @param options\n   * @deprecated Use getTexturePromise instead\n   */\n  getTexture(options) {\n    return this.getTexturePromise(options);\n  }\n  /**\n   * Increases the reference count for a texture.\n   * @param text - The HTMLText instance associated with the texture.\n   */\n  getManagedTexture(text) {\n    const textKey = text.styleKey;\n    if (this._activeTextures[textKey]) {\n      this._increaseReferenceCount(textKey);\n      return this._activeTextures[textKey].promise;\n    }\n    const promise = this._buildTexturePromise(text).then((texture) => {\n      this._activeTextures[textKey].texture = texture;\n      return texture;\n    });\n    this._activeTextures[textKey] = {\n      texture: null,\n      promise,\n      usageCount: 1\n    };\n    return promise;\n  }\n  /**\n   * Gets the current reference count for a texture associated with a text key.\n   * @param textKey - The unique key identifying the text style configuration\n   * @returns The number of Text instances currently using this texture\n   */\n  getReferenceCount(textKey) {\n    return this._activeTextures[textKey]?.usageCount ?? null;\n  }\n  _increaseReferenceCount(textKey) {\n    this._activeTextures[textKey].usageCount++;\n  }\n  /**\n   * Decreases the reference count for a texture.\n   * If the count reaches zero, the texture is cleaned up.\n   * @param textKey - The key associated with the HTMLText instance.\n   */\n  decreaseReferenceCount(textKey) {\n    const activeTexture = this._activeTextures[textKey];\n    if (!activeTexture)\n      return;\n    activeTexture.usageCount--;\n    if (activeTexture.usageCount === 0) {\n      if (activeTexture.texture) {\n        this._cleanUp(activeTexture.texture);\n      } else {\n        activeTexture.promise.then((texture) => {\n          activeTexture.texture = texture;\n          this._cleanUp(activeTexture.texture);\n        }).catch(() => {\n          warn(\"HTMLTextSystem: Failed to clean texture\");\n        });\n      }\n      this._activeTextures[textKey] = null;\n    }\n  }\n  /**\n   * Returns a promise that resolves to a texture for the given HTMLText options.\n   * @param options - The options for the HTMLText.\n   * @returns A promise that resolves to a Texture.\n   */\n  getTexturePromise(options) {\n    return this._buildTexturePromise(options);\n  }\n  async _buildTexturePromise(options) {\n    const { text, style, resolution, textureStyle } = options;\n    const htmlTextData = BigPool.get(HTMLTextRenderData);\n    const fontFamilies = extractFontFamilies(text, style);\n    const fontCSS = await getFontCss(fontFamilies);\n    const measured = measureHtmlText(text, style, fontCSS, htmlTextData);\n    const width = Math.ceil(Math.ceil(Math.max(1, measured.width) + style.padding * 2) * resolution);\n    const height = Math.ceil(Math.ceil(Math.max(1, measured.height) + style.padding * 2) * resolution);\n    const image = htmlTextData.image;\n    const uvSafeOffset = 2;\n    image.width = (width | 0) + uvSafeOffset;\n    image.height = (height | 0) + uvSafeOffset;\n    const svgURL = getSVGUrl(text, style, resolution, fontCSS, htmlTextData);\n    await loadSVGImage(image, svgURL, isSafari() && fontFamilies.length > 0);\n    const resource = image;\n    let canvasAndContext;\n    if (this._createCanvas) {\n      canvasAndContext = getTemporaryCanvasFromImage(image, resolution);\n    }\n    const texture = getPo2TextureFromSource(\n      canvasAndContext ? canvasAndContext.canvas : resource,\n      image.width - uvSafeOffset,\n      image.height - uvSafeOffset,\n      resolution\n    );\n    if (textureStyle)\n      texture.source.style = textureStyle;\n    if (this._createCanvas) {\n      this._renderer.texture.initSource(texture.source);\n      CanvasPool.returnCanvasAndContext(canvasAndContext);\n    }\n    BigPool.return(htmlTextData);\n    return texture;\n  }\n  returnTexturePromise(texturePromise) {\n    texturePromise.then((texture) => {\n      this._cleanUp(texture);\n    }).catch(() => {\n      warn(\"HTMLTextSystem: Failed to clean texture\");\n    });\n  }\n  _cleanUp(texture) {\n    TexturePool.returnTexture(texture, true);\n    texture.source.resource = null;\n    texture.source.uploadMethodId = \"unknown\";\n  }\n  destroy() {\n    this._renderer = null;\n    for (const key in this._activeTextures) {\n      if (this._activeTextures[key])\n        this.returnTexturePromise(this._activeTextures[key].promise);\n    }\n    this._activeTextures = null;\n  }\n}\n/** @ignore */\nHTMLTextSystem.extension = {\n  type: [\n    ExtensionType.WebGLSystem,\n    ExtensionType.WebGPUSystem,\n    ExtensionType.CanvasSystem\n  ],\n  name: \"htmlText\"\n};\n\nexport { HTMLTextSystem };\n//# sourceMappingURL=HTMLTextSystem.mjs.map\n","\"use strict\";\nfunction extractFontFamilies(text, style) {\n  const fontFamily = style.fontFamily;\n  const fontFamilies = [];\n  const dedupe = {};\n  const regex = /font-family:([^;\"\\s]+)/g;\n  const matches = text.match(regex);\n  function addFontFamily(fontFamily2) {\n    if (!dedupe[fontFamily2]) {\n      fontFamilies.push(fontFamily2);\n      dedupe[fontFamily2] = true;\n    }\n  }\n  if (Array.isArray(fontFamily)) {\n    for (let i = 0; i < fontFamily.length; i++) {\n      addFontFamily(fontFamily[i]);\n    }\n  } else {\n    addFontFamily(fontFamily);\n  }\n  if (matches) {\n    matches.forEach((match) => {\n      const fontFamily2 = match.split(\":\")[1].trim();\n      addFontFamily(fontFamily2);\n    });\n  }\n  for (const i in style.tagStyles) {\n    const fontFamily2 = style.tagStyles[i].fontFamily;\n    addFontFamily(fontFamily2);\n  }\n  return fontFamilies;\n}\n\nexport { extractFontFamilies };\n//# sourceMappingURL=extractFontFamilies.mjs.map\n","import { loadFontAsBase64 } from './loadFontAsBase64.mjs';\n\n\"use strict\";\nasync function loadFontCSS(style, url) {\n  const dataSrc = await loadFontAsBase64(url);\n  return `@font-face {\n        font-family: \"${style.fontFamily}\";\n        font-weight: ${style.fontWeight};\n        font-style: ${style.fontStyle};\n        src: url('${dataSrc}');\n    }`;\n}\n\nexport { loadFontCSS };\n//# sourceMappingURL=loadFontCSS.mjs.map\n","import { DOMAdapter } from '../../../environment/adapter.mjs';\n\n\"use strict\";\nasync function loadFontAsBase64(url) {\n  const response = await DOMAdapter.get().fetch(url);\n  const blob = await response.blob();\n  const reader = new FileReader();\n  const dataSrc = await new Promise((resolve, reject) => {\n    reader.onloadend = () => resolve(reader.result);\n    reader.onerror = reject;\n    reader.readAsDataURL(blob);\n  });\n  return dataSrc;\n}\n\nexport { loadFontAsBase64 };\n//# sourceMappingURL=loadFontAsBase64.mjs.map\n","\"use strict\";\nfunction getSVGUrl(text, style, resolution, fontCSS, htmlTextData) {\n  const { domElement, styleElement, svgRoot } = htmlTextData;\n  domElement.innerHTML = `<style>${style.cssStyle}</style><div style='padding:0;'>${text}</div>`;\n  domElement.setAttribute(\"style\", `transform: scale(${resolution});transform-origin: top left; display: inline-block`);\n  styleElement.textContent = fontCSS;\n  const { width, height } = htmlTextData.image;\n  svgRoot.setAttribute(\"width\", width.toString());\n  svgRoot.setAttribute(\"height\", height.toString());\n  return new XMLSerializer().serializeToString(svgRoot);\n}\n\nexport { getSVGUrl };\n//# sourceMappingURL=getSVGUrl.mjs.map\n","\"use strict\";\nfunction loadSVGImage(image, url, delay) {\n  return new Promise(async (resolve) => {\n    if (delay) {\n      await new Promise((resolve2) => setTimeout(resolve2, 100));\n    }\n    image.onload = () => {\n      resolve();\n    };\n    image.src = `data:image/svg+xml;charset=utf8,${encodeURIComponent(url)}`;\n    image.crossOrigin = \"anonymous\";\n  });\n}\n\nexport { loadSVGImage };\n//# sourceMappingURL=loadSVGImage.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\n\n\"use strict\";\nfunction isSafari() {\n  const { userAgent } = DOMAdapter.get().getNavigator();\n  return /^((?!chrome|android).)*safari/i.test(userAgent);\n}\n\nexport { isSafari };\n//# sourceMappingURL=isSafari.mjs.map\n","import { CanvasPool } from '../../../rendering/renderers/shared/texture/CanvasPool.mjs';\n\n\"use strict\";\nfunction getTemporaryCanvasFromImage(image, resolution) {\n  const canvasAndContext = CanvasPool.getOptimalCanvasAndContext(\n    image.width,\n    image.height,\n    resolution\n  );\n  const { context } = canvasAndContext;\n  context.clearRect(0, 0, image.width, image.height);\n  context.drawImage(image, 0, 0);\n  return canvasAndContext;\n}\n\nexport { getTemporaryCanvasFromImage };\n//# sourceMappingURL=getTemporaryCanvasFromImage.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { HTMLTextPipe } from './HTMLTextPipe.mjs';\nimport { HTMLTextSystem } from './HTMLTextSystem.mjs';\n\n\"use strict\";\nextensions.add(HTMLTextSystem);\nextensions.add(HTMLTextPipe);\n//# sourceMappingURL=init.mjs.map\n","\"use strict\";\nfunction colorToUniform(rgb, alpha, out, offset) {\n  out[offset++] = (rgb >> 16 & 255) / 255;\n  out[offset++] = (rgb >> 8 & 255) / 255;\n  out[offset++] = (rgb & 255) / 255;\n  out[offset++] = alpha;\n}\nfunction color32BitToUniform(abgr, out, offset) {\n  const alpha = (abgr >> 24 & 255) / 255;\n  out[offset++] = (abgr & 255) / 255 * alpha;\n  out[offset++] = (abgr >> 8 & 255) / 255 * alpha;\n  out[offset++] = (abgr >> 16 & 255) / 255 * alpha;\n  out[offset++] = alpha;\n}\n\nexport { color32BitToUniform, colorToUniform };\n//# sourceMappingURL=colorToUniform.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { Texture } from '../../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { warn } from '../../../../utils/logging/warn.mjs';\nimport { FillGradient } from '../../../graphics/shared/fill/FillGradient.mjs';\nimport { FillPattern } from '../../../graphics/shared/fill/FillPattern.mjs';\n\n\"use strict\";\nconst PRECISION = 1e5;\nfunction getCanvasFillStyle(fillStyle, context, textMetrics, padding = 0) {\n  if (fillStyle.texture === Texture.WHITE && !fillStyle.fill) {\n    return Color.shared.setValue(fillStyle.color).setAlpha(fillStyle.alpha ?? 1).toHexa();\n  } else if (!fillStyle.fill) {\n    const pattern = context.createPattern(fillStyle.texture.source.resource, \"repeat\");\n    const tempMatrix = fillStyle.matrix.copyTo(Matrix.shared);\n    tempMatrix.scale(fillStyle.texture.frame.width, fillStyle.texture.frame.height);\n    pattern.setTransform(tempMatrix);\n    return pattern;\n  } else if (fillStyle.fill instanceof FillPattern) {\n    const fillPattern = fillStyle.fill;\n    const pattern = context.createPattern(fillPattern.texture.source.resource, \"repeat\");\n    const tempMatrix = fillPattern.transform.copyTo(Matrix.shared);\n    tempMatrix.scale(\n      fillPattern.texture.frame.width,\n      fillPattern.texture.frame.height\n    );\n    pattern.setTransform(tempMatrix);\n    return pattern;\n  } else if (fillStyle.fill instanceof FillGradient) {\n    const fillGradient = fillStyle.fill;\n    const isLinear = fillGradient.type === \"linear\";\n    const isLocal = fillGradient.textureSpace === \"local\";\n    let width = 1;\n    let height = 1;\n    if (isLocal && textMetrics) {\n      width = textMetrics.width + padding;\n      height = textMetrics.height + padding;\n    }\n    let gradient;\n    let isNearlyVertical = false;\n    if (isLinear) {\n      const { start, end } = fillGradient;\n      gradient = context.createLinearGradient(\n        start.x * width,\n        start.y * height,\n        end.x * width,\n        end.y * height\n      );\n      isNearlyVertical = Math.abs(end.x - start.x) < Math.abs((end.y - start.y) * 0.1);\n    } else {\n      const { center, innerRadius, outerCenter, outerRadius } = fillGradient;\n      gradient = context.createRadialGradient(\n        center.x * width,\n        center.y * height,\n        innerRadius * width,\n        outerCenter.x * width,\n        outerCenter.y * height,\n        outerRadius * width\n      );\n    }\n    if (isNearlyVertical && isLocal && textMetrics) {\n      const ratio = textMetrics.lineHeight / height;\n      for (let i = 0; i < textMetrics.lines.length; i++) {\n        const start = (i * textMetrics.lineHeight + padding / 2) / height;\n        fillGradient.colorStops.forEach((stop) => {\n          const globalStop = start + stop.offset * ratio;\n          gradient.addColorStop(\n            // fix to 5 decimal places to avoid floating point precision issues\n            Math.floor(globalStop * PRECISION) / PRECISION,\n            Color.shared.setValue(stop.color).toHex()\n          );\n        });\n      }\n    } else {\n      fillGradient.colorStops.forEach((stop) => {\n        gradient.addColorStop(stop.offset, Color.shared.setValue(stop.color).toHex());\n      });\n    }\n    return gradient;\n  }\n  warn(\"FillStyle not recognised\", fillStyle);\n  return \"red\";\n}\n\nexport { getCanvasFillStyle };\n//# sourceMappingURL=getCanvasFillStyle.mjs.map\n","import { ExtensionType } from '../extensions/Extensions.mjs';\n\n\"use strict\";\nclass FilterPipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  push(filterEffect, container, instructionSet) {\n    const renderPipes = this._renderer.renderPipes;\n    renderPipes.batch.break(instructionSet);\n    instructionSet.add({\n      renderPipeId: \"filter\",\n      canBundle: false,\n      action: \"pushFilter\",\n      container,\n      filterEffect\n    });\n  }\n  pop(_filterEffect, _container, instructionSet) {\n    this._renderer.renderPipes.batch.break(instructionSet);\n    instructionSet.add({\n      renderPipeId: \"filter\",\n      action: \"popFilter\",\n      canBundle: false\n    });\n  }\n  execute(instruction) {\n    if (instruction.action === \"pushFilter\") {\n      this._renderer.filter.push(instruction);\n    } else if (instruction.action === \"popFilter\") {\n      this._renderer.filter.pop();\n    }\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\nFilterPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"filter\"\n};\n\nexport { FilterPipe };\n//# sourceMappingURL=FilterPipe.mjs.map\n","var source = \"struct GlobalFilterUniforms {\\n  uInputSize: vec4<f32>,\\n  uInputPixel: vec4<f32>,\\n  uInputClamp: vec4<f32>,\\n  uOutputFrame: vec4<f32>,\\n  uGlobalFrame: vec4<f32>,\\n  uOutputTexture: vec4<f32>,\\n};\\n\\n@group(0) @binding(0) var <uniform> gfu: GlobalFilterUniforms;\\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\\n@group(0) @binding(2) var uSampler: sampler;\\n\\nstruct VSOutput {\\n  @builtin(position) position: vec4<f32>,\\n  @location(0) uv: vec2<f32>\\n};\\n\\nfn filterVertexPosition(aPosition: vec2<f32>) -> vec4<f32>\\n{\\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\\n\\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\\n    position.y = position.y * (2.0 * gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\\n\\n    return vec4(position, 0.0, 1.0);\\n}\\n\\nfn filterTextureCoord(aPosition: vec2<f32>) -> vec2<f32>\\n{\\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\\n}\\n\\n@vertex\\nfn mainVertex(\\n  @location(0) aPosition: vec2<f32>,\\n) -> VSOutput {\\n  return VSOutput(\\n   filterVertexPosition(aPosition),\\n   filterTextureCoord(aPosition)\\n  );\\n}\\n\\n@fragment\\nfn mainFragment(\\n  @location(0) uv: vec2<f32>,\\n) -> @location(0) vec4<f32> {\\n    return textureSample(uTexture, uSampler, uv);\\n}\\n\";\n\nexport { source as default };\n//# sourceMappingURL=passthrough.wgsl.mjs.map\n","import { GlProgram } from '../../../rendering/renderers/gl/shader/GlProgram.mjs';\nimport { GpuProgram } from '../../../rendering/renderers/gpu/shader/GpuProgram.mjs';\nimport { Filter } from '../../Filter.mjs';\nimport vertex from '../defaultFilter.vert.mjs';\nimport fragment from './passthrough.frag.mjs';\nimport source from './passthrough.wgsl.mjs';\n\n\"use strict\";\nclass PassthroughFilter extends Filter {\n  constructor() {\n    const gpuProgram = GpuProgram.from({\n      vertex: { source, entryPoint: \"mainVertex\" },\n      fragment: { source, entryPoint: \"mainFragment\" },\n      name: \"passthrough-filter\"\n    });\n    const glProgram = GlProgram.from({\n      vertex,\n      fragment,\n      name: \"passthrough-filter\"\n    });\n    super({\n      gpuProgram,\n      glProgram\n    });\n  }\n}\n\nexport { PassthroughFilter };\n//# sourceMappingURL=PassthroughFilter.mjs.map\n","var vertex = \"in vec2 aPosition;\\nout vec2 vTextureCoord;\\n\\nuniform vec4 uInputSize;\\nuniform vec4 uOutputFrame;\\nuniform vec4 uOutputTexture;\\n\\nvec4 filterVertexPosition( void )\\n{\\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\\n    \\n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\\n\\n    return vec4(position, 0.0, 1.0);\\n}\\n\\nvec2 filterTextureCoord( void )\\n{\\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\\n}\\n\\nvoid main(void)\\n{\\n    gl_Position = filterVertexPosition();\\n    vTextureCoord = filterTextureCoord();\\n}\\n\";\n\nexport { vertex as default };\n//# sourceMappingURL=defaultFilter.vert.mjs.map\n","var fragment = \"in vec2 vTextureCoord;\\nout vec4 finalColor;\\nuniform sampler2D uTexture;\\nvoid main() {\\n    finalColor = texture(uTexture, vTextureCoord);\\n}\\n\";\n\nexport { fragment as default };\n//# sourceMappingURL=passthrough.frag.mjs.map\n","import '../../../maths/index.mjs';\nimport { Matrix } from '../../../maths/matrix/Matrix.mjs';\n\n\"use strict\";\nconst tempProjectionMatrix = new Matrix();\nfunction getGlobalRenderableBounds(renderables, bounds) {\n  bounds.clear();\n  const actualMatrix = bounds.matrix;\n  for (let i = 0; i < renderables.length; i++) {\n    const renderable = renderables[i];\n    if (renderable.globalDisplayStatus < 7) {\n      continue;\n    }\n    const renderGroup = renderable.renderGroup ?? renderable.parentRenderGroup;\n    if (renderGroup?.isCachedAsTexture) {\n      bounds.matrix = tempProjectionMatrix.copyFrom(renderGroup.textureOffsetInverseTransform).append(renderable.worldTransform);\n    } else if (renderGroup?._parentCacheAsTextureRenderGroup) {\n      bounds.matrix = tempProjectionMatrix.copyFrom(renderGroup._parentCacheAsTextureRenderGroup.inverseWorldTransform).append(renderable.groupTransform);\n    } else {\n      bounds.matrix = renderable.worldTransform;\n    }\n    bounds.addBounds(renderable.bounds);\n  }\n  bounds.matrix = actualMatrix;\n  return bounds;\n}\n\nexport { getGlobalRenderableBounds };\n//# sourceMappingURL=getRenderableBounds.mjs.map\n","import { ExtensionType } from '../extensions/Extensions.mjs';\nimport { PassthroughFilter } from './defaults/passthrough/PassthroughFilter.mjs';\nimport { Matrix } from '../maths/matrix/Matrix.mjs';\nimport { BindGroup } from '../rendering/renderers/gpu/shader/BindGroup.mjs';\nimport { Geometry } from '../rendering/renderers/shared/geometry/Geometry.mjs';\nimport { UniformGroup } from '../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { Texture } from '../rendering/renderers/shared/texture/Texture.mjs';\nimport { TexturePool } from '../rendering/renderers/shared/texture/TexturePool.mjs';\nimport { RendererType } from '../rendering/renderers/types.mjs';\nimport { Bounds } from '../scene/container/bounds/Bounds.mjs';\nimport { getGlobalRenderableBounds } from '../scene/container/bounds/getRenderableBounds.mjs';\nimport { warn } from '../utils/logging/warn.mjs';\n\n\"use strict\";\nconst quadGeometry = new Geometry({\n  attributes: {\n    aPosition: {\n      buffer: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),\n      format: \"float32x2\",\n      stride: 2 * 4,\n      offset: 0\n    }\n  },\n  indexBuffer: new Uint32Array([0, 1, 2, 0, 2, 3])\n});\nclass FilterData {\n  constructor() {\n    /**\n     * Indicates whether the filter should be skipped.\n     * @type {boolean}\n     */\n    this.skip = false;\n    /**\n     * The texture to which the filter is applied.\n     * @type {Texture}\n     */\n    this.inputTexture = null;\n    /**\n     * The back texture used for blending, if required.\n     * @type {Texture | null}\n     */\n    this.backTexture = null;\n    /**\n     * The list of filters to be applied.\n     * @type {Filter[]}\n     */\n    this.filters = null;\n    /**\n     * The bounds of the filter area.\n     * @type {Bounds}\n     */\n    this.bounds = new Bounds();\n    /**\n     * The container to which the filter is applied.\n     * @type {Container}\n     */\n    this.container = null;\n    /**\n     * Indicates whether blending is required for the filter.\n     * @type {boolean}\n     */\n    this.blendRequired = false;\n    /**\n     * The render surface where the output of the filter is rendered.\n     * @type {RenderSurface}\n     */\n    this.outputRenderSurface = null;\n    /**\n     * The global frame of the filter area.\n     * @type {{ x: number, y: number, width: number, height: number }}\n     */\n    this.globalFrame = { x: 0, y: 0, width: 0, height: 0 };\n    /** The first enabled filter index in the current filter list. */\n    this.firstEnabledIndex = -1;\n    /** The last enabled filter index in the current filter list. */\n    this.lastEnabledIndex = -1;\n  }\n}\nclass FilterSystem {\n  constructor(renderer) {\n    this._filterStackIndex = 0;\n    this._filterStack = [];\n    this._filterGlobalUniforms = new UniformGroup({\n      uInputSize: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uInputPixel: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uInputClamp: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uOutputFrame: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uGlobalFrame: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uOutputTexture: { value: new Float32Array(4), type: \"vec4<f32>\" }\n    });\n    this._globalFilterBindGroup = new BindGroup({});\n    this.renderer = renderer;\n  }\n  /**\n   * The back texture of the currently active filter. Requires the filter to have `blendRequired` set to true.\n   * @readonly\n   */\n  get activeBackTexture() {\n    return this._activeFilterData?.backTexture;\n  }\n  /**\n   * Pushes a filter instruction onto the filter stack.\n   * @param instruction - The instruction containing the filter effect and container.\n   * @internal\n   */\n  push(instruction) {\n    const renderer = this.renderer;\n    const filters = instruction.filterEffect.filters;\n    const filterData = this._pushFilterData();\n    filterData.skip = false;\n    filterData.filters = filters;\n    filterData.container = instruction.container;\n    filterData.outputRenderSurface = renderer.renderTarget.renderSurface;\n    const colorTextureSource = renderer.renderTarget.renderTarget.colorTexture.source;\n    const rootResolution = colorTextureSource.resolution;\n    const rootAntialias = colorTextureSource.antialias;\n    if (filters.every((filter) => !filter.enabled)) {\n      filterData.skip = true;\n      return;\n    }\n    const bounds = filterData.bounds;\n    this._calculateFilterArea(instruction, bounds);\n    this._calculateFilterBounds(filterData, renderer.renderTarget.rootViewPort, rootAntialias, rootResolution, 1);\n    if (filterData.skip) {\n      return;\n    }\n    const previousFilterData = this._getPreviousFilterData();\n    const globalResolution = this._findFilterResolution(rootResolution);\n    let offsetX = 0;\n    let offsetY = 0;\n    if (previousFilterData) {\n      offsetX = previousFilterData.bounds.minX;\n      offsetY = previousFilterData.bounds.minY;\n    }\n    this._calculateGlobalFrame(\n      filterData,\n      offsetX,\n      offsetY,\n      globalResolution,\n      colorTextureSource.width,\n      colorTextureSource.height\n    );\n    this._setupFilterTextures(filterData, bounds, renderer, previousFilterData);\n  }\n  /**\n   * Applies filters to a texture.\n   *\n   * This method takes a texture and a list of filters, applies the filters to the texture,\n   * and returns the resulting texture.\n   * @param {object} params - The parameters for applying filters.\n   * @param {Texture} params.texture - The texture to apply filters to.\n   * @param {Filter[]} params.filters - The filters to apply.\n   * @returns {Texture} The resulting texture after all filters have been applied.\n   * @example\n   *\n   * ```ts\n   * // Create a texture and a list of filters\n   * const texture = new Texture(...);\n   * const filters = [new BlurFilter(), new ColorMatrixFilter()];\n   *\n   * // Apply the filters to the texture\n   * const resultTexture = filterSystem.applyToTexture({ texture, filters });\n   *\n   * // Use the resulting texture\n   * sprite.texture = resultTexture;\n   * ```\n   *\n   * Key Points:\n   * 1. padding is not currently supported here - so clipping may occur with filters that use padding.\n   * 2. If all filters are disabled or skipped, the original texture is returned.\n   */\n  generateFilteredTexture({ texture, filters }) {\n    const filterData = this._pushFilterData();\n    this._activeFilterData = filterData;\n    filterData.skip = false;\n    filterData.filters = filters;\n    const colorTextureSource = texture.source;\n    const rootResolution = colorTextureSource.resolution;\n    const rootAntialias = colorTextureSource.antialias;\n    if (filters.every((filter) => !filter.enabled)) {\n      filterData.skip = true;\n      return texture;\n    }\n    const bounds = filterData.bounds;\n    bounds.addRect(texture.frame);\n    this._calculateFilterBounds(filterData, bounds.rectangle, rootAntialias, rootResolution, 0);\n    if (filterData.skip) {\n      return texture;\n    }\n    const globalResolution = rootResolution;\n    const offsetX = 0;\n    const offsetY = 0;\n    this._calculateGlobalFrame(\n      filterData,\n      offsetX,\n      offsetY,\n      globalResolution,\n      colorTextureSource.width,\n      colorTextureSource.height\n    );\n    filterData.outputRenderSurface = TexturePool.getOptimalTexture(\n      bounds.width,\n      bounds.height,\n      filterData.resolution,\n      filterData.antialias\n    );\n    filterData.backTexture = Texture.EMPTY;\n    filterData.inputTexture = texture;\n    const renderer = this.renderer;\n    renderer.renderTarget.finishRenderPass();\n    this._applyFiltersToTexture(filterData, true);\n    const outputTexture = filterData.outputRenderSurface;\n    outputTexture.source.alphaMode = \"premultiplied-alpha\";\n    return outputTexture;\n  }\n  /** @internal */\n  pop() {\n    const renderer = this.renderer;\n    const filterData = this._popFilterData();\n    if (filterData.skip) {\n      return;\n    }\n    renderer.globalUniforms.pop();\n    renderer.renderTarget.finishRenderPass();\n    this._activeFilterData = filterData;\n    this._applyFiltersToTexture(filterData, false);\n    if (filterData.blendRequired) {\n      TexturePool.returnTexture(filterData.backTexture);\n    }\n    TexturePool.returnTexture(filterData.inputTexture);\n  }\n  /**\n   * Copies the last render surface to a texture.\n   * @param lastRenderSurface - The last render surface to copy from.\n   * @param bounds - The bounds of the area to copy.\n   * @param previousBounds - The previous bounds to use for offsetting the copy.\n   */\n  getBackTexture(lastRenderSurface, bounds, previousBounds) {\n    const backgroundResolution = lastRenderSurface.colorTexture.source._resolution;\n    const backTexture = TexturePool.getOptimalTexture(\n      bounds.width,\n      bounds.height,\n      backgroundResolution,\n      false\n    );\n    let x = bounds.minX;\n    let y = bounds.minY;\n    if (previousBounds) {\n      x -= previousBounds.minX;\n      y -= previousBounds.minY;\n    }\n    x = Math.floor(x * backgroundResolution);\n    y = Math.floor(y * backgroundResolution);\n    const width = Math.ceil(bounds.width * backgroundResolution);\n    const height = Math.ceil(bounds.height * backgroundResolution);\n    this.renderer.renderTarget.copyToTexture(\n      lastRenderSurface,\n      backTexture,\n      { x, y },\n      { width, height },\n      { x: 0, y: 0 }\n    );\n    return backTexture;\n  }\n  /**\n   * Applies a filter to a texture.\n   * @param filter - The filter to apply.\n   * @param input - The input texture.\n   * @param output - The output render surface.\n   * @param clear - Whether to clear the output surface before applying the filter.\n   */\n  applyFilter(filter, input, output, clear) {\n    const renderer = this.renderer;\n    const filterData = this._activeFilterData;\n    const outputRenderSurface = filterData.outputRenderSurface;\n    const isFinalTarget = outputRenderSurface === output;\n    const rootResolution = renderer.renderTarget.rootRenderTarget.colorTexture.source._resolution;\n    const resolution = this._findFilterResolution(rootResolution);\n    let offsetX = 0;\n    let offsetY = 0;\n    if (isFinalTarget) {\n      const offset = this._findPreviousFilterOffset();\n      offsetX = offset.x;\n      offsetY = offset.y;\n    }\n    this._updateFilterUniforms(input, output, filterData, offsetX, offsetY, resolution, isFinalTarget, clear);\n    const filterToApply = filter.enabled ? filter : this._getPassthroughFilter();\n    this._setupBindGroupsAndRender(filterToApply, input, renderer);\n  }\n  /**\n   * Multiply _input normalized coordinates_ to this matrix to get _sprite texture normalized coordinates_.\n   *\n   * Use `outputMatrix * vTextureCoord` in the shader.\n   * @param outputMatrix - The matrix to output to.\n   * @param {Sprite} sprite - The sprite to map to.\n   * @returns The mapped matrix.\n   */\n  calculateSpriteMatrix(outputMatrix, sprite) {\n    const data = this._activeFilterData;\n    const mappedMatrix = outputMatrix.set(\n      data.inputTexture._source.width,\n      0,\n      0,\n      data.inputTexture._source.height,\n      data.bounds.minX,\n      data.bounds.minY\n    );\n    const worldTransform = sprite.worldTransform.copyTo(Matrix.shared);\n    const renderGroup = sprite.renderGroup || sprite.parentRenderGroup;\n    if (renderGroup && renderGroup.cacheToLocalTransform) {\n      worldTransform.prepend(renderGroup.cacheToLocalTransform);\n    }\n    worldTransform.invert();\n    mappedMatrix.prepend(worldTransform);\n    mappedMatrix.scale(\n      1 / sprite.texture.orig.width,\n      1 / sprite.texture.orig.height\n    );\n    mappedMatrix.translate(sprite.anchor.x, sprite.anchor.y);\n    return mappedMatrix;\n  }\n  destroy() {\n    this._passthroughFilter?.destroy(true);\n    this._passthroughFilter = null;\n  }\n  _getPassthroughFilter() {\n    this._passthroughFilter ?? (this._passthroughFilter = new PassthroughFilter());\n    return this._passthroughFilter;\n  }\n  /**\n   * Sets up the bind groups and renders the filter.\n   * @param filter - The filter to apply\n   * @param input - The input texture\n   * @param renderer - The renderer instance\n   */\n  _setupBindGroupsAndRender(filter, input, renderer) {\n    if (renderer.renderPipes.uniformBatch) {\n      const batchUniforms = renderer.renderPipes.uniformBatch.getUboResource(this._filterGlobalUniforms);\n      this._globalFilterBindGroup.setResource(batchUniforms, 0);\n    } else {\n      this._globalFilterBindGroup.setResource(this._filterGlobalUniforms, 0);\n    }\n    this._globalFilterBindGroup.setResource(input.source, 1);\n    this._globalFilterBindGroup.setResource(input.source.style, 2);\n    filter.groups[0] = this._globalFilterBindGroup;\n    renderer.encoder.draw({\n      geometry: quadGeometry,\n      shader: filter,\n      state: filter._state,\n      topology: \"triangle-list\"\n    });\n    if (renderer.type === RendererType.WEBGL) {\n      renderer.renderTarget.finishRenderPass();\n    }\n  }\n  /**\n   * Sets up the filter textures including input texture and back texture if needed.\n   * @param filterData - The filter data to update\n   * @param bounds - The bounds for the texture\n   * @param renderer - The renderer instance\n   * @param previousFilterData - The previous filter data for back texture calculation\n   */\n  _setupFilterTextures(filterData, bounds, renderer, previousFilterData) {\n    filterData.backTexture = Texture.EMPTY;\n    filterData.inputTexture = TexturePool.getOptimalTexture(\n      bounds.width,\n      bounds.height,\n      filterData.resolution,\n      filterData.antialias\n    );\n    if (filterData.blendRequired) {\n      renderer.renderTarget.finishRenderPass();\n      const renderTarget = renderer.renderTarget.getRenderTarget(filterData.outputRenderSurface);\n      filterData.backTexture = this.getBackTexture(renderTarget, bounds, previousFilterData?.bounds);\n    }\n    renderer.renderTarget.bind(filterData.inputTexture, true);\n    renderer.globalUniforms.push({\n      offset: bounds\n    });\n  }\n  /**\n   * Calculates and sets the global frame for the filter.\n   * @param filterData - The filter data to update\n   * @param offsetX - The X offset\n   * @param offsetY - The Y offset\n   * @param globalResolution - The global resolution\n   * @param sourceWidth - The source texture width\n   * @param sourceHeight - The source texture height\n   */\n  _calculateGlobalFrame(filterData, offsetX, offsetY, globalResolution, sourceWidth, sourceHeight) {\n    const globalFrame = filterData.globalFrame;\n    globalFrame.x = offsetX * globalResolution;\n    globalFrame.y = offsetY * globalResolution;\n    globalFrame.width = sourceWidth * globalResolution;\n    globalFrame.height = sourceHeight * globalResolution;\n  }\n  /**\n   * Updates the filter uniforms with the current filter state.\n   * @param input - The input texture\n   * @param output - The output render surface\n   * @param filterData - The current filter data\n   * @param offsetX - The X offset for positioning\n   * @param offsetY - The Y offset for positioning\n   * @param resolution - The current resolution\n   * @param isFinalTarget - Whether this is the final render target\n   * @param clear - Whether to clear the output surface\n   */\n  _updateFilterUniforms(input, output, filterData, offsetX, offsetY, resolution, isFinalTarget, clear) {\n    const uniforms = this._filterGlobalUniforms.uniforms;\n    const outputFrame = uniforms.uOutputFrame;\n    const inputSize = uniforms.uInputSize;\n    const inputPixel = uniforms.uInputPixel;\n    const inputClamp = uniforms.uInputClamp;\n    const globalFrame = uniforms.uGlobalFrame;\n    const outputTexture = uniforms.uOutputTexture;\n    if (isFinalTarget) {\n      outputFrame[0] = filterData.bounds.minX - offsetX;\n      outputFrame[1] = filterData.bounds.minY - offsetY;\n    } else {\n      outputFrame[0] = 0;\n      outputFrame[1] = 0;\n    }\n    outputFrame[2] = input.frame.width;\n    outputFrame[3] = input.frame.height;\n    inputSize[0] = input.source.width;\n    inputSize[1] = input.source.height;\n    inputSize[2] = 1 / inputSize[0];\n    inputSize[3] = 1 / inputSize[1];\n    inputPixel[0] = input.source.pixelWidth;\n    inputPixel[1] = input.source.pixelHeight;\n    inputPixel[2] = 1 / inputPixel[0];\n    inputPixel[3] = 1 / inputPixel[1];\n    inputClamp[0] = 0.5 * inputPixel[2];\n    inputClamp[1] = 0.5 * inputPixel[3];\n    inputClamp[2] = input.frame.width * inputSize[2] - 0.5 * inputPixel[2];\n    inputClamp[3] = input.frame.height * inputSize[3] - 0.5 * inputPixel[3];\n    const rootTexture = this.renderer.renderTarget.rootRenderTarget.colorTexture;\n    globalFrame[0] = offsetX * resolution;\n    globalFrame[1] = offsetY * resolution;\n    globalFrame[2] = rootTexture.source.width * resolution;\n    globalFrame[3] = rootTexture.source.height * resolution;\n    if (output instanceof Texture)\n      output.source.resource = null;\n    const renderTarget = this.renderer.renderTarget.getRenderTarget(output);\n    this.renderer.renderTarget.bind(output, !!clear);\n    if (output instanceof Texture) {\n      outputTexture[0] = output.frame.width;\n      outputTexture[1] = output.frame.height;\n    } else {\n      outputTexture[0] = renderTarget.width;\n      outputTexture[1] = renderTarget.height;\n    }\n    outputTexture[2] = renderTarget.isRoot ? -1 : 1;\n    this._filterGlobalUniforms.update();\n  }\n  /**\n   * Finds the correct resolution by looking back through the filter stack.\n   * @param rootResolution - The fallback root resolution to use\n   * @returns The resolution from the previous filter or root resolution\n   */\n  _findFilterResolution(rootResolution) {\n    let currentIndex = this._filterStackIndex - 1;\n    while (currentIndex > 0 && this._filterStack[currentIndex].skip) {\n      --currentIndex;\n    }\n    return currentIndex > 0 && this._filterStack[currentIndex].inputTexture ? this._filterStack[currentIndex].inputTexture.source._resolution : rootResolution;\n  }\n  /**\n   * Finds the offset from the previous non-skipped filter in the stack.\n   * @returns The offset coordinates from the previous filter\n   */\n  _findPreviousFilterOffset() {\n    let offsetX = 0;\n    let offsetY = 0;\n    let lastIndex = this._filterStackIndex;\n    while (lastIndex > 0) {\n      lastIndex--;\n      const prevFilterData = this._filterStack[lastIndex];\n      if (!prevFilterData.skip) {\n        offsetX = prevFilterData.bounds.minX;\n        offsetY = prevFilterData.bounds.minY;\n        break;\n      }\n    }\n    return { x: offsetX, y: offsetY };\n  }\n  /**\n   * Calculates the filter area bounds based on the instruction type.\n   * @param instruction - The filter instruction\n   * @param bounds - The bounds object to populate\n   */\n  _calculateFilterArea(instruction, bounds) {\n    if (instruction.renderables) {\n      getGlobalRenderableBounds(instruction.renderables, bounds);\n    } else if (instruction.filterEffect.filterArea) {\n      bounds.clear();\n      bounds.addRect(instruction.filterEffect.filterArea);\n      bounds.applyMatrix(instruction.container.worldTransform);\n    } else {\n      instruction.container.getFastGlobalBounds(true, bounds);\n    }\n    if (instruction.container) {\n      const renderGroup = instruction.container.renderGroup || instruction.container.parentRenderGroup;\n      const filterFrameTransform = renderGroup.cacheToLocalTransform;\n      if (filterFrameTransform) {\n        bounds.applyMatrix(filterFrameTransform);\n      }\n    }\n  }\n  _applyFiltersToTexture(filterData, clear) {\n    const inputTexture = filterData.inputTexture;\n    const bounds = filterData.bounds;\n    const filters = filterData.filters;\n    const firstEnabled = filterData.firstEnabledIndex;\n    const lastEnabled = filterData.lastEnabledIndex;\n    this._globalFilterBindGroup.setResource(inputTexture.source.style, 2);\n    this._globalFilterBindGroup.setResource(filterData.backTexture.source, 3);\n    if (firstEnabled === lastEnabled) {\n      filters[firstEnabled].apply(this, inputTexture, filterData.outputRenderSurface, clear);\n    } else {\n      let flip = filterData.inputTexture;\n      const tempTexture = TexturePool.getOptimalTexture(\n        bounds.width,\n        bounds.height,\n        flip.source._resolution,\n        false\n      );\n      let flop = tempTexture;\n      for (let i = firstEnabled; i < lastEnabled; i++) {\n        const filter = filters[i];\n        if (!filter.enabled)\n          continue;\n        filter.apply(this, flip, flop, true);\n        const t = flip;\n        flip = flop;\n        flop = t;\n      }\n      filters[lastEnabled].apply(this, flip, filterData.outputRenderSurface, clear);\n      TexturePool.returnTexture(tempTexture);\n    }\n  }\n  _calculateFilterBounds(filterData, viewPort, rootAntialias, rootResolution, paddingMultiplier) {\n    const renderer = this.renderer;\n    const bounds = filterData.bounds;\n    const filters = filterData.filters;\n    let resolution = Infinity;\n    let padding = 0;\n    let antialias = true;\n    let blendRequired = false;\n    let enabled = false;\n    let clipToViewport = true;\n    let firstEnabledIndex = -1;\n    let lastEnabledIndex = -1;\n    for (let i = 0; i < filters.length; i++) {\n      const filter = filters[i];\n      if (!filter.enabled)\n        continue;\n      if (firstEnabledIndex === -1)\n        firstEnabledIndex = i;\n      lastEnabledIndex = i;\n      resolution = Math.min(resolution, filter.resolution === \"inherit\" ? rootResolution : filter.resolution);\n      padding += filter.padding;\n      if (filter.antialias === \"off\") {\n        antialias = false;\n      } else if (filter.antialias === \"inherit\") {\n        antialias && (antialias = rootAntialias);\n      }\n      if (!filter.clipToViewport) {\n        clipToViewport = false;\n      }\n      const isCompatible = !!(filter.compatibleRenderers & renderer.type);\n      if (!isCompatible) {\n        enabled = false;\n        break;\n      }\n      if (filter.blendRequired && !(renderer.backBuffer?.useBackBuffer ?? true)) {\n        warn(\"Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options.\");\n        enabled = false;\n        break;\n      }\n      enabled = true;\n      blendRequired || (blendRequired = filter.blendRequired);\n    }\n    if (!enabled) {\n      filterData.skip = true;\n      return;\n    }\n    if (clipToViewport) {\n      bounds.fitBounds(0, viewPort.width / rootResolution, 0, viewPort.height / rootResolution);\n    }\n    bounds.scale(resolution).ceil().scale(1 / resolution).pad((padding | 0) * paddingMultiplier);\n    if (!bounds.isPositive) {\n      filterData.skip = true;\n      return;\n    }\n    filterData.antialias = antialias;\n    filterData.resolution = resolution;\n    filterData.blendRequired = blendRequired;\n    filterData.firstEnabledIndex = firstEnabledIndex;\n    filterData.lastEnabledIndex = lastEnabledIndex;\n  }\n  _popFilterData() {\n    this._filterStackIndex--;\n    return this._filterStack[this._filterStackIndex];\n  }\n  _getPreviousFilterData() {\n    let previousFilterData;\n    let index = this._filterStackIndex - 1;\n    while (index > 0) {\n      index--;\n      previousFilterData = this._filterStack[index];\n      if (!previousFilterData.skip) {\n        break;\n      }\n    }\n    return previousFilterData;\n  }\n  _pushFilterData() {\n    let filterData = this._filterStack[this._filterStackIndex];\n    if (!filterData) {\n      filterData = this._filterStack[this._filterStackIndex] = new FilterData();\n    }\n    this._filterStackIndex++;\n    return filterData;\n  }\n}\n/** @ignore */\nFilterSystem.extension = {\n  type: [\n    ExtensionType.WebGLSystem,\n    ExtensionType.WebGPUSystem\n  ],\n  name: \"filter\"\n};\n\nexport { FilterSystem };\n//# sourceMappingURL=FilterSystem.mjs.map\n","import { extensions } from '../extensions/Extensions.mjs';\nimport { FilterPipe } from './FilterPipe.mjs';\nimport { FilterSystem } from './FilterSystem.mjs';\n\n\"use strict\";\nextensions.add(FilterSystem);\nextensions.add(FilterPipe);\n//# sourceMappingURL=init.mjs.map\n","import { lru } from 'tiny-lru';\nimport { DOMAdapter } from '../../../environment/adapter.mjs';\nimport { fontStringFromTextStyle } from './utils/fontStringFromTextStyle.mjs';\n\n\"use strict\";\nconst contextSettings = {\n  // TextMetrics requires getImageData readback for measuring fonts.\n  willReadFrequently: true\n};\nconst _CanvasTextMetrics = class _CanvasTextMetrics {\n  /**\n   * Checking that we can use modern canvas 2D API.\n   *\n   * Note: This is an unstable API, Chrome < 94 use `textLetterSpacing`, later versions use `letterSpacing`.\n   * @see TextMetrics.experimentalLetterSpacing\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/ICanvasRenderingContext2D/letterSpacing\n   * @see https://developer.chrome.com/origintrials/#/view_trial/3585991203293757441\n   */\n  static get experimentalLetterSpacingSupported() {\n    let result = _CanvasTextMetrics._experimentalLetterSpacingSupported;\n    if (result === void 0) {\n      const proto = DOMAdapter.get().getCanvasRenderingContext2D().prototype;\n      result = _CanvasTextMetrics._experimentalLetterSpacingSupported = \"letterSpacing\" in proto || \"textLetterSpacing\" in proto;\n    }\n    return result;\n  }\n  /**\n   * @param text - the text that was measured\n   * @param style - the style that was measured\n   * @param width - the measured width of the text\n   * @param height - the measured height of the text\n   * @param lines - an array of the lines of text broken by new lines and wrapping if specified in style\n   * @param lineWidths - an array of the line widths for each line matched to `lines`\n   * @param lineHeight - the measured line height for this style\n   * @param maxLineWidth - the maximum line width for all measured lines\n   * @param {FontMetrics} fontProperties - the font properties object from TextMetrics.measureFont\n   */\n  constructor(text, style, width, height, lines, lineWidths, lineHeight, maxLineWidth, fontProperties) {\n    this.text = text;\n    this.style = style;\n    this.width = width;\n    this.height = height;\n    this.lines = lines;\n    this.lineWidths = lineWidths;\n    this.lineHeight = lineHeight;\n    this.maxLineWidth = maxLineWidth;\n    this.fontProperties = fontProperties;\n  }\n  /**\n   * Measures the supplied string of text and returns a Rectangle.\n   * @param text - The text to measure.\n   * @param style - The text style to use for measuring\n   * @param canvas - optional specification of the canvas to use for measuring.\n   * @param wordWrap\n   * @returns Measured width and height of the text.\n   */\n  static measureText(text = \" \", style, canvas = _CanvasTextMetrics._canvas, wordWrap = style.wordWrap) {\n    const textKey = `${text}-${style.styleKey}-wordWrap-${wordWrap}`;\n    if (_CanvasTextMetrics._measurementCache.has(textKey)) {\n      return _CanvasTextMetrics._measurementCache.get(textKey);\n    }\n    const font = fontStringFromTextStyle(style);\n    const fontProperties = _CanvasTextMetrics.measureFont(font);\n    if (fontProperties.fontSize === 0) {\n      fontProperties.fontSize = style.fontSize;\n      fontProperties.ascent = style.fontSize;\n    }\n    const context = _CanvasTextMetrics.__context;\n    context.font = font;\n    const outputText = wordWrap ? _CanvasTextMetrics._wordWrap(text, style, canvas) : text;\n    const lines = outputText.split(/(?:\\r\\n|\\r|\\n)/);\n    const lineWidths = new Array(lines.length);\n    let maxLineWidth = 0;\n    for (let i = 0; i < lines.length; i++) {\n      const lineWidth = _CanvasTextMetrics._measureText(lines[i], style.letterSpacing, context);\n      lineWidths[i] = lineWidth;\n      maxLineWidth = Math.max(maxLineWidth, lineWidth);\n    }\n    const strokeWidth = style._stroke?.width || 0;\n    let width = maxLineWidth + strokeWidth;\n    if (style.dropShadow) {\n      width += style.dropShadow.distance;\n    }\n    const lineHeight = style.lineHeight || fontProperties.fontSize;\n    let height = Math.max(lineHeight, fontProperties.fontSize + strokeWidth) + (lines.length - 1) * (lineHeight + style.leading);\n    if (style.dropShadow) {\n      height += style.dropShadow.distance;\n    }\n    const measurements = new _CanvasTextMetrics(\n      text,\n      style,\n      width,\n      height,\n      lines,\n      lineWidths,\n      lineHeight + style.leading,\n      maxLineWidth,\n      fontProperties\n    );\n    _CanvasTextMetrics._measurementCache.set(textKey, measurements);\n    return measurements;\n  }\n  static _measureText(text, letterSpacing, context) {\n    let useExperimentalLetterSpacing = false;\n    if (_CanvasTextMetrics.experimentalLetterSpacingSupported) {\n      if (_CanvasTextMetrics.experimentalLetterSpacing) {\n        context.letterSpacing = `${letterSpacing}px`;\n        context.textLetterSpacing = `${letterSpacing}px`;\n        useExperimentalLetterSpacing = true;\n      } else {\n        context.letterSpacing = \"0px\";\n        context.textLetterSpacing = \"0px\";\n      }\n    }\n    const metrics = context.measureText(text);\n    let metricWidth = metrics.width;\n    const actualBoundingBoxLeft = -metrics.actualBoundingBoxLeft;\n    const actualBoundingBoxRight = metrics.actualBoundingBoxRight;\n    let boundsWidth = actualBoundingBoxRight - actualBoundingBoxLeft;\n    if (metricWidth > 0) {\n      if (useExperimentalLetterSpacing) {\n        metricWidth -= letterSpacing;\n        boundsWidth -= letterSpacing;\n      } else {\n        const val = (_CanvasTextMetrics.graphemeSegmenter(text).length - 1) * letterSpacing;\n        metricWidth += val;\n        boundsWidth += val;\n      }\n    }\n    return Math.max(metricWidth, boundsWidth);\n  }\n  /**\n   * Applies newlines to a string to have it optimally fit into the horizontal\n   * bounds set by the Text object's wordWrapWidth property.\n   * @param text - String to apply word wrapping to\n   * @param style - the style to use when wrapping\n   * @param canvas - optional specification of the canvas to use for measuring.\n   * @returns New string with new lines applied where required\n   */\n  static _wordWrap(text, style, canvas = _CanvasTextMetrics._canvas) {\n    const context = canvas.getContext(\"2d\", contextSettings);\n    let width = 0;\n    let line = \"\";\n    let lines = \"\";\n    const cache = /* @__PURE__ */ Object.create(null);\n    const { letterSpacing, whiteSpace } = style;\n    const collapseSpaces = _CanvasTextMetrics._collapseSpaces(whiteSpace);\n    const collapseNewlines = _CanvasTextMetrics._collapseNewlines(whiteSpace);\n    let canPrependSpaces = !collapseSpaces;\n    const wordWrapWidth = style.wordWrapWidth + letterSpacing;\n    const tokens = _CanvasTextMetrics._tokenize(text);\n    for (let i = 0; i < tokens.length; i++) {\n      let token = tokens[i];\n      if (_CanvasTextMetrics._isNewline(token)) {\n        if (!collapseNewlines) {\n          lines += _CanvasTextMetrics._addLine(line);\n          canPrependSpaces = !collapseSpaces;\n          line = \"\";\n          width = 0;\n          continue;\n        }\n        token = \" \";\n      }\n      if (collapseSpaces) {\n        const currIsBreakingSpace = _CanvasTextMetrics.isBreakingSpace(token);\n        const lastIsBreakingSpace = _CanvasTextMetrics.isBreakingSpace(line[line.length - 1]);\n        if (currIsBreakingSpace && lastIsBreakingSpace) {\n          continue;\n        }\n      }\n      const tokenWidth = _CanvasTextMetrics._getFromCache(token, letterSpacing, cache, context);\n      if (tokenWidth > wordWrapWidth) {\n        if (line !== \"\") {\n          lines += _CanvasTextMetrics._addLine(line);\n          line = \"\";\n          width = 0;\n        }\n        if (_CanvasTextMetrics.canBreakWords(token, style.breakWords)) {\n          const characters = _CanvasTextMetrics.wordWrapSplit(token);\n          for (let j = 0; j < characters.length; j++) {\n            let char = characters[j];\n            let lastChar = char;\n            let k = 1;\n            while (characters[j + k]) {\n              const nextChar = characters[j + k];\n              if (!_CanvasTextMetrics.canBreakChars(lastChar, nextChar, token, j, style.breakWords)) {\n                char += nextChar;\n              } else {\n                break;\n              }\n              lastChar = nextChar;\n              k++;\n            }\n            j += k - 1;\n            const characterWidth = _CanvasTextMetrics._getFromCache(char, letterSpacing, cache, context);\n            if (characterWidth + width > wordWrapWidth) {\n              lines += _CanvasTextMetrics._addLine(line);\n              canPrependSpaces = false;\n              line = \"\";\n              width = 0;\n            }\n            line += char;\n            width += characterWidth;\n          }\n        } else {\n          if (line.length > 0) {\n            lines += _CanvasTextMetrics._addLine(line);\n            line = \"\";\n            width = 0;\n          }\n          const isLastToken = i === tokens.length - 1;\n          lines += _CanvasTextMetrics._addLine(token, !isLastToken);\n          canPrependSpaces = false;\n          line = \"\";\n          width = 0;\n        }\n      } else {\n        if (tokenWidth + width > wordWrapWidth) {\n          canPrependSpaces = false;\n          lines += _CanvasTextMetrics._addLine(line);\n          line = \"\";\n          width = 0;\n        }\n        if (line.length > 0 || !_CanvasTextMetrics.isBreakingSpace(token) || canPrependSpaces) {\n          line += token;\n          width += tokenWidth;\n        }\n      }\n    }\n    lines += _CanvasTextMetrics._addLine(line, false);\n    return lines;\n  }\n  /**\n   * Convenience function for logging each line added during the wordWrap method.\n   * @param line    - The line of text to add\n   * @param newLine - Add new line character to end\n   * @returns A formatted line\n   */\n  static _addLine(line, newLine = true) {\n    line = _CanvasTextMetrics._trimRight(line);\n    line = newLine ? `${line}\n` : line;\n    return line;\n  }\n  /**\n   * Gets & sets the widths of calculated characters in a cache object\n   * @param key            - The key\n   * @param letterSpacing  - The letter spacing\n   * @param cache          - The cache\n   * @param context        - The canvas context\n   * @returns The from cache.\n   */\n  static _getFromCache(key, letterSpacing, cache, context) {\n    let width = cache[key];\n    if (typeof width !== \"number\") {\n      width = _CanvasTextMetrics._measureText(key, letterSpacing, context) + letterSpacing;\n      cache[key] = width;\n    }\n    return width;\n  }\n  /**\n   * Determines whether we should collapse breaking spaces.\n   * @param whiteSpace - The TextStyle property whiteSpace\n   * @returns Should collapse\n   */\n  static _collapseSpaces(whiteSpace) {\n    return whiteSpace === \"normal\" || whiteSpace === \"pre-line\";\n  }\n  /**\n   * Determines whether we should collapse newLine chars.\n   * @param whiteSpace - The white space\n   * @returns should collapse\n   */\n  static _collapseNewlines(whiteSpace) {\n    return whiteSpace === \"normal\";\n  }\n  /**\n   * Trims breaking whitespaces from string.\n   * @param text - The text\n   * @returns Trimmed string\n   */\n  static _trimRight(text) {\n    if (typeof text !== \"string\") {\n      return \"\";\n    }\n    for (let i = text.length - 1; i >= 0; i--) {\n      const char = text[i];\n      if (!_CanvasTextMetrics.isBreakingSpace(char)) {\n        break;\n      }\n      text = text.slice(0, -1);\n    }\n    return text;\n  }\n  /**\n   * Determines if char is a newline.\n   * @param char - The character\n   * @returns True if newline, False otherwise.\n   */\n  static _isNewline(char) {\n    if (typeof char !== \"string\") {\n      return false;\n    }\n    return _CanvasTextMetrics._newlines.includes(char.charCodeAt(0));\n  }\n  /**\n   * Determines if char is a breaking whitespace.\n   *\n   * It allows one to determine whether char should be a breaking whitespace\n   * For example certain characters in CJK langs or numbers.\n   * It must return a boolean.\n   * @param char - The character\n   * @param [_nextChar] - The next character\n   * @returns True if whitespace, False otherwise.\n   */\n  static isBreakingSpace(char, _nextChar) {\n    if (typeof char !== \"string\") {\n      return false;\n    }\n    return _CanvasTextMetrics._breakingSpaces.includes(char.charCodeAt(0));\n  }\n  /**\n   * Splits a string into words, breaking-spaces and newLine characters\n   * @param text - The text\n   * @returns A tokenized array\n   */\n  static _tokenize(text) {\n    const tokens = [];\n    let token = \"\";\n    if (typeof text !== \"string\") {\n      return tokens;\n    }\n    for (let i = 0; i < text.length; i++) {\n      const char = text[i];\n      const nextChar = text[i + 1];\n      if (_CanvasTextMetrics.isBreakingSpace(char, nextChar) || _CanvasTextMetrics._isNewline(char)) {\n        if (token !== \"\") {\n          tokens.push(token);\n          token = \"\";\n        }\n        if (char === \"\\r\" && nextChar === \"\\n\") {\n          tokens.push(\"\\r\\n\");\n          i++;\n        } else {\n          tokens.push(char);\n        }\n        continue;\n      }\n      token += char;\n    }\n    if (token !== \"\") {\n      tokens.push(token);\n    }\n    return tokens;\n  }\n  /**\n   * Overridable helper method used internally by TextMetrics, exposed to allow customizing the class's behavior.\n   *\n   * It allows one to customise which words should break\n   * Examples are if the token is CJK or numbers.\n   * It must return a boolean.\n   * @param _token - The token\n   * @param breakWords - The style attr break words\n   * @returns Whether to break word or not\n   */\n  static canBreakWords(_token, breakWords) {\n    return breakWords;\n  }\n  /**\n   * Overridable helper method used internally by TextMetrics, exposed to allow customizing the class's behavior.\n   *\n   * It allows one to determine whether a pair of characters\n   * should be broken by newlines\n   * For example certain characters in CJK langs or numbers.\n   * It must return a boolean.\n   * @param _char - The character\n   * @param _nextChar - The next character\n   * @param _token - The token/word the characters are from\n   * @param _index - The index in the token of the char\n   * @param _breakWords - The style attr break words\n   * @returns whether to break word or not\n   */\n  static canBreakChars(_char, _nextChar, _token, _index, _breakWords) {\n    return true;\n  }\n  /**\n   * Overridable helper method used internally by TextMetrics, exposed to allow customizing the class's behavior.\n   *\n   * It is called when a token (usually a word) has to be split into separate pieces\n   * in order to determine the point to break a word.\n   * It must return an array of characters.\n   * @param token - The token to split\n   * @returns The characters of the token\n   * @see CanvasTextMetrics.graphemeSegmenter\n   */\n  static wordWrapSplit(token) {\n    return _CanvasTextMetrics.graphemeSegmenter(token);\n  }\n  /**\n   * Calculates the ascent, descent and fontSize of a given font-style\n   * @param font - String representing the style of the font\n   * @returns Font properties object\n   */\n  static measureFont(font) {\n    if (_CanvasTextMetrics._fonts[font]) {\n      return _CanvasTextMetrics._fonts[font];\n    }\n    const context = _CanvasTextMetrics._context;\n    context.font = font;\n    const metrics = context.measureText(_CanvasTextMetrics.METRICS_STRING + _CanvasTextMetrics.BASELINE_SYMBOL);\n    const properties = {\n      ascent: metrics.actualBoundingBoxAscent,\n      descent: metrics.actualBoundingBoxDescent,\n      fontSize: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent\n    };\n    _CanvasTextMetrics._fonts[font] = properties;\n    return properties;\n  }\n  /**\n   * Clear font metrics in metrics cache.\n   * @param {string} [font] - font name. If font name not set then clear cache for all fonts.\n   */\n  static clearMetrics(font = \"\") {\n    if (font) {\n      delete _CanvasTextMetrics._fonts[font];\n    } else {\n      _CanvasTextMetrics._fonts = {};\n    }\n  }\n  /**\n   * Cached canvas element for measuring text\n   * TODO: this should be private, but isn't because of backward compat, will fix later.\n   * @ignore\n   */\n  static get _canvas() {\n    if (!_CanvasTextMetrics.__canvas) {\n      let canvas;\n      try {\n        const c = new OffscreenCanvas(0, 0);\n        const context = c.getContext(\"2d\", contextSettings);\n        if (context?.measureText) {\n          _CanvasTextMetrics.__canvas = c;\n          return c;\n        }\n        canvas = DOMAdapter.get().createCanvas();\n      } catch (_cx) {\n        canvas = DOMAdapter.get().createCanvas();\n      }\n      canvas.width = canvas.height = 10;\n      _CanvasTextMetrics.__canvas = canvas;\n    }\n    return _CanvasTextMetrics.__canvas;\n  }\n  /**\n   * TODO: this should be private, but isn't because of backward compat, will fix later.\n   * @ignore\n   */\n  static get _context() {\n    if (!_CanvasTextMetrics.__context) {\n      _CanvasTextMetrics.__context = _CanvasTextMetrics._canvas.getContext(\"2d\", contextSettings);\n    }\n    return _CanvasTextMetrics.__context;\n  }\n};\n/**\n * String used for calculate font metrics.\n * These characters are all tall to help calculate the height required for text.\n */\n_CanvasTextMetrics.METRICS_STRING = \"|\\xC9q\\xC5\";\n/** Baseline symbol for calculate font metrics. */\n_CanvasTextMetrics.BASELINE_SYMBOL = \"M\";\n/** Baseline multiplier for calculate font metrics. */\n_CanvasTextMetrics.BASELINE_MULTIPLIER = 1.4;\n/** Height multiplier for setting height of canvas to calculate font metrics. */\n_CanvasTextMetrics.HEIGHT_MULTIPLIER = 2;\n/**\n * A Unicode \"character\", or \"grapheme cluster\", can be composed of multiple Unicode code points,\n * such as letters with diacritical marks (e.g. `'\\u0065\\u0301'`, letter e with acute)\n * or emojis with modifiers (e.g. `'\\uD83E\\uDDD1\\u200D\\uD83D\\uDCBB'`, technologist).\n * The new `Intl.Segmenter` API in ES2022 can split the string into grapheme clusters correctly. If it is not available,\n * PixiJS will fallback to use the iterator of String, which can only spilt the string into code points.\n * If you want to get full functionality in environments that don't support `Intl.Segmenter` (such as Firefox),\n * you can use other libraries such as [grapheme-splitter]{@link https://www.npmjs.com/package/grapheme-splitter}\n * or [graphemer]{@link https://www.npmjs.com/package/graphemer} to create a polyfill. Since these libraries can be\n * relatively large in size to handle various Unicode grapheme clusters properly, PixiJS won't use them directly.\n */\n_CanvasTextMetrics.graphemeSegmenter = (() => {\n  if (typeof Intl?.Segmenter === \"function\") {\n    const segmenter = new Intl.Segmenter();\n    return (s) => {\n      const segments = segmenter.segment(s);\n      const result = [];\n      let i = 0;\n      for (const segment of segments) {\n        result[i++] = segment.segment;\n      }\n      return result;\n    };\n  }\n  return (s) => [...s];\n})();\n/**\n * New rendering behavior for letter-spacing which uses Chrome's new native API. This will\n * lead to more accurate letter-spacing results because it does not try to manually draw\n * each character. However, this Chrome API is experimental and may not serve all cases yet.\n * @see TextMetrics.experimentalLetterSpacingSupported\n */\n_CanvasTextMetrics.experimentalLetterSpacing = false;\n/** Cache of {@link TextMetrics.FontMetrics} objects. */\n_CanvasTextMetrics._fonts = {};\n/** Cache of new line chars. */\n_CanvasTextMetrics._newlines = [\n  10,\n  // line feed\n  13\n  // carriage return\n];\n/** Cache of breaking spaces. */\n_CanvasTextMetrics._breakingSpaces = [\n  9,\n  // character tabulation\n  32,\n  // space\n  8192,\n  // en quad\n  8193,\n  // em quad\n  8194,\n  // en space\n  8195,\n  // em space\n  8196,\n  // three-per-em space\n  8197,\n  // four-per-em space\n  8198,\n  // six-per-em space\n  8200,\n  // punctuation space\n  8201,\n  // thin space\n  8202,\n  // hair space\n  8287,\n  // medium mathematical space\n  12288\n  // ideographic space\n];\n/** Cache for measured text metrics */\n_CanvasTextMetrics._measurementCache = lru(1e3);\nlet CanvasTextMetrics = _CanvasTextMetrics;\n\nexport { CanvasTextMetrics };\n//# sourceMappingURL=CanvasTextMetrics.mjs.map\n","import { ExtensionType } from '../extensions/Extensions.mjs';\n\n\"use strict\";\nclass ResizePlugin {\n  /**\n   * Initialize the plugin with scope of application instance\n   * @private\n   * @param {object} [options] - See application options\n   */\n  static init(options) {\n    Object.defineProperty(\n      this,\n      \"resizeTo\",\n      {\n        set(dom) {\n          globalThis.removeEventListener(\"resize\", this.queueResize);\n          this._resizeTo = dom;\n          if (dom) {\n            globalThis.addEventListener(\"resize\", this.queueResize);\n            this.resize();\n          }\n        },\n        get() {\n          return this._resizeTo;\n        }\n      }\n    );\n    this.queueResize = () => {\n      if (!this._resizeTo) {\n        return;\n      }\n      this._cancelResize();\n      this._resizeId = requestAnimationFrame(() => this.resize());\n    };\n    this._cancelResize = () => {\n      if (this._resizeId) {\n        cancelAnimationFrame(this._resizeId);\n        this._resizeId = null;\n      }\n    };\n    this.resize = () => {\n      if (!this._resizeTo) {\n        return;\n      }\n      this._cancelResize();\n      let width;\n      let height;\n      if (this._resizeTo === globalThis.window) {\n        width = globalThis.innerWidth;\n        height = globalThis.innerHeight;\n      } else {\n        const { clientWidth, clientHeight } = this._resizeTo;\n        width = clientWidth;\n        height = clientHeight;\n      }\n      this.renderer.resize(width, height);\n      this.render();\n    };\n    this._resizeId = null;\n    this._resizeTo = null;\n    this.resizeTo = options.resizeTo || null;\n  }\n  /**\n   * Clean up the ticker, scoped to application\n   * @private\n   */\n  static destroy() {\n    globalThis.removeEventListener(\"resize\", this.queueResize);\n    this._cancelResize();\n    this._cancelResize = null;\n    this.queueResize = null;\n    this.resizeTo = null;\n    this.resize = null;\n  }\n}\n/** @ignore */\nResizePlugin.extension = ExtensionType.Application;\n\nexport { ResizePlugin };\n//# sourceMappingURL=ResizePlugin.mjs.map\n","import { ExtensionType } from '../extensions/Extensions.mjs';\nimport { UPDATE_PRIORITY } from '../ticker/const.mjs';\nimport { Ticker } from '../ticker/Ticker.mjs';\n\n\"use strict\";\nclass TickerPlugin {\n  /**\n   * Initialize the plugin with scope of application instance\n   * @private\n   * @param {object} [options] - See application options\n   */\n  static init(options) {\n    options = Object.assign({\n      autoStart: true,\n      sharedTicker: false\n    }, options);\n    Object.defineProperty(\n      this,\n      \"ticker\",\n      {\n        set(ticker) {\n          if (this._ticker) {\n            this._ticker.remove(this.render, this);\n          }\n          this._ticker = ticker;\n          if (ticker) {\n            ticker.add(this.render, this, UPDATE_PRIORITY.LOW);\n          }\n        },\n        get() {\n          return this._ticker;\n        }\n      }\n    );\n    this.stop = () => {\n      this._ticker.stop();\n    };\n    this.start = () => {\n      this._ticker.start();\n    };\n    this._ticker = null;\n    this.ticker = options.sharedTicker ? Ticker.shared : new Ticker();\n    if (options.autoStart) {\n      this.start();\n    }\n  }\n  /**\n   * Clean up the ticker, scoped to application.\n   * @private\n   */\n  static destroy() {\n    if (this._ticker) {\n      const oldTicker = this._ticker;\n      this.ticker = null;\n      oldTicker.destroy();\n    }\n  }\n}\n/** @ignore */\nTickerPlugin.extension = ExtensionType.Application;\n\nexport { TickerPlugin };\n//# sourceMappingURL=TickerPlugin.mjs.map\n","import { extensions } from '../extensions/Extensions.mjs';\nimport { ResizePlugin } from './ResizePlugin.mjs';\nimport { TickerPlugin } from './TickerPlugin.mjs';\n\n\"use strict\";\nextensions.add(ResizePlugin);\nextensions.add(TickerPlugin);\n//# sourceMappingURL=init.mjs.map\n","import { Buffer } from '../../../rendering/renderers/shared/buffer/Buffer.mjs';\nimport { BufferUsage } from '../../../rendering/renderers/shared/buffer/const.mjs';\nimport { Geometry } from '../../../rendering/renderers/shared/geometry/Geometry.mjs';\nimport { deprecation, v8_0_0 } from '../../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nconst _MeshGeometry = class _MeshGeometry extends Geometry {\n  constructor(...args) {\n    let options = args[0] ?? {};\n    if (options instanceof Float32Array) {\n      deprecation(v8_0_0, \"use new MeshGeometry({ positions, uvs, indices }) instead\");\n      options = {\n        positions: options,\n        uvs: args[1],\n        indices: args[2]\n      };\n    }\n    options = { ..._MeshGeometry.defaultOptions, ...options };\n    const positions = options.positions || new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);\n    let uvs = options.uvs;\n    if (!uvs) {\n      if (options.positions) {\n        uvs = new Float32Array(positions.length);\n      } else {\n        uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);\n      }\n    }\n    const indices = options.indices || new Uint32Array([0, 1, 2, 0, 2, 3]);\n    const shrinkToFit = options.shrinkBuffersToFit;\n    const positionBuffer = new Buffer({\n      data: positions,\n      label: \"attribute-mesh-positions\",\n      shrinkToFit,\n      usage: BufferUsage.VERTEX | BufferUsage.COPY_DST\n    });\n    const uvBuffer = new Buffer({\n      data: uvs,\n      label: \"attribute-mesh-uvs\",\n      shrinkToFit,\n      usage: BufferUsage.VERTEX | BufferUsage.COPY_DST\n    });\n    const indexBuffer = new Buffer({\n      data: indices,\n      label: \"index-mesh-buffer\",\n      shrinkToFit,\n      usage: BufferUsage.INDEX | BufferUsage.COPY_DST\n    });\n    super({\n      attributes: {\n        aPosition: {\n          buffer: positionBuffer,\n          format: \"float32x2\",\n          stride: 2 * 4,\n          offset: 0\n        },\n        aUV: {\n          buffer: uvBuffer,\n          format: \"float32x2\",\n          stride: 2 * 4,\n          offset: 0\n        }\n      },\n      indexBuffer,\n      topology: options.topology\n    });\n    this.batchMode = \"auto\";\n  }\n  /** The positions of the mesh. */\n  get positions() {\n    return this.attributes.aPosition.buffer.data;\n  }\n  /**\n   * Set the positions of the mesh.\n   * When setting the positions, its important that the uvs array is at least as long as the positions array.\n   * otherwise the geometry will not be valid.\n   * @param {Float32Array} value - The positions of the mesh.\n   */\n  set positions(value) {\n    this.attributes.aPosition.buffer.data = value;\n  }\n  /** The UVs of the mesh. */\n  get uvs() {\n    return this.attributes.aUV.buffer.data;\n  }\n  /**\n   * Set the UVs of the mesh.\n   * Its important that the uvs array you set is at least as long as the positions array.\n   * otherwise the geometry will not be valid.\n   * @param {Float32Array} value - The UVs of the mesh.\n   */\n  set uvs(value) {\n    this.attributes.aUV.buffer.data = value;\n  }\n  /** The indices of the mesh. */\n  get indices() {\n    return this.indexBuffer.data;\n  }\n  set indices(value) {\n    this.indexBuffer.data = value;\n  }\n};\n_MeshGeometry.defaultOptions = {\n  topology: \"triangle-list\",\n  shrinkBuffersToFit: false\n};\nlet MeshGeometry = _MeshGeometry;\n\nexport { MeshGeometry };\n//# sourceMappingURL=MeshGeometry.mjs.map\n","import { BatchableSprite } from '../../sprite/BatchableSprite.mjs';\n\n\"use strict\";\nclass BatchableText extends BatchableSprite {\n  constructor(renderer) {\n    super();\n    this._renderer = renderer;\n    renderer.runners.resolutionChange.add(this);\n  }\n  resolutionChange() {\n    const text = this.renderable;\n    if (text._autoResolution) {\n      text.onViewUpdate();\n    }\n  }\n  destroy() {\n    const { canvasText } = this._renderer;\n    const refCount = canvasText.getReferenceCount(this.currentKey);\n    if (refCount > 0) {\n      canvasText.decreaseReferenceCount(this.currentKey);\n    } else if (this.texture) {\n      canvasText.returnTexture(this.texture);\n    }\n    this._renderer.runners.resolutionChange.remove(this);\n    this._renderer = null;\n  }\n}\n\nexport { BatchableText };\n//# sourceMappingURL=BatchableText.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { updateTextBounds } from '../utils/updateTextBounds.mjs';\nimport { BatchableText } from './BatchableText.mjs';\n\n\"use strict\";\nclass CanvasTextPipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  validateRenderable(text) {\n    const gpuText = this._getGpuText(text);\n    const newKey = text.styleKey;\n    if (gpuText.currentKey !== newKey)\n      return true;\n    return text._didTextUpdate;\n  }\n  addRenderable(text, instructionSet) {\n    const batchableText = this._getGpuText(text);\n    if (text._didTextUpdate) {\n      const resolution = text._autoResolution ? this._renderer.resolution : text.resolution;\n      if (batchableText.currentKey !== text.styleKey || text.resolution !== resolution) {\n        this._updateGpuText(text);\n      }\n      text._didTextUpdate = false;\n      updateTextBounds(batchableText, text);\n    }\n    this._renderer.renderPipes.batch.addToBatch(batchableText, instructionSet);\n  }\n  updateRenderable(text) {\n    const batchableText = this._getGpuText(text);\n    batchableText._batcher.updateElement(batchableText);\n  }\n  _updateGpuText(text) {\n    const batchableText = this._getGpuText(text);\n    if (batchableText.texture) {\n      this._renderer.canvasText.decreaseReferenceCount(batchableText.currentKey);\n    }\n    text._resolution = text._autoResolution ? this._renderer.resolution : text.resolution;\n    batchableText.texture = this._renderer.canvasText.getManagedTexture(text);\n    batchableText.currentKey = text.styleKey;\n  }\n  _getGpuText(text) {\n    return text._gpuData[this._renderer.uid] || this.initGpuText(text);\n  }\n  initGpuText(text) {\n    const batchableText = new BatchableText(this._renderer);\n    batchableText.currentKey = \"--\";\n    batchableText.renderable = text;\n    batchableText.transform = text.groupTransform;\n    batchableText.bounds = { minX: 0, maxX: 1, minY: 0, maxY: 0 };\n    batchableText.roundPixels = this._renderer._roundPixels | text._roundPixels;\n    text._gpuData[this._renderer.uid] = batchableText;\n    return batchableText;\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\n/** @ignore */\nCanvasTextPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"text\"\n};\n\nexport { CanvasTextPipe };\n//# sourceMappingURL=CanvasTextPipe.mjs.map\n","import { DOMAdapter } from '../../environment/adapter.mjs';\nimport { nextPow2 } from '../../maths/misc/pow2.mjs';\nimport { Rectangle } from '../../maths/shapes/Rectangle.mjs';\n\n\"use strict\";\nlet _internalCanvas = null;\nlet _internalContext = null;\nfunction ensureInternalCanvas(width, height) {\n  if (!_internalCanvas) {\n    _internalCanvas = DOMAdapter.get().createCanvas(256, 128);\n    _internalContext = _internalCanvas.getContext(\"2d\", { willReadFrequently: true });\n    _internalContext.globalCompositeOperation = \"copy\";\n    _internalContext.globalAlpha = 1;\n  }\n  if (_internalCanvas.width < width || _internalCanvas.height < height) {\n    _internalCanvas.width = nextPow2(width);\n    _internalCanvas.height = nextPow2(height);\n  }\n}\nfunction checkRow(data, width, y) {\n  for (let x = 0, index = 4 * y * width; x < width; ++x, index += 4) {\n    if (data[index + 3] !== 0)\n      return false;\n  }\n  return true;\n}\nfunction checkColumn(data, width, x, top, bottom) {\n  const stride = 4 * width;\n  for (let y = top, index = top * stride + 4 * x; y <= bottom; ++y, index += stride) {\n    if (data[index + 3] !== 0)\n      return false;\n  }\n  return true;\n}\nfunction getCanvasBoundingBox(...args) {\n  let options = args[0];\n  if (!options.canvas) {\n    options = { canvas: args[0], resolution: args[1] };\n  }\n  const { canvas } = options;\n  const resolution = Math.min(options.resolution ?? 1, 1);\n  const width = options.width ?? canvas.width;\n  const height = options.height ?? canvas.height;\n  let output = options.output;\n  ensureInternalCanvas(width, height);\n  if (!_internalContext) {\n    throw new TypeError(\"Failed to get canvas 2D context\");\n  }\n  _internalContext.drawImage(\n    canvas,\n    0,\n    0,\n    width,\n    height,\n    0,\n    0,\n    width * resolution,\n    height * resolution\n  );\n  const imageData = _internalContext.getImageData(0, 0, width, height);\n  const data = imageData.data;\n  let left = 0;\n  let top = 0;\n  let right = width - 1;\n  let bottom = height - 1;\n  while (top < height && checkRow(data, width, top))\n    ++top;\n  if (top === height)\n    return Rectangle.EMPTY;\n  while (checkRow(data, width, bottom))\n    --bottom;\n  while (checkColumn(data, width, left, top, bottom))\n    ++left;\n  while (checkColumn(data, width, right, top, bottom))\n    --right;\n  ++right;\n  ++bottom;\n  _internalContext.globalCompositeOperation = \"source-over\";\n  _internalContext.strokeRect(left, top, right - left, bottom - top);\n  _internalContext.globalCompositeOperation = \"copy\";\n  output ?? (output = new Rectangle());\n  output.set(left / resolution, top / resolution, (right - left) / resolution, (bottom - top) / resolution);\n  return output;\n}\n\nexport { getCanvasBoundingBox };\n//# sourceMappingURL=getCanvasBoundingBox.mjs.map\n","import { Color } from '../../../color/Color.mjs';\nimport { Rectangle } from '../../../maths/shapes/Rectangle.mjs';\nimport { CanvasPool } from '../../../rendering/renderers/shared/texture/CanvasPool.mjs';\nimport { getCanvasBoundingBox } from '../../../utils/canvas/getCanvasBoundingBox.mjs';\nimport { CanvasTextMetrics } from './CanvasTextMetrics.mjs';\nimport { fontStringFromTextStyle } from './utils/fontStringFromTextStyle.mjs';\nimport { getCanvasFillStyle } from './utils/getCanvasFillStyle.mjs';\n\n\"use strict\";\nconst tempRect = new Rectangle();\nclass CanvasTextGeneratorClass {\n  /**\n   * Creates a canvas with the specified text rendered to it.\n   *\n   * Generates a canvas of appropriate size, renders the text with the provided style,\n   * and returns both the canvas/context and a Rectangle representing the text bounds.\n   *\n   * When trim is enabled in the style, the frame will represent the bounds of the\n   * non-transparent pixels, which can be smaller than the full canvas.\n   * @param options - The options for generating the text canvas\n   * @param options.text - The text to render\n   * @param options.style - The style to apply to the text\n   * @param options.resolution - The resolution of the canvas (defaults to 1)\n   * @param options.padding\n   * @returns An object containing the canvas/context and the frame (bounds) of the text\n   */\n  getCanvasAndContext(options) {\n    const { text, style, resolution = 1 } = options;\n    const padding = style._getFinalPadding();\n    const measured = CanvasTextMetrics.measureText(text || \" \", style);\n    const width = Math.ceil(Math.ceil(Math.max(1, measured.width) + padding * 2) * resolution);\n    const height = Math.ceil(Math.ceil(Math.max(1, measured.height) + padding * 2) * resolution);\n    const canvasAndContext = CanvasPool.getOptimalCanvasAndContext(width, height);\n    this._renderTextToCanvas(text, style, padding, resolution, canvasAndContext);\n    const frame = style.trim ? getCanvasBoundingBox({ canvas: canvasAndContext.canvas, width, height, resolution: 1, output: tempRect }) : tempRect.set(0, 0, width, height);\n    return {\n      canvasAndContext,\n      frame\n    };\n  }\n  /**\n   * Returns a canvas and context to the pool.\n   *\n   * This should be called when you're done with the canvas to allow reuse\n   * and prevent memory leaks.\n   * @param canvasAndContext - The canvas and context to return to the pool\n   */\n  returnCanvasAndContext(canvasAndContext) {\n    CanvasPool.returnCanvasAndContext(canvasAndContext);\n  }\n  /**\n   * Renders text to its canvas, and updates its texture.\n   * @param text - The text to render\n   * @param style - The style of the text\n   * @param padding - The padding of the text\n   * @param resolution - The resolution of the text\n   * @param canvasAndContext - The canvas and context to render the text to\n   */\n  _renderTextToCanvas(text, style, padding, resolution, canvasAndContext) {\n    const { canvas, context } = canvasAndContext;\n    const font = fontStringFromTextStyle(style);\n    const measured = CanvasTextMetrics.measureText(text || \" \", style);\n    const lines = measured.lines;\n    const lineHeight = measured.lineHeight;\n    const lineWidths = measured.lineWidths;\n    const maxLineWidth = measured.maxLineWidth;\n    const fontProperties = measured.fontProperties;\n    const height = canvas.height;\n    context.resetTransform();\n    context.scale(resolution, resolution);\n    context.textBaseline = style.textBaseline;\n    if (style._stroke?.width) {\n      const strokeStyle = style._stroke;\n      context.lineWidth = strokeStyle.width;\n      context.miterLimit = strokeStyle.miterLimit;\n      context.lineJoin = strokeStyle.join;\n      context.lineCap = strokeStyle.cap;\n    }\n    context.font = font;\n    let linePositionX;\n    let linePositionY;\n    const passesCount = style.dropShadow ? 2 : 1;\n    for (let i = 0; i < passesCount; ++i) {\n      const isShadowPass = style.dropShadow && i === 0;\n      const dsOffsetText = isShadowPass ? Math.ceil(Math.max(1, height) + padding * 2) : 0;\n      const dsOffsetShadow = dsOffsetText * resolution;\n      if (isShadowPass) {\n        context.fillStyle = \"black\";\n        context.strokeStyle = \"black\";\n        const shadowOptions = style.dropShadow;\n        const dropShadowColor = shadowOptions.color;\n        const dropShadowAlpha = shadowOptions.alpha;\n        context.shadowColor = Color.shared.setValue(dropShadowColor).setAlpha(dropShadowAlpha).toRgbaString();\n        const dropShadowBlur = shadowOptions.blur * resolution;\n        const dropShadowDistance = shadowOptions.distance * resolution;\n        context.shadowBlur = dropShadowBlur;\n        context.shadowOffsetX = Math.cos(shadowOptions.angle) * dropShadowDistance;\n        context.shadowOffsetY = Math.sin(shadowOptions.angle) * dropShadowDistance + dsOffsetShadow;\n      } else {\n        context.fillStyle = style._fill ? getCanvasFillStyle(style._fill, context, measured, padding * 2) : null;\n        if (style._stroke?.width) {\n          const strokePadding = style._stroke.width * 0.5 + padding * 2;\n          context.strokeStyle = getCanvasFillStyle(style._stroke, context, measured, strokePadding);\n        }\n        context.shadowColor = \"black\";\n      }\n      let linePositionYShift = (lineHeight - fontProperties.fontSize) / 2;\n      if (lineHeight - fontProperties.fontSize < 0) {\n        linePositionYShift = 0;\n      }\n      const strokeWidth = style._stroke?.width ?? 0;\n      for (let i2 = 0; i2 < lines.length; i2++) {\n        linePositionX = strokeWidth / 2;\n        linePositionY = strokeWidth / 2 + i2 * lineHeight + fontProperties.ascent + linePositionYShift;\n        if (style.align === \"right\") {\n          linePositionX += maxLineWidth - lineWidths[i2];\n        } else if (style.align === \"center\") {\n          linePositionX += (maxLineWidth - lineWidths[i2]) / 2;\n        }\n        if (style._stroke?.width) {\n          this._drawLetterSpacing(\n            lines[i2],\n            style,\n            canvasAndContext,\n            linePositionX + padding,\n            linePositionY + padding - dsOffsetText,\n            true\n          );\n        }\n        if (style._fill !== void 0) {\n          this._drawLetterSpacing(\n            lines[i2],\n            style,\n            canvasAndContext,\n            linePositionX + padding,\n            linePositionY + padding - dsOffsetText\n          );\n        }\n      }\n    }\n  }\n  /**\n   * Render the text with letter-spacing.\n   *\n   * This method handles rendering text with the correct letter spacing, using either:\n   * 1. Native letter spacing if supported by the browser\n   * 2. Manual letter spacing calculation if not natively supported\n   *\n   * For manual letter spacing, it calculates the position of each character\n   * based on its width and the desired spacing.\n   * @param text - The text to draw\n   * @param style - The text style to apply\n   * @param canvasAndContext - The canvas and context to draw to\n   * @param x - Horizontal position to draw the text\n   * @param y - Vertical position to draw the text\n   * @param isStroke - Whether to render the stroke (true) or fill (false)\n   * @private\n   */\n  _drawLetterSpacing(text, style, canvasAndContext, x, y, isStroke = false) {\n    const { context } = canvasAndContext;\n    const letterSpacing = style.letterSpacing;\n    let useExperimentalLetterSpacing = false;\n    if (CanvasTextMetrics.experimentalLetterSpacingSupported) {\n      if (CanvasTextMetrics.experimentalLetterSpacing) {\n        context.letterSpacing = `${letterSpacing}px`;\n        context.textLetterSpacing = `${letterSpacing}px`;\n        useExperimentalLetterSpacing = true;\n      } else {\n        context.letterSpacing = \"0px\";\n        context.textLetterSpacing = \"0px\";\n      }\n    }\n    if (letterSpacing === 0 || useExperimentalLetterSpacing) {\n      if (isStroke) {\n        context.strokeText(text, x, y);\n      } else {\n        context.fillText(text, x, y);\n      }\n      return;\n    }\n    let currentPosition = x;\n    const stringArray = CanvasTextMetrics.graphemeSegmenter(text);\n    let previousWidth = context.measureText(text).width;\n    let currentWidth = 0;\n    for (let i = 0; i < stringArray.length; ++i) {\n      const currentChar = stringArray[i];\n      if (isStroke) {\n        context.strokeText(currentChar, currentPosition, y);\n      } else {\n        context.fillText(currentChar, currentPosition, y);\n      }\n      let textStr = \"\";\n      for (let j = i + 1; j < stringArray.length; ++j) {\n        textStr += stringArray[j];\n      }\n      currentWidth = context.measureText(textStr).width;\n      currentPosition += previousWidth - currentWidth + letterSpacing;\n      previousWidth = currentWidth;\n    }\n  }\n}\nconst CanvasTextGenerator = new CanvasTextGeneratorClass();\n\nexport { CanvasTextGenerator };\n//# sourceMappingURL=CanvasTextGenerator.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { TexturePool } from '../../../rendering/renderers/shared/texture/TexturePool.mjs';\nimport { TextureStyle } from '../../../rendering/renderers/shared/texture/TextureStyle.mjs';\nimport { deprecation } from '../../../utils/logging/deprecation.mjs';\nimport { TextStyle } from '../TextStyle.mjs';\nimport { getPo2TextureFromSource } from '../utils/getPo2TextureFromSource.mjs';\nimport { CanvasTextGenerator } from './CanvasTextGenerator.mjs';\n\n\"use strict\";\nclass CanvasTextSystem {\n  constructor(_renderer) {\n    this._activeTextures = {};\n    this._renderer = _renderer;\n  }\n  getTexture(options, _resolution, _style, _textKey) {\n    if (typeof options === \"string\") {\n      deprecation(\"8.0.0\", \"CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments\");\n      options = {\n        text: options,\n        style: _style,\n        resolution: _resolution\n      };\n    }\n    if (!(options.style instanceof TextStyle)) {\n      options.style = new TextStyle(options.style);\n    }\n    if (!(options.textureStyle instanceof TextureStyle)) {\n      options.textureStyle = new TextureStyle(options.textureStyle);\n    }\n    if (typeof options.text !== \"string\") {\n      options.text = options.text.toString();\n    }\n    const { text, style, textureStyle } = options;\n    const resolution = options.resolution ?? this._renderer.resolution;\n    const { frame, canvasAndContext } = CanvasTextGenerator.getCanvasAndContext({\n      text,\n      style,\n      resolution\n    });\n    const texture = getPo2TextureFromSource(canvasAndContext.canvas, frame.width, frame.height, resolution);\n    if (textureStyle)\n      texture.source.style = textureStyle;\n    if (style.trim) {\n      frame.pad(style.padding);\n      texture.frame.copyFrom(frame);\n      texture.frame.scale(1 / resolution);\n      texture.updateUvs();\n    }\n    if (style.filters) {\n      const filteredTexture = this._applyFilters(texture, style.filters);\n      this.returnTexture(texture);\n      CanvasTextGenerator.returnCanvasAndContext(canvasAndContext);\n      return filteredTexture;\n    }\n    this._renderer.texture.initSource(texture._source);\n    CanvasTextGenerator.returnCanvasAndContext(canvasAndContext);\n    return texture;\n  }\n  /**\n   * Returns a texture that was created wit the above `getTexture` function.\n   * Handy if you are done with a texture and want to return it to the pool.\n   * @param texture - The texture to be returned.\n   */\n  returnTexture(texture) {\n    const source = texture.source;\n    source.resource = null;\n    source.uploadMethodId = \"unknown\";\n    source.alphaMode = \"no-premultiply-alpha\";\n    TexturePool.returnTexture(texture, true);\n  }\n  /**\n   * Renders text to its canvas, and updates its texture.\n   * @deprecated since 8.10.0\n   */\n  renderTextToCanvas() {\n    deprecation(\n      \"8.10.0\",\n      \"CanvasTextSystem.renderTextToCanvas: no longer supported, use CanvasTextSystem.getTexture instead\"\n    );\n  }\n  /**\n   * Gets or creates a managed texture for a Text object. This method handles texture reuse and reference counting.\n   * @param text - The Text object that needs a texture\n   * @returns A Texture instance that represents the rendered text\n   * @remarks\n   * This method performs the following:\n   * 1. Sets the appropriate resolution based on auto-resolution settings\n   * 2. Checks if a texture already exists for the text's style\n   * 3. Creates a new texture if needed or returns an existing one\n   * 4. Manages reference counting for texture reuse\n   */\n  getManagedTexture(text) {\n    text._resolution = text._autoResolution ? this._renderer.resolution : text.resolution;\n    const textKey = text.styleKey;\n    if (this._activeTextures[textKey]) {\n      this._increaseReferenceCount(textKey);\n      return this._activeTextures[textKey].texture;\n    }\n    const texture = this.getTexture({\n      text: text.text,\n      style: text.style,\n      resolution: text._resolution,\n      textureStyle: text.textureStyle\n    });\n    this._activeTextures[textKey] = {\n      texture,\n      usageCount: 1\n    };\n    return texture;\n  }\n  /**\n   * Decreases the reference count for a texture associated with a text key.\n   * When the reference count reaches zero, the texture is returned to the pool.\n   * @param textKey - The unique key identifying the text style configuration\n   * @remarks\n   * This method is crucial for memory management, ensuring textures are properly\n   * cleaned up when they are no longer needed by any Text instances.\n   */\n  decreaseReferenceCount(textKey) {\n    const activeTexture = this._activeTextures[textKey];\n    activeTexture.usageCount--;\n    if (activeTexture.usageCount === 0) {\n      this.returnTexture(activeTexture.texture);\n      this._activeTextures[textKey] = null;\n    }\n  }\n  /**\n   * Gets the current reference count for a texture associated with a text key.\n   * @param textKey - The unique key identifying the text style configuration\n   * @returns The number of Text instances currently using this texture\n   */\n  getReferenceCount(textKey) {\n    return this._activeTextures[textKey]?.usageCount ?? 0;\n  }\n  _increaseReferenceCount(textKey) {\n    this._activeTextures[textKey].usageCount++;\n  }\n  /**\n   * Applies the specified filters to the given texture.\n   *\n   * This method takes a texture and a list of filters, applies the filters to the texture,\n   * and returns the resulting texture. It also ensures that the alpha mode of the resulting\n   * texture is set to 'premultiplied-alpha'.\n   * @param {Texture} texture - The texture to which the filters will be applied.\n   * @param {Filter[]} filters - The filters to apply to the texture.\n   * @returns {Texture} The resulting texture after all filters have been applied.\n   */\n  _applyFilters(texture, filters) {\n    const currentRenderTarget = this._renderer.renderTarget.renderTarget;\n    const resultTexture = this._renderer.filter.generateFilteredTexture({\n      texture,\n      filters\n    });\n    this._renderer.renderTarget.bind(currentRenderTarget, false);\n    return resultTexture;\n  }\n  destroy() {\n    this._renderer = null;\n    for (const key in this._activeTextures) {\n      if (this._activeTextures[key])\n        this.returnTexture(this._activeTextures[key].texture);\n    }\n    this._activeTextures = null;\n  }\n}\n/** @ignore */\nCanvasTextSystem.extension = {\n  type: [\n    ExtensionType.WebGLSystem,\n    ExtensionType.WebGPUSystem,\n    ExtensionType.CanvasSystem\n  ],\n  name: \"canvasText\"\n};\n\nexport { CanvasTextSystem };\n//# sourceMappingURL=CanvasTextSystem.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { CanvasTextPipe } from './canvas/CanvasTextPipe.mjs';\nimport { CanvasTextSystem } from './canvas/CanvasTextSystem.mjs';\n\n\"use strict\";\nextensions.add(CanvasTextSystem);\nextensions.add(CanvasTextPipe);\n//# sourceMappingURL=init.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { BindGroup } from '../../../rendering/renderers/gpu/shader/BindGroup.mjs';\nimport { UniformGroup } from '../../../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { getAdjustedBlendModeBlend } from '../../../rendering/renderers/shared/state/getAdjustedBlendModeBlend.mjs';\nimport { color32BitToUniform } from '../../graphics/gpu/colorToUniform.mjs';\nimport { BatchableMesh } from './BatchableMesh.mjs';\n\n\"use strict\";\nclass MeshGpuData {\n  destroy() {\n  }\n}\nclass MeshPipe {\n  constructor(renderer, adaptor) {\n    this.localUniforms = new UniformGroup({\n      uTransformMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uColor: { value: new Float32Array([1, 1, 1, 1]), type: \"vec4<f32>\" },\n      uRound: { value: 0, type: \"f32\" }\n    });\n    this.localUniformsBindGroup = new BindGroup({\n      0: this.localUniforms\n    });\n    this.renderer = renderer;\n    this._adaptor = adaptor;\n    this._adaptor.init();\n  }\n  validateRenderable(mesh) {\n    const meshData = this._getMeshData(mesh);\n    const wasBatched = meshData.batched;\n    const isBatched = mesh.batched;\n    meshData.batched = isBatched;\n    if (wasBatched !== isBatched) {\n      return true;\n    } else if (isBatched) {\n      const geometry = mesh._geometry;\n      if (geometry.indices.length !== meshData.indexSize || geometry.positions.length !== meshData.vertexSize) {\n        meshData.indexSize = geometry.indices.length;\n        meshData.vertexSize = geometry.positions.length;\n        return true;\n      }\n      const batchableMesh = this._getBatchableMesh(mesh);\n      if (batchableMesh.texture.uid !== mesh._texture.uid) {\n        batchableMesh._textureMatrixUpdateId = -1;\n      }\n      return !batchableMesh._batcher.checkAndUpdateTexture(\n        batchableMesh,\n        mesh._texture\n      );\n    }\n    return false;\n  }\n  addRenderable(mesh, instructionSet) {\n    const batcher = this.renderer.renderPipes.batch;\n    const meshData = this._getMeshData(mesh);\n    if (mesh.didViewUpdate) {\n      meshData.indexSize = mesh._geometry.indices?.length;\n      meshData.vertexSize = mesh._geometry.positions?.length;\n    }\n    if (meshData.batched) {\n      const gpuBatchableMesh = this._getBatchableMesh(mesh);\n      gpuBatchableMesh.setTexture(mesh._texture);\n      gpuBatchableMesh.geometry = mesh._geometry;\n      batcher.addToBatch(gpuBatchableMesh, instructionSet);\n    } else {\n      batcher.break(instructionSet);\n      instructionSet.add(mesh);\n    }\n  }\n  updateRenderable(mesh) {\n    if (mesh.batched) {\n      const gpuBatchableMesh = this._getBatchableMesh(mesh);\n      gpuBatchableMesh.setTexture(mesh._texture);\n      gpuBatchableMesh.geometry = mesh._geometry;\n      gpuBatchableMesh._batcher.updateElement(gpuBatchableMesh);\n    }\n  }\n  execute(mesh) {\n    if (!mesh.isRenderable)\n      return;\n    mesh.state.blendMode = getAdjustedBlendModeBlend(mesh.groupBlendMode, mesh.texture._source);\n    const localUniforms = this.localUniforms;\n    localUniforms.uniforms.uTransformMatrix = mesh.groupTransform;\n    localUniforms.uniforms.uRound = this.renderer._roundPixels | mesh._roundPixels;\n    localUniforms.update();\n    color32BitToUniform(\n      mesh.groupColorAlpha,\n      localUniforms.uniforms.uColor,\n      0\n    );\n    this._adaptor.execute(this, mesh);\n  }\n  _getMeshData(mesh) {\n    var _a, _b;\n    (_a = mesh._gpuData)[_b = this.renderer.uid] || (_a[_b] = new MeshGpuData());\n    return mesh._gpuData[this.renderer.uid].meshData || this._initMeshData(mesh);\n  }\n  _initMeshData(mesh) {\n    mesh._gpuData[this.renderer.uid].meshData = {\n      batched: mesh.batched,\n      indexSize: 0,\n      vertexSize: 0\n    };\n    return mesh._gpuData[this.renderer.uid].meshData;\n  }\n  _getBatchableMesh(mesh) {\n    var _a, _b;\n    (_a = mesh._gpuData)[_b = this.renderer.uid] || (_a[_b] = new MeshGpuData());\n    return mesh._gpuData[this.renderer.uid].batchableMesh || this._initBatchableMesh(mesh);\n  }\n  _initBatchableMesh(mesh) {\n    const gpuMesh = new BatchableMesh();\n    gpuMesh.renderable = mesh;\n    gpuMesh.setTexture(mesh._texture);\n    gpuMesh.transform = mesh.groupTransform;\n    gpuMesh.roundPixels = this.renderer._roundPixels | mesh._roundPixels;\n    mesh._gpuData[this.renderer.uid].batchableMesh = gpuMesh;\n    return gpuMesh;\n  }\n  destroy() {\n    this.localUniforms = null;\n    this.localUniformsBindGroup = null;\n    this._adaptor.destroy();\n    this._adaptor = null;\n    this.renderer = null;\n  }\n}\n/** @ignore */\nMeshPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"mesh\"\n};\n\nexport { MeshGpuData, MeshPipe };\n//# sourceMappingURL=MeshPipe.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { MeshPipe } from './shared/MeshPipe.mjs';\n\n\"use strict\";\nextensions.add(MeshPipe);\n//# sourceMappingURL=init.mjs.map\n","/**\n * tiny-lru\n *\n * @copyright 2025 Jason Mulligan <jason.mulligan@avoidwork.com>\n * @license BSD-3-Clause\n * @version 11.4.5\n */\n/**\n * A high-performance Least Recently Used (LRU) cache implementation with optional TTL support.\n * Items are automatically evicted when the cache reaches its maximum size,\n * removing the least recently used items first. All core operations (get, set, delete) are O(1).\n *\n * @class LRU\n * @example\n * // Create a cache with max 100 items\n * const cache = new LRU(100);\n * cache.set('key1', 'value1');\n * console.log(cache.get('key1')); // 'value1'\n *\n * @example\n * // Create a cache with TTL\n * const cache = new LRU(100, 5000); // 5 second TTL\n * cache.set('key1', 'value1');\n * // After 5 seconds, key1 will be expired\n */\nclass LRU {\n\t/**\n\t * Creates a new LRU cache instance.\n\t * Note: Constructor does not validate parameters. Use lru() factory function for parameter validation.\n\t *\n\t * @constructor\n\t * @param {number} [max=0] - Maximum number of items to store. 0 means unlimited.\n\t * @param {number} [ttl=0] - Time to live in milliseconds. 0 means no expiration.\n\t * @param {boolean} [resetTtl=false] - Whether to reset TTL when accessing existing items via get().\n\t * @example\n\t * const cache = new LRU(1000, 60000, true); // 1000 items, 1 minute TTL, reset on access\n\t * @see {@link lru} For parameter validation\n\t * @since 1.0.0\n\t */\n\tconstructor (max = 0, ttl = 0, resetTtl = false) {\n\t\tthis.first = null;\n\t\tthis.items = Object.create(null);\n\t\tthis.last = null;\n\t\tthis.max = max;\n\t\tthis.resetTtl = resetTtl;\n\t\tthis.size = 0;\n\t\tthis.ttl = ttl;\n\t}\n\n\t/**\n\t * Removes all items from the cache.\n\t *\n\t * @method clear\n\t * @memberof LRU\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.clear();\n\t * console.log(cache.size); // 0\n\t * @since 1.0.0\n\t */\n\tclear () {\n\t\tthis.first = null;\n\t\tthis.items = Object.create(null);\n\t\tthis.last = null;\n\t\tthis.size = 0;\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Removes an item from the cache by key.\n\t *\n\t * @method delete\n\t * @memberof LRU\n\t * @param {string} key - The key of the item to delete.\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.set('key1', 'value1');\n\t * cache.delete('key1');\n\t * console.log(cache.has('key1')); // false\n\t * @see {@link LRU#has}\n\t * @see {@link LRU#clear}\n\t * @since 1.0.0\n\t */\n\tdelete (key) {\n\t\tif (this.has(key)) {\n\t\t\tconst item = this.items[key];\n\n\t\t\tdelete this.items[key];\n\t\t\tthis.size--;\n\n\t\t\tif (item.prev !== null) {\n\t\t\t\titem.prev.next = item.next;\n\t\t\t}\n\n\t\t\tif (item.next !== null) {\n\t\t\t\titem.next.prev = item.prev;\n\t\t\t}\n\n\t\t\tif (this.first === item) {\n\t\t\t\tthis.first = item.next;\n\t\t\t}\n\n\t\t\tif (this.last === item) {\n\t\t\t\tthis.last = item.prev;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an array of [key, value] pairs for the specified keys.\n\t * Order follows LRU order (least to most recently used).\n\t *\n\t * @method entries\n\t * @memberof LRU\n\t * @param {string[]} [keys=this.keys()] - Array of keys to get entries for. Defaults to all keys.\n\t * @returns {Array<Array<*>>} Array of [key, value] pairs in LRU order.\n\t * @example\n\t * cache.set('a', 1).set('b', 2);\n\t * console.log(cache.entries()); // [['a', 1], ['b', 2]]\n\t * console.log(cache.entries(['a'])); // [['a', 1]]\n\t * @see {@link LRU#keys}\n\t * @see {@link LRU#values}\n\t * @since 11.1.0\n\t */\n\tentries (keys = this.keys()) {\n\t\treturn keys.map(key => [key, this.get(key)]);\n\t}\n\n\t/**\n\t * Removes the least recently used item from the cache.\n\t *\n\t * @method evict\n\t * @memberof LRU\n\t * @param {boolean} [bypass=false] - Whether to force eviction even when cache is empty.\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.set('old', 'value').set('new', 'value');\n\t * cache.evict(); // Removes 'old' item\n\t * @see {@link LRU#setWithEvicted}\n\t * @since 1.0.0\n\t */\n\tevict (bypass = false) {\n\t\tif (bypass || this.size > 0) {\n\t\t\tconst item = this.first;\n\n\t\t\tdelete this.items[item.key];\n\n\t\t\tif (--this.size === 0) {\n\t\t\t\tthis.first = null;\n\t\t\t\tthis.last = null;\n\t\t\t} else {\n\t\t\t\tthis.first = item.next;\n\t\t\t\tthis.first.prev = null;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns the expiration timestamp for a given key.\n\t *\n\t * @method expiresAt\n\t * @memberof LRU\n\t * @param {string} key - The key to check expiration for.\n\t * @returns {number|undefined} The expiration timestamp in milliseconds, or undefined if key doesn't exist.\n\t * @example\n\t * const cache = new LRU(100, 5000); // 5 second TTL\n\t * cache.set('key1', 'value1');\n\t * console.log(cache.expiresAt('key1')); // timestamp 5 seconds from now\n\t * @see {@link LRU#get}\n\t * @see {@link LRU#has}\n\t * @since 1.0.0\n\t */\n\texpiresAt (key) {\n\t\tlet result;\n\n\t\tif (this.has(key)) {\n\t\t\tresult = this.items[key].expiry;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Retrieves a value from the cache by key. Updates the item's position to most recently used.\n\t *\n\t * @method get\n\t * @memberof LRU\n\t * @param {string} key - The key to retrieve.\n\t * @returns {*} The value associated with the key, or undefined if not found or expired.\n\t * @example\n\t * cache.set('key1', 'value1');\n\t * console.log(cache.get('key1')); // 'value1'\n\t * console.log(cache.get('nonexistent')); // undefined\n\t * @see {@link LRU#set}\n\t * @see {@link LRU#has}\n\t * @since 1.0.0\n\t */\n\tget (key) {\n\t\tconst item = this.items[key];\n\n\t\tif (item !== undefined) {\n\t\t\t// Check TTL only if enabled to avoid unnecessary Date.now() calls\n\t\t\tif (this.ttl > 0) {\n\t\t\t\tif (item.expiry <= Date.now()) {\n\t\t\t\t\tthis.delete(key);\n\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Fast LRU update without full set() overhead\n\t\t\tthis.moveToEnd(item);\n\n\t\t\treturn item.value;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Checks if a key exists in the cache.\n\t *\n\t * @method has\n\t * @memberof LRU\n\t * @param {string} key - The key to check for.\n\t * @returns {boolean} True if the key exists, false otherwise.\n\t * @example\n\t * cache.set('key1', 'value1');\n\t * console.log(cache.has('key1')); // true\n\t * console.log(cache.has('nonexistent')); // false\n\t * @see {@link LRU#get}\n\t * @see {@link LRU#delete}\n\t * @since 9.0.0\n\t */\n\thas (key) {\n\t\treturn key in this.items;\n\t}\n\n\t/**\n\t * Efficiently moves an item to the end of the LRU list (most recently used position).\n\t * This is an internal optimization method that avoids the overhead of the full set() operation\n\t * when only LRU position needs to be updated.\n\t *\n\t * @method moveToEnd\n\t * @memberof LRU\n\t * @param {Object} item - The cache item with prev/next pointers to reposition.\n\t * @private\n\t * @since 11.3.5\n\t */\n\tmoveToEnd (item) {\n\t\t// If already at the end, nothing to do\n\t\tif (this.last === item) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Remove item from current position in the list\n\t\tif (item.prev !== null) {\n\t\t\titem.prev.next = item.next;\n\t\t}\n\n\t\tif (item.next !== null) {\n\t\t\titem.next.prev = item.prev;\n\t\t}\n\n\t\t// Update first pointer if this was the first item\n\t\tif (this.first === item) {\n\t\t\tthis.first = item.next;\n\t\t}\n\n\t\t// Add item to the end\n\t\titem.prev = this.last;\n\t\titem.next = null;\n\n\t\tif (this.last !== null) {\n\t\t\tthis.last.next = item;\n\t\t}\n\n\t\tthis.last = item;\n\n\t\t// Handle edge case: if this was the only item, it's also first\n\t\tif (this.first === null) {\n\t\t\tthis.first = item;\n\t\t}\n\t}\n\n\t/**\n\t * Returns an array of all keys in the cache, ordered from least to most recently used.\n\t *\n\t * @method keys\n\t * @memberof LRU\n\t * @returns {string[]} Array of keys in LRU order.\n\t * @example\n\t * cache.set('a', 1).set('b', 2);\n\t * cache.get('a'); // Move 'a' to most recent\n\t * console.log(cache.keys()); // ['b', 'a']\n\t * @see {@link LRU#values}\n\t * @see {@link LRU#entries}\n\t * @since 9.0.0\n\t */\n\tkeys () {\n\t\tconst result = [];\n\t\tlet x = this.first;\n\n\t\twhile (x !== null) {\n\t\t\tresult.push(x.key);\n\t\t\tx = x.next;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Sets a value in the cache and returns any evicted item.\n\t *\n\t * @method setWithEvicted\n\t * @memberof LRU\n\t * @param {string} key - The key to set.\n\t * @param {*} value - The value to store.\n\t * @param {boolean} [resetTtl=this.resetTtl] - Whether to reset the TTL for this operation.\n\t * @returns {Object|null} The evicted item (if any) with shape {key, value, expiry, prev, next}, or null.\n\t * @example\n\t * const cache = new LRU(2);\n\t * cache.set('a', 1).set('b', 2);\n\t * const evicted = cache.setWithEvicted('c', 3); // evicted = {key: 'a', value: 1, ...}\n\t * @see {@link LRU#set}\n\t * @see {@link LRU#evict}\n\t * @since 11.3.0\n\t */\n\tsetWithEvicted (key, value, resetTtl = this.resetTtl) {\n\t\tlet evicted = null;\n\n\t\tif (this.has(key)) {\n\t\t\tthis.set(key, value, true, resetTtl);\n\t\t} else {\n\t\t\tif (this.max > 0 && this.size === this.max) {\n\t\t\t\tevicted = {...this.first};\n\t\t\t\tthis.evict(true);\n\t\t\t}\n\n\t\t\tlet item = this.items[key] = {\n\t\t\t\texpiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n\t\t\t\tkey: key,\n\t\t\t\tprev: this.last,\n\t\t\t\tnext: null,\n\t\t\t\tvalue\n\t\t\t};\n\n\t\t\tif (++this.size === 1) {\n\t\t\t\tthis.first = item;\n\t\t\t} else {\n\t\t\t\tthis.last.next = item;\n\t\t\t}\n\n\t\t\tthis.last = item;\n\t\t}\n\n\t\treturn evicted;\n\t}\n\n\t/**\n\t * Sets a value in the cache. Updates the item's position to most recently used.\n\t *\n\t * @method set\n\t * @memberof LRU\n\t * @param {string} key - The key to set.\n\t * @param {*} value - The value to store.\n\t * @param {boolean} [bypass=false] - Internal parameter for setWithEvicted method.\n\t * @param {boolean} [resetTtl=this.resetTtl] - Whether to reset the TTL for this operation.\n\t * @returns {LRU} The LRU instance for method chaining.\n\t * @example\n\t * cache.set('key1', 'value1')\n\t *      .set('key2', 'value2')\n\t *      .set('key3', 'value3');\n\t * @see {@link LRU#get}\n\t * @see {@link LRU#setWithEvicted}\n\t * @since 1.0.0\n\t */\n\tset (key, value, bypass = false, resetTtl = this.resetTtl) {\n\t\tlet item = this.items[key];\n\n\t\tif (bypass || item !== undefined) {\n\t\t\t// Existing item: update value and position\n\t\t\titem.value = value;\n\n\t\t\tif (bypass === false && resetTtl) {\n\t\t\t\titem.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl;\n\t\t\t}\n\n\t\t\t// Always move to end, but the bypass parameter affects TTL reset behavior\n\t\t\tthis.moveToEnd(item);\n\t\t} else {\n\t\t\t// New item: check for eviction and create\n\t\t\tif (this.max > 0 && this.size === this.max) {\n\t\t\t\tthis.evict(true);\n\t\t\t}\n\n\t\t\titem = this.items[key] = {\n\t\t\t\texpiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n\t\t\t\tkey: key,\n\t\t\t\tprev: this.last,\n\t\t\t\tnext: null,\n\t\t\t\tvalue\n\t\t\t};\n\n\t\t\tif (++this.size === 1) {\n\t\t\t\tthis.first = item;\n\t\t\t} else {\n\t\t\t\tthis.last.next = item;\n\t\t\t}\n\n\t\t\tthis.last = item;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an array of all values in the cache for the specified keys.\n\t * Order follows LRU order (least to most recently used).\n\t *\n\t * @method values\n\t * @memberof LRU\n\t * @param {string[]} [keys=this.keys()] - Array of keys to get values for. Defaults to all keys.\n\t * @returns {Array<*>} Array of values corresponding to the keys in LRU order.\n\t * @example\n\t * cache.set('a', 1).set('b', 2);\n\t * console.log(cache.values()); // [1, 2]\n\t * console.log(cache.values(['a'])); // [1]\n\t * @see {@link LRU#keys}\n\t * @see {@link LRU#entries}\n\t * @since 11.1.0\n\t */\n\tvalues (keys = this.keys()) {\n\t\treturn keys.map(key => this.get(key));\n\t}\n}\n\n/**\n * Factory function to create a new LRU cache instance with parameter validation.\n *\n * @function lru\n * @param {number} [max=1000] - Maximum number of items to store. Must be >= 0. Use 0 for unlimited size.\n * @param {number} [ttl=0] - Time to live in milliseconds. Must be >= 0. Use 0 for no expiration.\n * @param {boolean} [resetTtl=false] - Whether to reset TTL when accessing existing items via get().\n * @returns {LRU} A new LRU cache instance.\n * @throws {TypeError} When parameters are invalid (negative numbers or wrong types).\n * @example\n * // Create cache with factory function\n * const cache = lru(100, 5000, true);\n * cache.set('key', 'value');\n *\n * @example\n * // Error handling\n * try {\n *   const cache = lru(-1); // Invalid max\n * } catch (error) {\n *   console.error(error.message); // \"Invalid max value\"\n * }\n * @see {@link LRU}\n * @since 1.0.0\n */\nfunction lru (max = 1000, ttl = 0, resetTtl = false) {\n\tif (isNaN(max) || max < 0) {\n\t\tthrow new TypeError(\"Invalid max value\");\n\t}\n\n\tif (isNaN(ttl) || ttl < 0) {\n\t\tthrow new TypeError(\"Invalid ttl value\");\n\t}\n\n\tif (typeof resetTtl !== \"boolean\") {\n\t\tthrow new TypeError(\"Invalid resetTtl value\");\n\t}\n\n\treturn new LRU(max, ttl, resetTtl);\n}export{LRU,lru};","import { GlProgram } from '../rendering/renderers/gl/shader/GlProgram.mjs';\nimport { GpuProgram } from '../rendering/renderers/gpu/shader/GpuProgram.mjs';\nimport { Shader } from '../rendering/renderers/shared/shader/Shader.mjs';\nimport { State } from '../rendering/renderers/shared/state/State.mjs';\n\n\"use strict\";\nconst _Filter = class _Filter extends Shader {\n  /**\n   * @param options - The optional parameters of this filter.\n   */\n  constructor(options) {\n    options = { ..._Filter.defaultOptions, ...options };\n    super(options);\n    /** If enabled is true the filter is applied, if false it will not. */\n    this.enabled = true;\n    /**\n     * The gpu state the filter requires to render.\n     * @internal\n     */\n    this._state = State.for2d();\n    this.blendMode = options.blendMode;\n    this.padding = options.padding;\n    if (typeof options.antialias === \"boolean\") {\n      this.antialias = options.antialias ? \"on\" : \"off\";\n    } else {\n      this.antialias = options.antialias;\n    }\n    this.resolution = options.resolution;\n    this.blendRequired = options.blendRequired;\n    this.clipToViewport = options.clipToViewport;\n    this.addResource(\"uTexture\", 0, 1);\n  }\n  /**\n   * Applies the filter\n   * @param filterManager - The renderer to retrieve the filter from\n   * @param input - The input render target.\n   * @param output - The target to output to.\n   * @param clearMode - Should the output be cleared before rendering to it\n   */\n  apply(filterManager, input, output, clearMode) {\n    filterManager.applyFilter(this, input, output, clearMode);\n  }\n  /**\n   * Get the blend mode of the filter.\n   * @default \"normal\"\n   */\n  get blendMode() {\n    return this._state.blendMode;\n  }\n  /** Sets the blend mode of the filter. */\n  set blendMode(value) {\n    this._state.blendMode = value;\n  }\n  /**\n   * A short hand function to create a filter based of a vertex and fragment shader src.\n   * @param options\n   * @returns A shiny new PixiJS filter!\n   */\n  static from(options) {\n    const { gpu, gl, ...rest } = options;\n    let gpuProgram;\n    let glProgram;\n    if (gpu) {\n      gpuProgram = GpuProgram.from(gpu);\n    }\n    if (gl) {\n      glProgram = GlProgram.from(gl);\n    }\n    return new _Filter({\n      gpuProgram,\n      glProgram,\n      ...rest\n    });\n  }\n};\n/** The default filter settings */\n_Filter.defaultOptions = {\n  blendMode: \"normal\",\n  resolution: 1,\n  padding: 0,\n  antialias: \"off\",\n  blendRequired: false,\n  clipToViewport: true\n};\nlet Filter = _Filter;\n\nexport { Filter };\n//# sourceMappingURL=Filter.mjs.map\n","import { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { MeshGeometry } from '../mesh/shared/MeshGeometry.mjs';\n\n\"use strict\";\nconst _PlaneGeometry = class _PlaneGeometry extends MeshGeometry {\n  constructor(...args) {\n    super({});\n    let options = args[0] ?? {};\n    if (typeof options === \"number\") {\n      deprecation(v8_0_0, \"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead\");\n      options = {\n        width: options,\n        height: args[1],\n        verticesX: args[2],\n        verticesY: args[3]\n      };\n    }\n    this.build(options);\n  }\n  /**\n   * Refreshes plane coordinates\n   * @param options - Options to be applied to plane geometry\n   */\n  build(options) {\n    options = { ..._PlaneGeometry.defaultOptions, ...options };\n    this.verticesX = this.verticesX ?? options.verticesX;\n    this.verticesY = this.verticesY ?? options.verticesY;\n    this.width = this.width ?? options.width;\n    this.height = this.height ?? options.height;\n    const total = this.verticesX * this.verticesY;\n    const verts = [];\n    const uvs = [];\n    const indices = [];\n    const verticesX = this.verticesX - 1;\n    const verticesY = this.verticesY - 1;\n    const sizeX = this.width / verticesX;\n    const sizeY = this.height / verticesY;\n    for (let i = 0; i < total; i++) {\n      const x = i % this.verticesX;\n      const y = i / this.verticesX | 0;\n      verts.push(x * sizeX, y * sizeY);\n      uvs.push(x / verticesX, y / verticesY);\n    }\n    const totalSub = verticesX * verticesY;\n    for (let i = 0; i < totalSub; i++) {\n      const xpos = i % verticesX;\n      const ypos = i / verticesX | 0;\n      const value = ypos * this.verticesX + xpos;\n      const value2 = ypos * this.verticesX + xpos + 1;\n      const value3 = (ypos + 1) * this.verticesX + xpos;\n      const value4 = (ypos + 1) * this.verticesX + xpos + 1;\n      indices.push(\n        value,\n        value2,\n        value3,\n        value2,\n        value4,\n        value3\n      );\n    }\n    this.buffers[0].data = new Float32Array(verts);\n    this.buffers[1].data = new Float32Array(uvs);\n    this.indexBuffer.data = new Uint32Array(indices);\n    this.buffers[0].update();\n    this.buffers[1].update();\n    this.indexBuffer.update();\n  }\n};\n_PlaneGeometry.defaultOptions = {\n  width: 100,\n  height: 100,\n  verticesX: 10,\n  verticesY: 10\n};\nlet PlaneGeometry = _PlaneGeometry;\n\nexport { PlaneGeometry };\n//# sourceMappingURL=PlaneGeometry.mjs.map\n","import { PlaneGeometry } from '../mesh-plane/PlaneGeometry.mjs';\n\n\"use strict\";\nconst _NineSliceGeometry = class _NineSliceGeometry extends PlaneGeometry {\n  constructor(options = {}) {\n    options = { ..._NineSliceGeometry.defaultOptions, ...options };\n    super({\n      width: options.width,\n      height: options.height,\n      verticesX: 4,\n      verticesY: 4\n    });\n    this.update(options);\n  }\n  /**\n   * Updates the NineSliceGeometry with the options.\n   * @param options - The options of the NineSliceGeometry.\n   */\n  update(options) {\n    this.width = options.width ?? this.width;\n    this.height = options.height ?? this.height;\n    this._originalWidth = options.originalWidth ?? this._originalWidth;\n    this._originalHeight = options.originalHeight ?? this._originalHeight;\n    this._leftWidth = options.leftWidth ?? this._leftWidth;\n    this._rightWidth = options.rightWidth ?? this._rightWidth;\n    this._topHeight = options.topHeight ?? this._topHeight;\n    this._bottomHeight = options.bottomHeight ?? this._bottomHeight;\n    this._anchorX = options.anchor?.x;\n    this._anchorY = options.anchor?.y;\n    this.updateUvs();\n    this.updatePositions();\n  }\n  /** Updates the positions of the vertices. */\n  updatePositions() {\n    const p = this.positions;\n    const {\n      width,\n      height,\n      _leftWidth,\n      _rightWidth,\n      _topHeight,\n      _bottomHeight,\n      _anchorX,\n      _anchorY\n    } = this;\n    const w = _leftWidth + _rightWidth;\n    const scaleW = width > w ? 1 : width / w;\n    const h = _topHeight + _bottomHeight;\n    const scaleH = height > h ? 1 : height / h;\n    const scale = Math.min(scaleW, scaleH);\n    const anchorOffsetX = _anchorX * width;\n    const anchorOffsetY = _anchorY * height;\n    p[0] = p[8] = p[16] = p[24] = -anchorOffsetX;\n    p[2] = p[10] = p[18] = p[26] = _leftWidth * scale - anchorOffsetX;\n    p[4] = p[12] = p[20] = p[28] = width - _rightWidth * scale - anchorOffsetX;\n    p[6] = p[14] = p[22] = p[30] = width - anchorOffsetX;\n    p[1] = p[3] = p[5] = p[7] = -anchorOffsetY;\n    p[9] = p[11] = p[13] = p[15] = _topHeight * scale - anchorOffsetY;\n    p[17] = p[19] = p[21] = p[23] = height - _bottomHeight * scale - anchorOffsetY;\n    p[25] = p[27] = p[29] = p[31] = height - anchorOffsetY;\n    this.getBuffer(\"aPosition\").update();\n  }\n  /** Updates the UVs of the vertices. */\n  updateUvs() {\n    const uvs = this.uvs;\n    uvs[0] = uvs[8] = uvs[16] = uvs[24] = 0;\n    uvs[1] = uvs[3] = uvs[5] = uvs[7] = 0;\n    uvs[6] = uvs[14] = uvs[22] = uvs[30] = 1;\n    uvs[25] = uvs[27] = uvs[29] = uvs[31] = 1;\n    const _uvw = 1 / this._originalWidth;\n    const _uvh = 1 / this._originalHeight;\n    uvs[2] = uvs[10] = uvs[18] = uvs[26] = _uvw * this._leftWidth;\n    uvs[9] = uvs[11] = uvs[13] = uvs[15] = _uvh * this._topHeight;\n    uvs[4] = uvs[12] = uvs[20] = uvs[28] = 1 - _uvw * this._rightWidth;\n    uvs[17] = uvs[19] = uvs[21] = uvs[23] = 1 - _uvh * this._bottomHeight;\n    this.getBuffer(\"aUV\").update();\n  }\n};\n/** The default options for the NineSliceGeometry. */\n_NineSliceGeometry.defaultOptions = {\n  /** The width of the NineSlicePlane, setting this will actually modify the vertices and UV's of this plane. */\n  width: 100,\n  /** The height of the NineSlicePlane, setting this will actually modify the vertices and UV's of this plane. */\n  height: 100,\n  /** The width of the left column. */\n  leftWidth: 10,\n  /** The height of the top row. */\n  topHeight: 10,\n  /** The width of the right column. */\n  rightWidth: 10,\n  /** The height of the bottom row. */\n  bottomHeight: 10,\n  /** The original width of the texture */\n  originalWidth: 100,\n  /** The original height of the texture */\n  originalHeight: 100\n};\nlet NineSliceGeometry = _NineSliceGeometry;\n\nexport { NineSliceGeometry };\n//# sourceMappingURL=NineSliceGeometry.mjs.map\n","import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { BatchableMesh } from '../mesh/shared/BatchableMesh.mjs';\nimport { NineSliceGeometry } from './NineSliceGeometry.mjs';\n\n\"use strict\";\nclass NineSliceSpriteGpuData extends BatchableMesh {\n  constructor() {\n    super();\n    this.geometry = new NineSliceGeometry();\n  }\n  destroy() {\n    this.geometry.destroy();\n  }\n}\nclass NineSliceSpritePipe {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n  addRenderable(sprite, instructionSet) {\n    const gpuSprite = this._getGpuSprite(sprite);\n    if (sprite.didViewUpdate)\n      this._updateBatchableSprite(sprite, gpuSprite);\n    this._renderer.renderPipes.batch.addToBatch(gpuSprite, instructionSet);\n  }\n  updateRenderable(sprite) {\n    const gpuSprite = this._getGpuSprite(sprite);\n    if (sprite.didViewUpdate)\n      this._updateBatchableSprite(sprite, gpuSprite);\n    gpuSprite._batcher.updateElement(gpuSprite);\n  }\n  validateRenderable(sprite) {\n    const gpuSprite = this._getGpuSprite(sprite);\n    return !gpuSprite._batcher.checkAndUpdateTexture(\n      gpuSprite,\n      sprite._texture\n    );\n  }\n  _updateBatchableSprite(sprite, batchableSprite) {\n    batchableSprite.geometry.update(sprite);\n    batchableSprite.setTexture(sprite._texture);\n  }\n  _getGpuSprite(sprite) {\n    return sprite._gpuData[this._renderer.uid] || this._initGPUSprite(sprite);\n  }\n  _initGPUSprite(sprite) {\n    const gpuData = sprite._gpuData[this._renderer.uid] = new NineSliceSpriteGpuData();\n    const batchableMesh = gpuData;\n    batchableMesh.renderable = sprite;\n    batchableMesh.transform = sprite.groupTransform;\n    batchableMesh.texture = sprite._texture;\n    batchableMesh.roundPixels = this._renderer._roundPixels | sprite._roundPixels;\n    if (!sprite.didViewUpdate) {\n      this._updateBatchableSprite(sprite, batchableMesh);\n    }\n    return gpuData;\n  }\n  destroy() {\n    this._renderer = null;\n  }\n}\n/** @ignore */\nNineSliceSpritePipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"nineSliceSprite\"\n};\n\nexport { NineSliceSpriteGpuData, NineSliceSpritePipe };\n//# sourceMappingURL=NineSliceSpritePipe.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { NineSliceSpritePipe } from './NineSliceSpritePipe.mjs';\n\n\"use strict\";\nextensions.add(NineSliceSpritePipe);\n//# sourceMappingURL=init.mjs.map\n","\"use strict\";\nconst blendModeIds = {\n  normal: 0,\n  add: 1,\n  multiply: 2,\n  screen: 3,\n  overlay: 4,\n  erase: 5,\n  \"normal-npm\": 6,\n  \"add-npm\": 7,\n  \"screen-npm\": 8,\n  min: 9,\n  max: 10\n};\nconst BLEND = 0;\nconst OFFSET = 1;\nconst CULLING = 2;\nconst DEPTH_TEST = 3;\nconst WINDING = 4;\nconst DEPTH_MASK = 5;\nconst _State = class _State {\n  constructor() {\n    this.data = 0;\n    this.blendMode = \"normal\";\n    this.polygonOffset = 0;\n    this.blend = true;\n    this.depthMask = true;\n  }\n  /**\n   * Activates blending of the computed fragment color values.\n   * @default true\n   */\n  get blend() {\n    return !!(this.data & 1 << BLEND);\n  }\n  set blend(value) {\n    if (!!(this.data & 1 << BLEND) !== value) {\n      this.data ^= 1 << BLEND;\n    }\n  }\n  /**\n   * Activates adding an offset to depth values of polygon's fragments\n   * @default false\n   */\n  get offsets() {\n    return !!(this.data & 1 << OFFSET);\n  }\n  set offsets(value) {\n    if (!!(this.data & 1 << OFFSET) !== value) {\n      this.data ^= 1 << OFFSET;\n    }\n  }\n  /** The culling settings for this state none - No culling back - Back face culling front - Front face culling */\n  set cullMode(value) {\n    if (value === \"none\") {\n      this.culling = false;\n      return;\n    }\n    this.culling = true;\n    this.clockwiseFrontFace = value === \"front\";\n  }\n  get cullMode() {\n    if (!this.culling) {\n      return \"none\";\n    }\n    return this.clockwiseFrontFace ? \"front\" : \"back\";\n  }\n  /**\n   * Activates culling of polygons.\n   * @default false\n   */\n  get culling() {\n    return !!(this.data & 1 << CULLING);\n  }\n  set culling(value) {\n    if (!!(this.data & 1 << CULLING) !== value) {\n      this.data ^= 1 << CULLING;\n    }\n  }\n  /**\n   * Activates depth comparisons and updates to the depth buffer.\n   * @default false\n   */\n  get depthTest() {\n    return !!(this.data & 1 << DEPTH_TEST);\n  }\n  set depthTest(value) {\n    if (!!(this.data & 1 << DEPTH_TEST) !== value) {\n      this.data ^= 1 << DEPTH_TEST;\n    }\n  }\n  /**\n   * Enables or disables writing to the depth buffer.\n   * @default true\n   */\n  get depthMask() {\n    return !!(this.data & 1 << DEPTH_MASK);\n  }\n  set depthMask(value) {\n    if (!!(this.data & 1 << DEPTH_MASK) !== value) {\n      this.data ^= 1 << DEPTH_MASK;\n    }\n  }\n  /**\n   * Specifies whether or not front or back-facing polygons can be culled.\n   * @default false\n   */\n  get clockwiseFrontFace() {\n    return !!(this.data & 1 << WINDING);\n  }\n  set clockwiseFrontFace(value) {\n    if (!!(this.data & 1 << WINDING) !== value) {\n      this.data ^= 1 << WINDING;\n    }\n  }\n  /**\n   * The blend mode to be applied when this state is set. Apply a value of `normal` to reset the blend mode.\n   * Setting this mode to anything other than NO_BLEND will automatically switch blending on.\n   * @default 'normal'\n   */\n  get blendMode() {\n    return this._blendMode;\n  }\n  set blendMode(value) {\n    this.blend = value !== \"none\";\n    this._blendMode = value;\n    this._blendModeId = blendModeIds[value] || 0;\n  }\n  /**\n   * The polygon offset. Setting this property to anything other than 0 will automatically enable polygon offset fill.\n   * @default 0\n   */\n  get polygonOffset() {\n    return this._polygonOffset;\n  }\n  set polygonOffset(value) {\n    this.offsets = !!value;\n    this._polygonOffset = value;\n  }\n  toString() {\n    return `[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`;\n  }\n  /**\n   * A quickly getting an instance of a State that is configured for 2d rendering.\n   * @returns a new State with values set for 2d rendering\n   */\n  static for2d() {\n    const state = new _State();\n    state.depthTest = false;\n    state.blend = true;\n    return state;\n  }\n};\n_State.default2d = _State.for2d();\nlet State = _State;\n\nexport { State };\n//# sourceMappingURL=State.mjs.map\n","import { DOMAdapter } from '../../../../environment/adapter.mjs';\nimport { nextPow2 } from '../../../../maths/misc/pow2.mjs';\nimport { GlobalResourceRegistry } from '../../../../utils/pool/GlobalResourceRegistry.mjs';\n\n\"use strict\";\nclass CanvasPoolClass {\n  constructor(canvasOptions) {\n    this._canvasPool = /* @__PURE__ */ Object.create(null);\n    this.canvasOptions = canvasOptions || {};\n    this.enableFullScreen = false;\n  }\n  /**\n   * Creates texture with params that were specified in pool constructor.\n   * @param pixelWidth - Width of texture in pixels.\n   * @param pixelHeight - Height of texture in pixels.\n   */\n  _createCanvasAndContext(pixelWidth, pixelHeight) {\n    const canvas = DOMAdapter.get().createCanvas();\n    canvas.width = pixelWidth;\n    canvas.height = pixelHeight;\n    const context = canvas.getContext(\"2d\");\n    return { canvas, context };\n  }\n  /**\n   * Gets a Power-of-Two render texture or fullScreen texture\n   * @param minWidth - The minimum width of the render texture.\n   * @param minHeight - The minimum height of the render texture.\n   * @param resolution - The resolution of the render texture.\n   * @returns The new render texture.\n   */\n  getOptimalCanvasAndContext(minWidth, minHeight, resolution = 1) {\n    minWidth = Math.ceil(minWidth * resolution - 1e-6);\n    minHeight = Math.ceil(minHeight * resolution - 1e-6);\n    minWidth = nextPow2(minWidth);\n    minHeight = nextPow2(minHeight);\n    const key = (minWidth << 17) + (minHeight << 1);\n    if (!this._canvasPool[key]) {\n      this._canvasPool[key] = [];\n    }\n    let canvasAndContext = this._canvasPool[key].pop();\n    if (!canvasAndContext) {\n      canvasAndContext = this._createCanvasAndContext(minWidth, minHeight);\n    }\n    return canvasAndContext;\n  }\n  /**\n   * Place a render texture back into the pool.\n   * @param canvasAndContext\n   */\n  returnCanvasAndContext(canvasAndContext) {\n    const canvas = canvasAndContext.canvas;\n    const { width, height } = canvas;\n    const key = (width << 17) + (height << 1);\n    canvasAndContext.context.resetTransform();\n    canvasAndContext.context.clearRect(0, 0, width, height);\n    this._canvasPool[key].push(canvasAndContext);\n  }\n  clear() {\n    this._canvasPool = {};\n  }\n}\nconst CanvasPool = new CanvasPoolClass();\nGlobalResourceRegistry.register(CanvasPool);\n\nexport { CanvasPool, CanvasPoolClass };\n//# sourceMappingURL=CanvasPool.mjs.map\n","import EventEmitter from 'eventemitter3';\nimport { Color } from '../../color/Color.mjs';\nimport { uid } from '../../utils/data/uid.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { FillGradient } from '../graphics/shared/fill/FillGradient.mjs';\nimport { FillPattern } from '../graphics/shared/fill/FillPattern.mjs';\nimport { GraphicsContext } from '../graphics/shared/GraphicsContext.mjs';\nimport { toFillStyle, toStrokeStyle } from '../graphics/shared/utils/convertFillInputToFillStyle.mjs';\n\n\"use strict\";\nconst _TextStyle = class _TextStyle extends EventEmitter {\n  constructor(style = {}) {\n    super();\n    /**\n     * Unique identifier for the TextStyle class.\n     * This is used to track instances and ensure uniqueness.\n     * @internal\n     */\n    this.uid = uid(\"textStyle\");\n    /**\n     * Internal tick counter used to track updates and changes.\n     * This is incremented whenever the style is modified, allowing for efficient change detection.\n     * @internal\n     */\n    this._tick = 0;\n    convertV7Tov8Style(style);\n    const fullStyle = { ..._TextStyle.defaultTextStyle, ...style };\n    for (const key in fullStyle) {\n      const thisKey = key;\n      this[thisKey] = fullStyle[key];\n    }\n    this.update();\n    this._tick = 0;\n  }\n  /**\n   * Alignment for multiline text, does not affect single line text.\n   * @type {'left'|'center'|'right'|'justify'}\n   */\n  get align() {\n    return this._align;\n  }\n  set align(value) {\n    if (this._align === value)\n      return;\n    this._align = value;\n    this.update();\n  }\n  /** Indicates if lines can be wrapped within words, it needs wordWrap to be set to true. */\n  get breakWords() {\n    return this._breakWords;\n  }\n  set breakWords(value) {\n    if (this._breakWords === value)\n      return;\n    this._breakWords = value;\n    this.update();\n  }\n  /** Set a drop shadow for the text. */\n  get dropShadow() {\n    return this._dropShadow;\n  }\n  set dropShadow(value) {\n    if (this._dropShadow === value)\n      return;\n    if (value !== null && typeof value === \"object\") {\n      this._dropShadow = this._createProxy({ ..._TextStyle.defaultDropShadow, ...value });\n    } else {\n      this._dropShadow = value ? this._createProxy({ ..._TextStyle.defaultDropShadow }) : null;\n    }\n    this.update();\n  }\n  /** The font family, can be a single font name, or a list of names where the first is the preferred font. */\n  get fontFamily() {\n    return this._fontFamily;\n  }\n  set fontFamily(value) {\n    if (this._fontFamily === value)\n      return;\n    this._fontFamily = value;\n    this.update();\n  }\n  /** The font size (as a number it converts to px, but as a string, equivalents are '26px','20pt','160%' or '1.6em') */\n  get fontSize() {\n    return this._fontSize;\n  }\n  set fontSize(value) {\n    if (this._fontSize === value)\n      return;\n    if (typeof value === \"string\") {\n      this._fontSize = parseInt(value, 10);\n    } else {\n      this._fontSize = value;\n    }\n    this.update();\n  }\n  /**\n   * The font style.\n   * @type {'normal'|'italic'|'oblique'}\n   */\n  get fontStyle() {\n    return this._fontStyle;\n  }\n  set fontStyle(value) {\n    if (this._fontStyle === value)\n      return;\n    this._fontStyle = value.toLowerCase();\n    this.update();\n  }\n  /**\n   * The font variant.\n   * @type {'normal'|'small-caps'}\n   */\n  get fontVariant() {\n    return this._fontVariant;\n  }\n  set fontVariant(value) {\n    if (this._fontVariant === value)\n      return;\n    this._fontVariant = value;\n    this.update();\n  }\n  /**\n   * The font weight.\n   * @type {'normal'|'bold'|'bolder'|'lighter'|'100'|'200'|'300'|'400'|'500'|'600'|'700'|'800'|'900'}\n   */\n  get fontWeight() {\n    return this._fontWeight;\n  }\n  set fontWeight(value) {\n    if (this._fontWeight === value)\n      return;\n    this._fontWeight = value;\n    this.update();\n  }\n  /** The space between lines. */\n  get leading() {\n    return this._leading;\n  }\n  set leading(value) {\n    if (this._leading === value)\n      return;\n    this._leading = value;\n    this.update();\n  }\n  /** The amount of spacing between letters, default is 0. */\n  get letterSpacing() {\n    return this._letterSpacing;\n  }\n  set letterSpacing(value) {\n    if (this._letterSpacing === value)\n      return;\n    this._letterSpacing = value;\n    this.update();\n  }\n  /** The line height, a number that represents the vertical space that a letter uses. */\n  get lineHeight() {\n    return this._lineHeight;\n  }\n  set lineHeight(value) {\n    if (this._lineHeight === value)\n      return;\n    this._lineHeight = value;\n    this.update();\n  }\n  /**\n   * Occasionally some fonts are cropped. Adding some padding will prevent this from happening\n   * by adding padding to all sides of the text.\n   * > [!NOTE] This will NOT affect the positioning or bounds of the text.\n   */\n  get padding() {\n    return this._padding;\n  }\n  set padding(value) {\n    if (this._padding === value)\n      return;\n    this._padding = value;\n    this.update();\n  }\n  /**\n   * An optional filter or array of filters to apply to the text, allowing for advanced visual effects.\n   * These filters will be applied to the text as it is created, resulting in faster rendering for static text\n   * compared to applying the filter directly to the text object (which would be applied at run time).\n   * @default null\n   */\n  get filters() {\n    return this._filters;\n  }\n  set filters(value) {\n    if (this._filters === value)\n      return;\n    this._filters = Object.freeze(value);\n    this.update();\n  }\n  /**\n   * Trim transparent borders from the text texture.\n   * > [!IMPORTANT] PERFORMANCE WARNING:\n   * > This is a costly operation as it requires scanning pixel alpha values.\n   * > Avoid using `trim: true` for dynamic text, as it could significantly impact performance.\n   */\n  get trim() {\n    return this._trim;\n  }\n  set trim(value) {\n    if (this._trim === value)\n      return;\n    this._trim = value;\n    this.update();\n  }\n  /**\n   * The baseline of the text that is rendered.\n   * @type {'alphabetic'|'top'|'hanging'|'middle'|'ideographic'|'bottom'}\n   */\n  get textBaseline() {\n    return this._textBaseline;\n  }\n  set textBaseline(value) {\n    if (this._textBaseline === value)\n      return;\n    this._textBaseline = value;\n    this.update();\n  }\n  /**\n   * How newlines and spaces should be handled.\n   * Default is 'pre' (preserve, preserve).\n   *\n   *  value       | New lines     |   Spaces\n   *  ---         | ---           |   ---\n   * 'normal'     | Collapse      |   Collapse\n   * 'pre'        | Preserve      |   Preserve\n   * 'pre-line'   | Preserve      |   Collapse\n   * @type {'normal'|'pre'|'pre-line'}\n   */\n  get whiteSpace() {\n    return this._whiteSpace;\n  }\n  set whiteSpace(value) {\n    if (this._whiteSpace === value)\n      return;\n    this._whiteSpace = value;\n    this.update();\n  }\n  /** Indicates if word wrap should be used. */\n  get wordWrap() {\n    return this._wordWrap;\n  }\n  set wordWrap(value) {\n    if (this._wordWrap === value)\n      return;\n    this._wordWrap = value;\n    this.update();\n  }\n  /** The width at which text will wrap, it needs wordWrap to be set to true. */\n  get wordWrapWidth() {\n    return this._wordWrapWidth;\n  }\n  set wordWrapWidth(value) {\n    if (this._wordWrapWidth === value)\n      return;\n    this._wordWrapWidth = value;\n    this.update();\n  }\n  /**\n   * The fill style that will be used to color the text.\n   * This can be:\n   * - A color string like 'red', '#00FF00', or 'rgba(255,0,0,0.5)'\n   * - A hex number like 0xff0000 for red\n   * - A FillStyle object with properties like { color: 0xff0000, alpha: 0.5 }\n   * - A FillGradient for gradient fills\n   * - A FillPattern for pattern/texture fills\n   *\n   * When using a FillGradient, vertical gradients (angle of 90 degrees) are applied per line of text,\n   * while gradients at any other angle are spread across the entire text body as a whole.\n   * @example\n   * // Vertical gradient applied per line\n   * const verticalGradient = new FillGradient(0, 0, 0, 1)\n   *     .addColorStop(0, 0xff0000)\n   *     .addColorStop(1, 0x0000ff);\n   *\n   * const text = new Text({\n   *     text: 'Line 1\\nLine 2',\n   *     style: { fill: verticalGradient }\n   * });\n   *\n   * To manage the gradient in a global scope, set the textureSpace property of the FillGradient to 'global'.\n   * @type {string|number|FillStyle|FillGradient|FillPattern}\n   */\n  get fill() {\n    return this._originalFill;\n  }\n  set fill(value) {\n    if (value === this._originalFill)\n      return;\n    this._originalFill = value;\n    if (this._isFillStyle(value)) {\n      this._originalFill = this._createProxy({ ...GraphicsContext.defaultFillStyle, ...value }, () => {\n        this._fill = toFillStyle(\n          { ...this._originalFill },\n          GraphicsContext.defaultFillStyle\n        );\n      });\n    }\n    this._fill = toFillStyle(\n      value === 0 ? \"black\" : value,\n      GraphicsContext.defaultFillStyle\n    );\n    this.update();\n  }\n  /** A fillstyle that will be used on the text stroke, e.g., 'blue', '#FCFF00'. */\n  get stroke() {\n    return this._originalStroke;\n  }\n  set stroke(value) {\n    if (value === this._originalStroke)\n      return;\n    this._originalStroke = value;\n    if (this._isFillStyle(value)) {\n      this._originalStroke = this._createProxy({ ...GraphicsContext.defaultStrokeStyle, ...value }, () => {\n        this._stroke = toStrokeStyle(\n          { ...this._originalStroke },\n          GraphicsContext.defaultStrokeStyle\n        );\n      });\n    }\n    this._stroke = toStrokeStyle(value, GraphicsContext.defaultStrokeStyle);\n    this.update();\n  }\n  update() {\n    this._tick++;\n    this.emit(\"update\", this);\n  }\n  /** Resets all properties to the default values */\n  reset() {\n    const defaultStyle = _TextStyle.defaultTextStyle;\n    for (const key in defaultStyle) {\n      this[key] = defaultStyle[key];\n    }\n  }\n  /**\n   * Returns a unique key for this instance.\n   * This key is used for caching.\n   * @returns {string} Unique key for the instance\n   */\n  get styleKey() {\n    return `${this.uid}-${this._tick}`;\n  }\n  /**\n   * Creates a new TextStyle object with the same values as this one.\n   * @returns New cloned TextStyle object\n   */\n  clone() {\n    return new _TextStyle({\n      align: this.align,\n      breakWords: this.breakWords,\n      dropShadow: this._dropShadow ? { ...this._dropShadow } : null,\n      fill: this._fill,\n      fontFamily: this.fontFamily,\n      fontSize: this.fontSize,\n      fontStyle: this.fontStyle,\n      fontVariant: this.fontVariant,\n      fontWeight: this.fontWeight,\n      leading: this.leading,\n      letterSpacing: this.letterSpacing,\n      lineHeight: this.lineHeight,\n      padding: this.padding,\n      stroke: this._stroke,\n      textBaseline: this.textBaseline,\n      whiteSpace: this.whiteSpace,\n      wordWrap: this.wordWrap,\n      wordWrapWidth: this.wordWrapWidth,\n      filters: this._filters ? [...this._filters] : void 0\n    });\n  }\n  /**\n   * Returns the final padding for the text style, taking into account any filters applied.\n   * Used internally for correct measurements\n   * @internal\n   * @returns {number} The final padding for the text style.\n   */\n  _getFinalPadding() {\n    let filterPadding = 0;\n    if (this._filters) {\n      for (let i = 0; i < this._filters.length; i++) {\n        filterPadding += this._filters[i].padding;\n      }\n    }\n    return Math.max(this._padding, filterPadding);\n  }\n  /**\n   * Destroys this text style.\n   * @param options - Options parameter. A boolean will act as if all options\n   *  have been set to that value\n   * @example\n   * // Destroy the text style and its textures\n   * textStyle.destroy({ texture: true, textureSource: true });\n   * textStyle.destroy(true);\n   */\n  destroy(options = false) {\n    this.removeAllListeners();\n    const destroyTexture = typeof options === \"boolean\" ? options : options?.texture;\n    if (destroyTexture) {\n      const destroyTextureSource = typeof options === \"boolean\" ? options : options?.textureSource;\n      if (this._fill?.texture) {\n        this._fill.texture.destroy(destroyTextureSource);\n      }\n      if (this._originalFill?.texture) {\n        this._originalFill.texture.destroy(destroyTextureSource);\n      }\n      if (this._stroke?.texture) {\n        this._stroke.texture.destroy(destroyTextureSource);\n      }\n      if (this._originalStroke?.texture) {\n        this._originalStroke.texture.destroy(destroyTextureSource);\n      }\n    }\n    this._fill = null;\n    this._stroke = null;\n    this.dropShadow = null;\n    this._originalStroke = null;\n    this._originalFill = null;\n  }\n  _createProxy(value, cb) {\n    return new Proxy(value, {\n      set: (target, property, newValue) => {\n        if (target[property] === newValue)\n          return true;\n        target[property] = newValue;\n        cb?.(property, newValue);\n        this.update();\n        return true;\n      }\n    });\n  }\n  _isFillStyle(value) {\n    return (value ?? null) !== null && !(Color.isColorLike(value) || value instanceof FillGradient || value instanceof FillPattern);\n  }\n};\n/**\n * Default drop shadow settings used when enabling drop shadows on text.\n * These values are used as the base configuration when drop shadows are enabled without specific settings.\n * @example\n * ```ts\n * // Customize default settings globally\n * TextStyle.defaultDropShadow.alpha = 0.5;    // 50% opacity for all shadows\n * TextStyle.defaultDropShadow.blur = 2;       // 2px blur for all shadows\n * TextStyle.defaultDropShadow.color = 'blue'; // Blue shadows by default\n * ```\n */\n_TextStyle.defaultDropShadow = {\n  alpha: 1,\n  angle: Math.PI / 6,\n  blur: 0,\n  color: \"black\",\n  distance: 5\n};\n/**\n * Default text style settings used when creating new text objects.\n * These values serve as the base configuration and can be customized globally.\n * @example\n * ```ts\n * // Customize default text style globally\n * TextStyle.defaultTextStyle.fontSize = 16;\n * TextStyle.defaultTextStyle.fill = 0x333333;\n * TextStyle.defaultTextStyle.fontFamily = ['Arial', 'Helvetica', 'sans-serif'];\n * ```\n */\n_TextStyle.defaultTextStyle = {\n  align: \"left\",\n  breakWords: false,\n  dropShadow: null,\n  fill: \"black\",\n  fontFamily: \"Arial\",\n  fontSize: 26,\n  fontStyle: \"normal\",\n  fontVariant: \"normal\",\n  fontWeight: \"normal\",\n  leading: 0,\n  letterSpacing: 0,\n  lineHeight: 0,\n  padding: 0,\n  stroke: null,\n  textBaseline: \"alphabetic\",\n  trim: false,\n  whiteSpace: \"pre\",\n  wordWrap: false,\n  wordWrapWidth: 100\n};\nlet TextStyle = _TextStyle;\nfunction convertV7Tov8Style(style) {\n  const oldStyle = style;\n  if (typeof oldStyle.dropShadow === \"boolean\" && oldStyle.dropShadow) {\n    const defaults = TextStyle.defaultDropShadow;\n    style.dropShadow = {\n      alpha: oldStyle.dropShadowAlpha ?? defaults.alpha,\n      angle: oldStyle.dropShadowAngle ?? defaults.angle,\n      blur: oldStyle.dropShadowBlur ?? defaults.blur,\n      color: oldStyle.dropShadowColor ?? defaults.color,\n      distance: oldStyle.dropShadowDistance ?? defaults.distance\n    };\n  }\n  if (oldStyle.strokeThickness !== void 0) {\n    deprecation(v8_0_0, \"strokeThickness is now a part of stroke\");\n    const color = oldStyle.stroke;\n    let obj = {};\n    if (Color.isColorLike(color)) {\n      obj.color = color;\n    } else if (color instanceof FillGradient || color instanceof FillPattern) {\n      obj.fill = color;\n    } else if (Object.hasOwnProperty.call(color, \"color\") || Object.hasOwnProperty.call(color, \"fill\")) {\n      obj = color;\n    } else {\n      throw new Error(\"Invalid stroke value.\");\n    }\n    style.stroke = {\n      ...obj,\n      width: oldStyle.strokeThickness\n    };\n  }\n  if (Array.isArray(oldStyle.fillGradientStops)) {\n    deprecation(v8_0_0, \"gradient fill is now a fill pattern: `new FillGradient(...)`\");\n    if (!Array.isArray(oldStyle.fill) || oldStyle.fill.length === 0) {\n      throw new Error(\"Invalid fill value. Expected an array of colors for gradient fill.\");\n    }\n    if (oldStyle.fill.length !== oldStyle.fillGradientStops.length) {\n      warn(\"The number of fill colors must match the number of fill gradient stops.\");\n    }\n    const gradientFill = new FillGradient({\n      start: { x: 0, y: 0 },\n      end: { x: 0, y: 1 },\n      textureSpace: \"local\"\n    });\n    const fillGradientStops = oldStyle.fillGradientStops.slice();\n    const fills = oldStyle.fill.map((color) => Color.shared.setValue(color).toNumber());\n    fillGradientStops.forEach((stop, index) => {\n      gradientFill.addColorStop(stop, fills[index]);\n    });\n    style.fill = {\n      fill: gradientFill\n    };\n  }\n}\n\nexport { TextStyle };\n//# sourceMappingURL=TextStyle.mjs.map\n","\"use strict\";\nclass BatchableSprite {\n  constructor() {\n    this.batcherName = \"default\";\n    this.topology = \"triangle-list\";\n    // batch specific..\n    this.attributeSize = 4;\n    this.indexSize = 6;\n    this.packAsQuad = true;\n    this.roundPixels = 0;\n    this._attributeStart = 0;\n    // location in the buffer\n    this._batcher = null;\n    this._batch = null;\n  }\n  get blendMode() {\n    return this.renderable.groupBlendMode;\n  }\n  get color() {\n    return this.renderable.groupColorAlpha;\n  }\n  reset() {\n    this.renderable = null;\n    this.texture = null;\n    this._batcher = null;\n    this._batch = null;\n    this.bounds = null;\n  }\n  destroy() {\n  }\n}\n\nexport { BatchableSprite };\n//# sourceMappingURL=BatchableSprite.mjs.map\n","\"use strict\";\nconst tilingBit = {\n  name: \"tiling-bit\",\n  vertex: {\n    header: (\n      /* wgsl */\n      `\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        `\n    ),\n    main: (\n      /* wgsl */\n      `\n            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;\n\n            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;\n        `\n    )\n  },\n  fragment: {\n    header: (\n      /* wgsl */\n      `\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        `\n    ),\n    main: (\n      /* wgsl */\n      `\n\n            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);\n            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;\n            var unclamped = coord;\n            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);\n\n            var bias = 0.;\n\n            if(unclamped.x == coord.x && unclamped.y == coord.y)\n            {\n                bias = -32.;\n            }\n\n            outColor = textureSampleBias(uTexture, uSampler, coord, bias);\n        `\n    )\n  }\n};\nconst tilingBitGl = {\n  name: \"tiling-bit\",\n  vertex: {\n    header: (\n      /* glsl */\n      `\n            uniform mat3 uTextureTransform;\n            uniform vec4 uSizeAnchor;\n\n        `\n    ),\n    main: (\n      /* glsl */\n      `\n            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;\n\n            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;\n        `\n    )\n  },\n  fragment: {\n    header: (\n      /* glsl */\n      `\n            uniform sampler2D uTexture;\n            uniform mat3 uMapCoord;\n            uniform vec4 uClampFrame;\n            uniform vec2 uClampOffset;\n        `\n    ),\n    main: (\n      /* glsl */\n      `\n\n        vec2 coord = vUV + ceil(uClampOffset - vUV);\n        coord = (uMapCoord * vec3(coord, 1.0)).xy;\n        vec2 unclamped = coord;\n        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0\n\n        `\n    )\n  }\n};\n\nexport { tilingBit, tilingBitGl };\n//# sourceMappingURL=tilingBit.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { compileHighShaderGpuProgram, compileHighShaderGlProgram } from '../../../rendering/high-shader/compileHighShaderToProgram.mjs';\nimport { localUniformBit, localUniformBitGl } from '../../../rendering/high-shader/shader-bits/localUniformBit.mjs';\nimport { roundPixelsBit, roundPixelsBitGl } from '../../../rendering/high-shader/shader-bits/roundPixelsBit.mjs';\nimport { Shader } from '../../../rendering/renderers/shared/shader/Shader.mjs';\nimport { UniformGroup } from '../../../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { Texture } from '../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { tilingBit, tilingBitGl } from './tilingBit.mjs';\n\n\"use strict\";\nlet gpuProgram;\nlet glProgram;\nclass TilingSpriteShader extends Shader {\n  constructor() {\n    gpuProgram ?? (gpuProgram = compileHighShaderGpuProgram({\n      name: \"tiling-sprite-shader\",\n      bits: [\n        localUniformBit,\n        tilingBit,\n        roundPixelsBit\n      ]\n    }));\n    glProgram ?? (glProgram = compileHighShaderGlProgram({\n      name: \"tiling-sprite-shader\",\n      bits: [\n        localUniformBitGl,\n        tilingBitGl,\n        roundPixelsBitGl\n      ]\n    }));\n    const tilingUniforms = new UniformGroup({\n      uMapCoord: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uClampFrame: { value: new Float32Array([0, 0, 1, 1]), type: \"vec4<f32>\" },\n      uClampOffset: { value: new Float32Array([0, 0]), type: \"vec2<f32>\" },\n      uTextureTransform: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uSizeAnchor: { value: new Float32Array([100, 100, 0.5, 0.5]), type: \"vec4<f32>\" }\n    });\n    super({\n      glProgram,\n      gpuProgram,\n      resources: {\n        localUniforms: new UniformGroup({\n          uTransformMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n          uColor: { value: new Float32Array([1, 1, 1, 1]), type: \"vec4<f32>\" },\n          uRound: { value: 0, type: \"f32\" }\n        }),\n        tilingUniforms,\n        uTexture: Texture.EMPTY.source,\n        uSampler: Texture.EMPTY.source.style\n      }\n    });\n  }\n  updateUniforms(width, height, matrix, anchorX, anchorY, texture) {\n    const tilingUniforms = this.resources.tilingUniforms;\n    const textureWidth = texture.width;\n    const textureHeight = texture.height;\n    const textureMatrix = texture.textureMatrix;\n    const uTextureTransform = tilingUniforms.uniforms.uTextureTransform;\n    uTextureTransform.set(\n      matrix.a * textureWidth / width,\n      matrix.b * textureWidth / height,\n      matrix.c * textureHeight / width,\n      matrix.d * textureHeight / height,\n      matrix.tx / width,\n      matrix.ty / height\n    );\n    uTextureTransform.invert();\n    tilingUniforms.uniforms.uMapCoord = textureMatrix.mapCoord;\n    tilingUniforms.uniforms.uClampFrame = textureMatrix.uClampFrame;\n    tilingUniforms.uniforms.uClampOffset = textureMatrix.uClampOffset;\n    tilingUniforms.uniforms.uTextureTransform = uTextureTransform;\n    tilingUniforms.uniforms.uSizeAnchor[0] = width;\n    tilingUniforms.uniforms.uSizeAnchor[1] = height;\n    tilingUniforms.uniforms.uSizeAnchor[2] = anchorX;\n    tilingUniforms.uniforms.uSizeAnchor[3] = anchorY;\n    if (texture) {\n      this.resources.uTexture = texture.source;\n      this.resources.uSampler = texture.source.style;\n    }\n  }\n}\n\nexport { TilingSpriteShader };\n//# sourceMappingURL=TilingSpriteShader.mjs.map\n","import { MeshGeometry } from '../../mesh/shared/MeshGeometry.mjs';\n\n\"use strict\";\nclass QuadGeometry extends MeshGeometry {\n  constructor() {\n    super({\n      positions: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),\n      uvs: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),\n      indices: new Uint32Array([0, 1, 2, 0, 2, 3])\n    });\n  }\n}\n\nexport { QuadGeometry };\n//# sourceMappingURL=QuadGeometry.mjs.map\n","import { ExtensionType } from '../../extensions/Extensions.mjs';\nimport { getAdjustedBlendModeBlend } from '../../rendering/renderers/shared/state/getAdjustedBlendModeBlend.mjs';\nimport { State } from '../../rendering/renderers/shared/state/State.mjs';\nimport { RendererType } from '../../rendering/renderers/types.mjs';\nimport { color32BitToUniform } from '../graphics/gpu/colorToUniform.mjs';\nimport { BatchableMesh } from '../mesh/shared/BatchableMesh.mjs';\nimport { MeshGeometry } from '../mesh/shared/MeshGeometry.mjs';\nimport { TilingSpriteShader } from './shader/TilingSpriteShader.mjs';\nimport { QuadGeometry } from './utils/QuadGeometry.mjs';\nimport { setPositions } from './utils/setPositions.mjs';\nimport { setUvs } from './utils/setUvs.mjs';\n\n\"use strict\";\nconst sharedQuad = new QuadGeometry();\nclass TilingSpriteGpuData {\n  constructor() {\n    this.canBatch = true;\n    this.geometry = new MeshGeometry({\n      indices: sharedQuad.indices.slice(),\n      positions: sharedQuad.positions.slice(),\n      uvs: sharedQuad.uvs.slice()\n    });\n  }\n  destroy() {\n    this.geometry.destroy();\n    this.shader?.destroy();\n  }\n}\nclass TilingSpritePipe {\n  constructor(renderer) {\n    this._state = State.default2d;\n    this._renderer = renderer;\n  }\n  validateRenderable(renderable) {\n    const tilingSpriteData = this._getTilingSpriteData(renderable);\n    const couldBatch = tilingSpriteData.canBatch;\n    this._updateCanBatch(renderable);\n    const canBatch = tilingSpriteData.canBatch;\n    if (canBatch && canBatch === couldBatch) {\n      const { batchableMesh } = tilingSpriteData;\n      return !batchableMesh._batcher.checkAndUpdateTexture(\n        batchableMesh,\n        renderable.texture\n      );\n    }\n    return couldBatch !== canBatch;\n  }\n  addRenderable(tilingSprite, instructionSet) {\n    const batcher = this._renderer.renderPipes.batch;\n    this._updateCanBatch(tilingSprite);\n    const tilingSpriteData = this._getTilingSpriteData(tilingSprite);\n    const { geometry, canBatch } = tilingSpriteData;\n    if (canBatch) {\n      tilingSpriteData.batchableMesh || (tilingSpriteData.batchableMesh = new BatchableMesh());\n      const batchableMesh = tilingSpriteData.batchableMesh;\n      if (tilingSprite.didViewUpdate) {\n        this._updateBatchableMesh(tilingSprite);\n        batchableMesh.geometry = geometry;\n        batchableMesh.renderable = tilingSprite;\n        batchableMesh.transform = tilingSprite.groupTransform;\n        batchableMesh.setTexture(tilingSprite._texture);\n      }\n      batchableMesh.roundPixels = this._renderer._roundPixels | tilingSprite._roundPixels;\n      batcher.addToBatch(batchableMesh, instructionSet);\n    } else {\n      batcher.break(instructionSet);\n      tilingSpriteData.shader || (tilingSpriteData.shader = new TilingSpriteShader());\n      this.updateRenderable(tilingSprite);\n      instructionSet.add(tilingSprite);\n    }\n  }\n  execute(tilingSprite) {\n    const { shader } = this._getTilingSpriteData(tilingSprite);\n    shader.groups[0] = this._renderer.globalUniforms.bindGroup;\n    const localUniforms = shader.resources.localUniforms.uniforms;\n    localUniforms.uTransformMatrix = tilingSprite.groupTransform;\n    localUniforms.uRound = this._renderer._roundPixels | tilingSprite._roundPixels;\n    color32BitToUniform(\n      tilingSprite.groupColorAlpha,\n      localUniforms.uColor,\n      0\n    );\n    this._state.blendMode = getAdjustedBlendModeBlend(tilingSprite.groupBlendMode, tilingSprite.texture._source);\n    this._renderer.encoder.draw({\n      geometry: sharedQuad,\n      shader,\n      state: this._state\n    });\n  }\n  updateRenderable(tilingSprite) {\n    const tilingSpriteData = this._getTilingSpriteData(tilingSprite);\n    const { canBatch } = tilingSpriteData;\n    if (canBatch) {\n      const { batchableMesh } = tilingSpriteData;\n      if (tilingSprite.didViewUpdate)\n        this._updateBatchableMesh(tilingSprite);\n      batchableMesh._batcher.updateElement(batchableMesh);\n    } else if (tilingSprite.didViewUpdate) {\n      const { shader } = tilingSpriteData;\n      shader.updateUniforms(\n        tilingSprite.width,\n        tilingSprite.height,\n        tilingSprite._tileTransform.matrix,\n        tilingSprite.anchor.x,\n        tilingSprite.anchor.y,\n        tilingSprite.texture\n      );\n    }\n  }\n  _getTilingSpriteData(renderable) {\n    return renderable._gpuData[this._renderer.uid] || this._initTilingSpriteData(renderable);\n  }\n  _initTilingSpriteData(tilingSprite) {\n    const gpuData = new TilingSpriteGpuData();\n    gpuData.renderable = tilingSprite;\n    tilingSprite._gpuData[this._renderer.uid] = gpuData;\n    return gpuData;\n  }\n  _updateBatchableMesh(tilingSprite) {\n    const renderableData = this._getTilingSpriteData(tilingSprite);\n    const { geometry } = renderableData;\n    const style = tilingSprite.texture.source.style;\n    if (style.addressMode !== \"repeat\") {\n      style.addressMode = \"repeat\";\n      style.update();\n    }\n    setUvs(tilingSprite, geometry.uvs);\n    setPositions(tilingSprite, geometry.positions);\n  }\n  destroy() {\n    this._renderer = null;\n  }\n  _updateCanBatch(tilingSprite) {\n    const renderableData = this._getTilingSpriteData(tilingSprite);\n    const texture = tilingSprite.texture;\n    let _nonPowOf2wrapping = true;\n    if (this._renderer.type === RendererType.WEBGL) {\n      _nonPowOf2wrapping = this._renderer.context.supports.nonPowOf2wrapping;\n    }\n    renderableData.canBatch = texture.textureMatrix.isSimple && (_nonPowOf2wrapping || texture.source.isPowerOfTwo);\n    return renderableData.canBatch;\n  }\n}\n/** @ignore */\nTilingSpritePipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"tilingSprite\"\n};\n\nexport { TilingSpriteGpuData, TilingSpritePipe };\n//# sourceMappingURL=TilingSpritePipe.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { applyMatrix } from './applyMatrix.mjs';\n\n\"use strict\";\nfunction setUvs(tilingSprite, uvs) {\n  const texture = tilingSprite.texture;\n  const width = texture.frame.width;\n  const height = texture.frame.height;\n  let anchorX = 0;\n  let anchorY = 0;\n  if (tilingSprite.applyAnchorToTexture) {\n    anchorX = tilingSprite.anchor.x;\n    anchorY = tilingSprite.anchor.y;\n  }\n  uvs[0] = uvs[6] = -anchorX;\n  uvs[2] = uvs[4] = 1 - anchorX;\n  uvs[1] = uvs[3] = -anchorY;\n  uvs[5] = uvs[7] = 1 - anchorY;\n  const textureMatrix = Matrix.shared;\n  textureMatrix.copyFrom(tilingSprite._tileTransform.matrix);\n  textureMatrix.tx /= tilingSprite.width;\n  textureMatrix.ty /= tilingSprite.height;\n  textureMatrix.invert();\n  textureMatrix.scale(tilingSprite.width / width, tilingSprite.height / height);\n  applyMatrix(uvs, 2, 0, textureMatrix);\n}\n\nexport { setUvs };\n//# sourceMappingURL=setUvs.mjs.map\n","\"use strict\";\nfunction applyMatrix(array, stride, offset, matrix) {\n  let index = 0;\n  const size = array.length / (stride || 2);\n  const a = matrix.a;\n  const b = matrix.b;\n  const c = matrix.c;\n  const d = matrix.d;\n  const tx = matrix.tx;\n  const ty = matrix.ty;\n  offset *= stride;\n  while (index < size) {\n    const x = array[offset];\n    const y = array[offset + 1];\n    array[offset] = a * x + c * y + tx;\n    array[offset + 1] = b * x + d * y + ty;\n    offset += stride;\n    index++;\n  }\n}\n\nexport { applyMatrix };\n//# sourceMappingURL=applyMatrix.mjs.map\n","\"use strict\";\nfunction setPositions(tilingSprite, positions) {\n  const anchorX = tilingSprite.anchor.x;\n  const anchorY = tilingSprite.anchor.y;\n  positions[0] = -anchorX * tilingSprite.width;\n  positions[1] = -anchorY * tilingSprite.height;\n  positions[2] = (1 - anchorX) * tilingSprite.width;\n  positions[3] = -anchorY * tilingSprite.height;\n  positions[4] = (1 - anchorX) * tilingSprite.width;\n  positions[5] = (1 - anchorY) * tilingSprite.height;\n  positions[6] = -anchorX * tilingSprite.width;\n  positions[7] = (1 - anchorY) * tilingSprite.height;\n}\n\nexport { setPositions };\n//# sourceMappingURL=setPositions.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { TilingSpritePipe } from './TilingSpritePipe.mjs';\n\n\"use strict\";\nextensions.add(TilingSpritePipe);\n//# sourceMappingURL=init.mjs.map\n","\"use strict\";\nclass BatchableMesh {\n  constructor() {\n    this.batcherName = \"default\";\n    this.packAsQuad = false;\n    this.indexOffset = 0;\n    this.attributeOffset = 0;\n    this.roundPixels = 0;\n    this._batcher = null;\n    this._batch = null;\n    this._textureMatrixUpdateId = -1;\n    this._uvUpdateId = -1;\n  }\n  get blendMode() {\n    return this.renderable.groupBlendMode;\n  }\n  get topology() {\n    return this._topology || this.geometry.topology;\n  }\n  set topology(value) {\n    this._topology = value;\n  }\n  reset() {\n    this.renderable = null;\n    this.texture = null;\n    this._batcher = null;\n    this._batch = null;\n    this.geometry = null;\n    this._uvUpdateId = -1;\n    this._textureMatrixUpdateId = -1;\n  }\n  /**\n   * Sets the texture for the batchable mesh.\n   * As it does so, it resets the texture matrix update ID.\n   * this is to ensure that the texture matrix is recalculated when the uvs are referenced\n   * @param value - The texture to set.\n   */\n  setTexture(value) {\n    if (this.texture === value)\n      return;\n    this.texture = value;\n    this._textureMatrixUpdateId = -1;\n  }\n  get uvs() {\n    const geometry = this.geometry;\n    const uvBuffer = geometry.getBuffer(\"aUV\");\n    const uvs = uvBuffer.data;\n    let transformedUvs = uvs;\n    const textureMatrix = this.texture.textureMatrix;\n    if (!textureMatrix.isSimple) {\n      transformedUvs = this._transformedUvs;\n      if (this._textureMatrixUpdateId !== textureMatrix._updateID || this._uvUpdateId !== uvBuffer._updateID) {\n        if (!transformedUvs || transformedUvs.length < uvs.length) {\n          transformedUvs = this._transformedUvs = new Float32Array(uvs.length);\n        }\n        this._textureMatrixUpdateId = textureMatrix._updateID;\n        this._uvUpdateId = uvBuffer._updateID;\n        textureMatrix.multiplyUvs(uvs, transformedUvs);\n      }\n    }\n    return transformedUvs;\n  }\n  get positions() {\n    return this.geometry.positions;\n  }\n  get indices() {\n    return this.geometry.indices;\n  }\n  get color() {\n    return this.renderable.groupColorAlpha;\n  }\n  get groupTransform() {\n    return this.renderable.groupTransform;\n  }\n  get attributeSize() {\n    return this.geometry.positions.length / 2;\n  }\n  get indexSize() {\n    return this.geometry.indices.length;\n  }\n}\n\nexport { BatchableMesh };\n//# sourceMappingURL=BatchableMesh.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { State } from '../../../rendering/renderers/shared/state/State.mjs';\nimport { BigPool } from '../../../utils/pool/PoolGroup.mjs';\nimport { color32BitToUniform } from '../gpu/colorToUniform.mjs';\nimport { BatchableGraphics } from './BatchableGraphics.mjs';\n\n\"use strict\";\nclass GraphicsGpuData {\n  constructor() {\n    this.batches = [];\n    this.batched = false;\n  }\n  destroy() {\n    this.batches.forEach((batch) => {\n      BigPool.return(batch);\n    });\n    this.batches.length = 0;\n  }\n}\nclass GraphicsPipe {\n  constructor(renderer, adaptor) {\n    this.state = State.for2d();\n    this.renderer = renderer;\n    this._adaptor = adaptor;\n    this.renderer.runners.contextChange.add(this);\n  }\n  contextChange() {\n    this._adaptor.contextChange(this.renderer);\n  }\n  validateRenderable(graphics) {\n    const context = graphics.context;\n    const wasBatched = !!graphics._gpuData;\n    const gpuContext = this.renderer.graphicsContext.updateGpuContext(context);\n    if (gpuContext.isBatchable || wasBatched !== gpuContext.isBatchable) {\n      return true;\n    }\n    return false;\n  }\n  addRenderable(graphics, instructionSet) {\n    const gpuContext = this.renderer.graphicsContext.updateGpuContext(graphics.context);\n    if (graphics.didViewUpdate) {\n      this._rebuild(graphics);\n    }\n    if (gpuContext.isBatchable) {\n      this._addToBatcher(graphics, instructionSet);\n    } else {\n      this.renderer.renderPipes.batch.break(instructionSet);\n      instructionSet.add(graphics);\n    }\n  }\n  updateRenderable(graphics) {\n    const gpuData = this._getGpuDataForRenderable(graphics);\n    const batches = gpuData.batches;\n    for (let i = 0; i < batches.length; i++) {\n      const batch = batches[i];\n      batch._batcher.updateElement(batch);\n    }\n  }\n  execute(graphics) {\n    if (!graphics.isRenderable)\n      return;\n    const renderer = this.renderer;\n    const context = graphics.context;\n    const contextSystem = renderer.graphicsContext;\n    if (!contextSystem.getGpuContext(context).batches.length) {\n      return;\n    }\n    const shader = context.customShader || this._adaptor.shader;\n    this.state.blendMode = graphics.groupBlendMode;\n    const localUniforms = shader.resources.localUniforms.uniforms;\n    localUniforms.uTransformMatrix = graphics.groupTransform;\n    localUniforms.uRound = renderer._roundPixels | graphics._roundPixels;\n    color32BitToUniform(\n      graphics.groupColorAlpha,\n      localUniforms.uColor,\n      0\n    );\n    this._adaptor.execute(this, graphics);\n  }\n  _rebuild(graphics) {\n    const gpuData = this._getGpuDataForRenderable(graphics);\n    const gpuContext = this.renderer.graphicsContext.updateGpuContext(graphics.context);\n    gpuData.destroy();\n    if (gpuContext.isBatchable) {\n      this._updateBatchesForRenderable(graphics, gpuData);\n    }\n  }\n  _addToBatcher(graphics, instructionSet) {\n    const batchPipe = this.renderer.renderPipes.batch;\n    const batches = this._getGpuDataForRenderable(graphics).batches;\n    for (let i = 0; i < batches.length; i++) {\n      const batch = batches[i];\n      batchPipe.addToBatch(batch, instructionSet);\n    }\n  }\n  _getGpuDataForRenderable(graphics) {\n    return graphics._gpuData[this.renderer.uid] || this._initGpuDataForRenderable(graphics);\n  }\n  _initGpuDataForRenderable(graphics) {\n    const gpuData = new GraphicsGpuData();\n    graphics._gpuData[this.renderer.uid] = gpuData;\n    return gpuData;\n  }\n  _updateBatchesForRenderable(graphics, gpuData) {\n    const context = graphics.context;\n    const gpuContext = this.renderer.graphicsContext.getGpuContext(context);\n    const roundPixels = this.renderer._roundPixels | graphics._roundPixels;\n    gpuData.batches = gpuContext.batches.map((batch) => {\n      const batchClone = BigPool.get(BatchableGraphics);\n      batch.copyTo(batchClone);\n      batchClone.renderable = graphics;\n      batchClone.roundPixels = roundPixels;\n      return batchClone;\n    });\n  }\n  destroy() {\n    this.renderer = null;\n    this._adaptor.destroy();\n    this._adaptor = null;\n    this.state = null;\n  }\n}\n/** @ignore */\nGraphicsPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes,\n    ExtensionType.WebGPUPipes,\n    ExtensionType.CanvasPipes\n  ],\n  name: \"graphics\"\n};\n\nexport { GraphicsGpuData, GraphicsPipe };\n//# sourceMappingURL=GraphicsPipe.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { GraphicsContextSystem } from './shared/GraphicsContextSystem.mjs';\nimport { GraphicsPipe } from './shared/GraphicsPipe.mjs';\n\n\"use strict\";\nextensions.add(GraphicsPipe);\nextensions.add(GraphicsContextSystem);\n//# sourceMappingURL=init.mjs.map\n","\"use strict\";\nclass GlParticleContainerAdaptor {\n  execute(particleContainerPipe, container) {\n    const state = particleContainerPipe.state;\n    const renderer = particleContainerPipe.renderer;\n    const shader = container.shader || particleContainerPipe.defaultShader;\n    shader.resources.uTexture = container.texture._source;\n    shader.resources.uniforms = particleContainerPipe.localUniforms;\n    const gl = renderer.gl;\n    const buffer = particleContainerPipe.getBuffers(container);\n    renderer.shader.bind(shader);\n    renderer.state.set(state);\n    renderer.geometry.bind(buffer.geometry, shader.glProgram);\n    const byteSize = buffer.geometry.indexBuffer.data.BYTES_PER_ELEMENT;\n    const glType = byteSize === 2 ? gl.UNSIGNED_SHORT : gl.UNSIGNED_INT;\n    gl.drawElements(gl.TRIANGLES, container.particleChildren.length * 6, glType, 0);\n  }\n}\n\nexport { GlParticleContainerAdaptor };\n//# sourceMappingURL=GlParticleContainerAdaptor.mjs.map\n","\"use strict\";\nfunction createIndicesForQuads(size, outBuffer = null) {\n  const totalIndices = size * 6;\n  if (totalIndices > 65535) {\n    outBuffer || (outBuffer = new Uint32Array(totalIndices));\n  } else {\n    outBuffer || (outBuffer = new Uint16Array(totalIndices));\n  }\n  if (outBuffer.length !== totalIndices) {\n    throw new Error(`Out buffer length is incorrect, got ${outBuffer.length} and expected ${totalIndices}`);\n  }\n  for (let i = 0, j = 0; i < totalIndices; i += 6, j += 4) {\n    outBuffer[i + 0] = j + 0;\n    outBuffer[i + 1] = j + 1;\n    outBuffer[i + 2] = j + 2;\n    outBuffer[i + 3] = j + 0;\n    outBuffer[i + 4] = j + 2;\n    outBuffer[i + 5] = j + 3;\n  }\n  return outBuffer;\n}\n\nexport { createIndicesForQuads };\n//# sourceMappingURL=createIndicesForQuads.mjs.map\n","import { getAttributeInfoFromFormat } from '../../../../rendering/renderers/shared/geometry/utils/getAttributeInfoFromFormat.mjs';\n\n\"use strict\";\nfunction generateParticleUpdateFunction(properties) {\n  return {\n    dynamicUpdate: generateUpdateFunction(properties, true),\n    staticUpdate: generateUpdateFunction(properties, false)\n  };\n}\nfunction generateUpdateFunction(properties, dynamic) {\n  const funcFragments = [];\n  funcFragments.push(`\n\n        var index = 0;\n\n        for (let i = 0; i < ps.length; ++i)\n        {\n            const p = ps[i];\n\n            `);\n  let offset = 0;\n  for (const i in properties) {\n    const property = properties[i];\n    if (dynamic !== property.dynamic)\n      continue;\n    funcFragments.push(`offset = index + ${offset}`);\n    funcFragments.push(property.code);\n    const attributeInfo = getAttributeInfoFromFormat(property.format);\n    offset += attributeInfo.stride / 4;\n  }\n  funcFragments.push(`\n            index += stride * 4;\n        }\n    `);\n  funcFragments.unshift(`\n        var stride = ${offset};\n    `);\n  const functionSource = funcFragments.join(\"\\n\");\n  return new Function(\"ps\", \"f32v\", \"u32v\", functionSource);\n}\n\nexport { generateParticleUpdateFunction };\n//# sourceMappingURL=generateParticleUpdateFunction.mjs.map\n","import { Buffer } from '../../../rendering/renderers/shared/buffer/Buffer.mjs';\nimport { BufferUsage } from '../../../rendering/renderers/shared/buffer/const.mjs';\nimport { Geometry } from '../../../rendering/renderers/shared/geometry/Geometry.mjs';\nimport { getAttributeInfoFromFormat } from '../../../rendering/renderers/shared/geometry/utils/getAttributeInfoFromFormat.mjs';\nimport { ViewableBuffer } from '../../../utils/data/ViewableBuffer.mjs';\nimport { createIndicesForQuads } from './utils/createIndicesForQuads.mjs';\nimport { generateParticleUpdateFunction } from './utils/generateParticleUpdateFunction.mjs';\n\n\"use strict\";\nclass ParticleBuffer {\n  constructor(options) {\n    this._size = 0;\n    this._generateParticleUpdateCache = {};\n    const size = this._size = options.size ?? 1e3;\n    const properties = options.properties;\n    let staticVertexSize = 0;\n    let dynamicVertexSize = 0;\n    for (const i in properties) {\n      const property = properties[i];\n      const attributeInfo = getAttributeInfoFromFormat(property.format);\n      if (property.dynamic) {\n        dynamicVertexSize += attributeInfo.stride;\n      } else {\n        staticVertexSize += attributeInfo.stride;\n      }\n    }\n    this._dynamicStride = dynamicVertexSize / 4;\n    this._staticStride = staticVertexSize / 4;\n    this.staticAttributeBuffer = new ViewableBuffer(size * 4 * staticVertexSize);\n    this.dynamicAttributeBuffer = new ViewableBuffer(size * 4 * dynamicVertexSize);\n    this.indexBuffer = createIndicesForQuads(size);\n    const geometry = new Geometry();\n    let dynamicOffset = 0;\n    let staticOffset = 0;\n    this._staticBuffer = new Buffer({\n      data: new Float32Array(1),\n      label: \"static-particle-buffer\",\n      shrinkToFit: false,\n      usage: BufferUsage.VERTEX | BufferUsage.COPY_DST\n    });\n    this._dynamicBuffer = new Buffer({\n      data: new Float32Array(1),\n      label: \"dynamic-particle-buffer\",\n      shrinkToFit: false,\n      usage: BufferUsage.VERTEX | BufferUsage.COPY_DST\n    });\n    for (const i in properties) {\n      const property = properties[i];\n      const attributeInfo = getAttributeInfoFromFormat(property.format);\n      if (property.dynamic) {\n        geometry.addAttribute(property.attributeName, {\n          buffer: this._dynamicBuffer,\n          stride: this._dynamicStride * 4,\n          offset: dynamicOffset * 4,\n          format: property.format\n        });\n        dynamicOffset += attributeInfo.size;\n      } else {\n        geometry.addAttribute(property.attributeName, {\n          buffer: this._staticBuffer,\n          stride: this._staticStride * 4,\n          offset: staticOffset * 4,\n          format: property.format\n        });\n        staticOffset += attributeInfo.size;\n      }\n    }\n    geometry.addIndex(this.indexBuffer);\n    const uploadFunction = this.getParticleUpdate(properties);\n    this._dynamicUpload = uploadFunction.dynamicUpdate;\n    this._staticUpload = uploadFunction.staticUpdate;\n    this.geometry = geometry;\n  }\n  getParticleUpdate(properties) {\n    const key = getParticleSyncKey(properties);\n    if (this._generateParticleUpdateCache[key]) {\n      return this._generateParticleUpdateCache[key];\n    }\n    this._generateParticleUpdateCache[key] = this.generateParticleUpdate(properties);\n    return this._generateParticleUpdateCache[key];\n  }\n  generateParticleUpdate(properties) {\n    return generateParticleUpdateFunction(properties);\n  }\n  update(particles, uploadStatic) {\n    if (particles.length > this._size) {\n      uploadStatic = true;\n      this._size = Math.max(particles.length, this._size * 1.5 | 0);\n      this.staticAttributeBuffer = new ViewableBuffer(this._size * this._staticStride * 4 * 4);\n      this.dynamicAttributeBuffer = new ViewableBuffer(this._size * this._dynamicStride * 4 * 4);\n      this.indexBuffer = createIndicesForQuads(this._size);\n      this.geometry.indexBuffer.setDataWithSize(\n        this.indexBuffer,\n        this.indexBuffer.byteLength,\n        true\n      );\n    }\n    const dynamicAttributeBuffer = this.dynamicAttributeBuffer;\n    this._dynamicUpload(particles, dynamicAttributeBuffer.float32View, dynamicAttributeBuffer.uint32View);\n    this._dynamicBuffer.setDataWithSize(\n      this.dynamicAttributeBuffer.float32View,\n      particles.length * this._dynamicStride * 4,\n      true\n    );\n    if (uploadStatic) {\n      const staticAttributeBuffer = this.staticAttributeBuffer;\n      this._staticUpload(particles, staticAttributeBuffer.float32View, staticAttributeBuffer.uint32View);\n      this._staticBuffer.setDataWithSize(\n        staticAttributeBuffer.float32View,\n        particles.length * this._staticStride * 4,\n        true\n      );\n    }\n  }\n  destroy() {\n    this._staticBuffer.destroy();\n    this._dynamicBuffer.destroy();\n    this.geometry.destroy();\n  }\n}\nfunction getParticleSyncKey(properties) {\n  const keyGen = [];\n  for (const key in properties) {\n    const property = properties[key];\n    keyGen.push(key, property.code, property.dynamic ? \"d\" : \"s\");\n  }\n  return keyGen.join(\"_\");\n}\n\nexport { ParticleBuffer };\n//# sourceMappingURL=ParticleBuffer.mjs.map\n","var wgsl = \"\\nstruct ParticleUniforms {\\n  uTranslationMatrix:mat3x3<f32>,\\n  uColor:vec4<f32>,\\n  uRound:f32,\\n  uResolution:vec2<f32>,\\n};\\n\\nfn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>\\n{\\n  return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\\n}\\n\\n@group(0) @binding(0) var<uniform> uniforms: ParticleUniforms;\\n\\n@group(1) @binding(0) var uTexture: texture_2d<f32>;\\n@group(1) @binding(1) var uSampler : sampler;\\n\\nstruct VSOutput {\\n    @builtin(position) position: vec4<f32>,\\n    @location(0) uv : vec2<f32>,\\n    @location(1) color : vec4<f32>,\\n  };\\n@vertex\\nfn mainVertex(\\n  @location(0) aVertex: vec2<f32>,\\n  @location(1) aPosition: vec2<f32>,\\n  @location(2) aUV: vec2<f32>,\\n  @location(3) aColor: vec4<f32>,\\n  @location(4) aRotation: f32,\\n) -> VSOutput {\\n  \\n   let v = vec2(\\n       aVertex.x * cos(aRotation) - aVertex.y * sin(aRotation),\\n       aVertex.x * sin(aRotation) + aVertex.y * cos(aRotation)\\n   ) + aPosition;\\n\\n   var position = vec4((uniforms.uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\\n\\n   if(uniforms.uRound == 1.0) {\\n       position = vec4(roundPixels(position.xy, uniforms.uResolution), position.zw);\\n   }\\n\\n    let vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uniforms.uColor;\\n\\n  return VSOutput(\\n   position,\\n   aUV,\\n   vColor,\\n  );\\n}\\n\\n@fragment\\nfn mainFragment(\\n  @location(0) uv: vec2<f32>,\\n  @location(1) color: vec4<f32>,\\n  @builtin(position) position: vec4<f32>,\\n) -> @location(0) vec4<f32> {\\n\\n    var sample = textureSample(uTexture, uSampler, uv) * color;\\n   \\n    return sample;\\n}\";\n\nexport { wgsl as default };\n//# sourceMappingURL=particles.wgsl.mjs.map\n","import { Color } from '../../../../color/Color.mjs';\nimport { Matrix } from '../../../../maths/matrix/Matrix.mjs';\nimport { GlProgram } from '../../../../rendering/renderers/gl/shader/GlProgram.mjs';\nimport { GpuProgram } from '../../../../rendering/renderers/gpu/shader/GpuProgram.mjs';\nimport { Shader } from '../../../../rendering/renderers/shared/shader/Shader.mjs';\nimport { Texture } from '../../../../rendering/renderers/shared/texture/Texture.mjs';\nimport { TextureStyle } from '../../../../rendering/renderers/shared/texture/TextureStyle.mjs';\nimport fragment from './particles.frag.mjs';\nimport vertex from './particles.vert.mjs';\nimport wgsl from './particles.wgsl.mjs';\n\n\"use strict\";\nclass ParticleShader extends Shader {\n  constructor() {\n    const glProgram = GlProgram.from({\n      vertex,\n      fragment\n    });\n    const gpuProgram = GpuProgram.from({\n      fragment: {\n        source: wgsl,\n        entryPoint: \"mainFragment\"\n      },\n      vertex: {\n        source: wgsl,\n        entryPoint: \"mainVertex\"\n      }\n    });\n    super({\n      glProgram,\n      gpuProgram,\n      resources: {\n        // this will be replaced with the texture from the particle container\n        uTexture: Texture.WHITE.source,\n        // this will be replaced with the texture style from the particle container\n        uSampler: new TextureStyle({}),\n        // this will be replaced with the local uniforms from the particle container\n        uniforms: {\n          uTranslationMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n          uColor: { value: new Color(16777215), type: \"vec4<f32>\" },\n          uRound: { value: 1, type: \"f32\" },\n          uResolution: { value: [0, 0], type: \"vec2<f32>\" }\n        }\n      }\n    });\n  }\n}\n\nexport { ParticleShader };\n//# sourceMappingURL=ParticleShader.mjs.map\n","var vertex = \"attribute vec2 aVertex;\\nattribute vec2 aUV;\\nattribute vec4 aColor;\\n\\nattribute vec2 aPosition;\\nattribute float aRotation;\\n\\nuniform mat3 uTranslationMatrix;\\nuniform float uRound;\\nuniform vec2 uResolution;\\nuniform vec4 uColor;\\n\\nvarying vec2 vUV;\\nvarying vec4 vColor;\\n\\nvec2 roundPixels(vec2 position, vec2 targetSize)\\n{       \\n    return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\\n}\\n\\nvoid main(void){\\n    float cosRotation = cos(aRotation);\\n    float sinRotation = sin(aRotation);\\n    float x = aVertex.x * cosRotation - aVertex.y * sinRotation;\\n    float y = aVertex.x * sinRotation + aVertex.y * cosRotation;\\n\\n    vec2 v = vec2(x, y);\\n    v = v + aPosition;\\n\\n    gl_Position = vec4((uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\\n\\n    if(uRound == 1.0)\\n    {\\n        gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\\n    }\\n\\n    vUV = aUV;\\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uColor;\\n}\\n\";\n\nexport { vertex as default };\n//# sourceMappingURL=particles.vert.mjs.map\n","var fragment = \"varying vec2 vUV;\\nvarying vec4 vColor;\\n\\nuniform sampler2D uTexture;\\n\\nvoid main(void){\\n    vec4 color = texture2D(uTexture, vUV) * vColor;\\n    gl_FragColor = color;\\n}\";\n\nexport { fragment as default };\n//# sourceMappingURL=particles.frag.mjs.map\n","import { Matrix } from '../../../maths/matrix/Matrix.mjs';\nimport { UniformGroup } from '../../../rendering/renderers/shared/shader/UniformGroup.mjs';\nimport { getAdjustedBlendModeBlend } from '../../../rendering/renderers/shared/state/getAdjustedBlendModeBlend.mjs';\nimport { State } from '../../../rendering/renderers/shared/state/State.mjs';\nimport { color32BitToUniform } from '../../graphics/gpu/colorToUniform.mjs';\nimport { ParticleBuffer } from './ParticleBuffer.mjs';\nimport { ParticleShader } from './shader/ParticleShader.mjs';\n\n\"use strict\";\nclass ParticleContainerPipe {\n  /**\n   * @param renderer - The renderer this sprite batch works for.\n   * @param adaptor\n   */\n  constructor(renderer, adaptor) {\n    /** @internal */\n    this.state = State.for2d();\n    /** Local uniforms that are used for rendering particles. */\n    this.localUniforms = new UniformGroup({\n      uTranslationMatrix: { value: new Matrix(), type: \"mat3x3<f32>\" },\n      uColor: { value: new Float32Array(4), type: \"vec4<f32>\" },\n      uRound: { value: 1, type: \"f32\" },\n      uResolution: { value: [0, 0], type: \"vec2<f32>\" }\n    });\n    this.renderer = renderer;\n    this.adaptor = adaptor;\n    this.defaultShader = new ParticleShader();\n    this.state = State.for2d();\n  }\n  validateRenderable(_renderable) {\n    return false;\n  }\n  addRenderable(renderable, instructionSet) {\n    this.renderer.renderPipes.batch.break(instructionSet);\n    instructionSet.add(renderable);\n  }\n  getBuffers(renderable) {\n    return renderable._gpuData[this.renderer.uid] || this._initBuffer(renderable);\n  }\n  _initBuffer(renderable) {\n    renderable._gpuData[this.renderer.uid] = new ParticleBuffer({\n      size: renderable.particleChildren.length,\n      properties: renderable._properties\n    });\n    return renderable._gpuData[this.renderer.uid];\n  }\n  updateRenderable(_renderable) {\n  }\n  execute(container) {\n    const children = container.particleChildren;\n    if (children.length === 0) {\n      return;\n    }\n    const renderer = this.renderer;\n    const buffer = this.getBuffers(container);\n    container.texture || (container.texture = children[0].texture);\n    const state = this.state;\n    buffer.update(children, container._childrenDirty);\n    container._childrenDirty = false;\n    state.blendMode = getAdjustedBlendModeBlend(container.blendMode, container.texture._source);\n    const uniforms = this.localUniforms.uniforms;\n    const transformationMatrix = uniforms.uTranslationMatrix;\n    container.worldTransform.copyTo(transformationMatrix);\n    transformationMatrix.prepend(renderer.globalUniforms.globalUniformData.projectionMatrix);\n    uniforms.uResolution = renderer.globalUniforms.globalUniformData.resolution;\n    uniforms.uRound = renderer._roundPixels | container._roundPixels;\n    color32BitToUniform(\n      container.groupColorAlpha,\n      uniforms.uColor,\n      0\n    );\n    this.adaptor.execute(this, container);\n  }\n  /** Destroys the ParticleRenderer. */\n  destroy() {\n    this.renderer = null;\n    if (this.defaultShader) {\n      this.defaultShader.destroy();\n      this.defaultShader = null;\n    }\n  }\n}\n\nexport { ParticleContainerPipe };\n//# sourceMappingURL=ParticleContainerPipe.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { GlParticleContainerAdaptor } from '../gl/GlParticleContainerAdaptor.mjs';\nimport { ParticleContainerPipe } from './ParticleContainerPipe.mjs';\n\n\"use strict\";\nclass GlParticleContainerPipe extends ParticleContainerPipe {\n  constructor(renderer) {\n    super(renderer, new GlParticleContainerAdaptor());\n  }\n}\n/** @ignore */\nGlParticleContainerPipe.extension = {\n  type: [\n    ExtensionType.WebGLPipes\n  ],\n  name: \"particle\"\n};\n\nexport { GlParticleContainerPipe };\n//# sourceMappingURL=GlParticleContainerPipe.mjs.map\n","\"use strict\";\nclass GpuParticleContainerAdaptor {\n  execute(particleContainerPipe, container) {\n    const renderer = particleContainerPipe.renderer;\n    const shader = container.shader || particleContainerPipe.defaultShader;\n    shader.groups[0] = renderer.renderPipes.uniformBatch.getUniformBindGroup(particleContainerPipe.localUniforms, true);\n    shader.groups[1] = renderer.texture.getTextureBindGroup(container.texture);\n    const state = particleContainerPipe.state;\n    const buffer = particleContainerPipe.getBuffers(container);\n    renderer.encoder.draw({\n      geometry: buffer.geometry,\n      shader: container.shader || particleContainerPipe.defaultShader,\n      state,\n      size: container.particleChildren.length * 6\n    });\n  }\n}\n\nexport { GpuParticleContainerAdaptor };\n//# sourceMappingURL=GpuParticleContainerAdaptor.mjs.map\n","import { ExtensionType } from '../../../extensions/Extensions.mjs';\nimport { GpuParticleContainerAdaptor } from '../gpu/GpuParticleContainerAdaptor.mjs';\nimport { ParticleContainerPipe } from './ParticleContainerPipe.mjs';\n\n\"use strict\";\nclass GpuParticleContainerPipe extends ParticleContainerPipe {\n  constructor(renderer) {\n    super(renderer, new GpuParticleContainerAdaptor());\n  }\n}\n/** @ignore */\nGpuParticleContainerPipe.extension = {\n  type: [\n    ExtensionType.WebGPUPipes\n  ],\n  name: \"particle\"\n};\n\nexport { GpuParticleContainerPipe };\n//# sourceMappingURL=GpuParticleContainerPipe.mjs.map\n","import { extensions } from '../../extensions/Extensions.mjs';\nimport { GlParticleContainerPipe } from './shared/GlParticleContainerPipe.mjs';\nimport { GpuParticleContainerPipe } from './shared/GpuParticleContainerPipe.mjs';\n\n\"use strict\";\nextensions.add(GlParticleContainerPipe);\nextensions.add(GpuParticleContainerPipe);\n//# sourceMappingURL=init.mjs.map\n"],"names":["localUniformMSDFBit","name","vertex","header","main","end","fragment","localUniformMSDFBitGl","mSDFBit","mSDFBitGl","gpuProgram","glProgram","SdfShader","Shader","constructor","maxTextures","uniforms","UniformGroup","uColor","value","Float32Array","type","uTransformMatrix","Matrix","uDistance","uRound","bits","colorBit","generateTextureBatchBit","roundPixelsBit","super","resources","localUniforms","batchSamplers","getBatchSamplersUniformGroup","AbstractBitmapFont","arguments","this","chars","Object","create","lineHeight","fontFamily","fontMetrics","fontSize","ascent","descent","baseLineOffset","distanceField","range","pages","applyFillAsTint","baseMeasurementFontSize","baseRenderedFontSize","font","deprecation","pageTextures","size","distanceFieldRange","distanceFieldType","destroy","destroyTextures","emit","removeAllListeners","i","texture","forEach","page","_DynamicBitmapFont","options","resolution","_padding","_measureCache","_currentChars","_currentX","_currentY","_currentMaxCharHeight","_currentPageIndex","_skipKerning","dynamicOptions","defaultOptions","_textureSize","textureSize","_mipmap","mipmap","style","clone","overrideFill","_fill","color","alpha","Texture","WHITE","fill","requestedFontSize","fontStringFromTextStyle","overrideSize","_stroke","width","_style","skipKerning","padding","textureStyle","_textureStyle","TextureStyle","CanvasTextMetrics","measureFont","ensureCharacters","charList","graphemeSegmenter","filter","char","includes","index","self","indexOf","length","pageData","_nextPage","canvas","context","canvasAndContext","textureSource","source","currentX","currentY","currentMaxCharHeight","fontScale","skipTexture","maxTextureWidth","maxTextureHeight","height","metrics","measureText","paddedWidth","Math","ceil","fontStyle","paddedHeight","max","update","pageData2","xAdvance","dropShadow","distance","id","codePointAt","xOffset","yOffset","kerning","_drawGlyph","px","py","frame","Rectangle","_applyKerning","newChars","measureCache","first","j","second","c1","c2","total","amount","textureResolution","CanvasPool","getOptimalCanvasAndContext","_setupContext","ImageSource","resource","alphaMode","autoGenerateMipmaps","scale","textBaseline","stroke","strokeThickness","lineWidth","lineJoin","join","miterLimit","strokeStyle","getCanvasFillStyle","fillStyle","shadowOptions","rgb","Color","shared","setValue","toArray","dropShadowBlur","blur","dropShadowDistance","shadowColor","shadowBlur","shadowOffsetX","cos","angle","shadowOffsetY","sin","x","y","text","fontProperties","tx","ty","removeShadow","strokeText","fillText","returnCanvasAndContext","TextStyle","DynamicBitmapFont","getBitmapTextLayout","trimEnd","layoutData","offsetY","lines","charPositions","spaceWidth","spacesIndex","currentLine","previousChar","firstWord","currentWord","spaceWord","start","positions","adjustedLetterSpacing","letterSpacing","adjustedWordWrapWidth","wordWrapWidth","adjustedLineHeight","breakWords","wordWrap","nextWord","word","position","push","nextLine","lastChar","checkIsOverflow","isEnd","charData","test","nextCharWidth","align","measurementData","line","offset","alignCenter","alignRight","indy","spaceIndex","totalSpaces","alignJustify","fontCount","BitmapFontManager","ALPHA","NUMERIC","ALPHANUMERIC","ASCII","getFont","fontFamilyKey","styleKey","Cache","has","styleCopy","fnt","warn","once","remove","set","dynamicFont","get","getLayout","bitmapFont","install","args","Error","textStyle","dynamicFill","_canUseTintForStyle","flatChars","result","item","Array","isArray","startCode","charCodeAt","endCode","i2","j2","String","fromCharCode","from","resolveCharacters","uninstall","cacheKey","BitmapTextGraphics","Graphics","customShader","BitmapTextPipe","renderer","_renderer","validateRenderable","bitmapText","graphicsRenderable","_getGpuBitmapText","renderPipes","graphics","addRenderable","instructionSet","syncWithProxy","_didTextUpdate","_updateContext","_updateDistanceField","updateRenderable","proxyGraphics","clear","limits","maxBatchableTextures","bitmapTextLayout","translate","_anchor","_x","_y","tint","linePositionYShift","round","orig","_gpuData","uid","initGpuText","proxyRenderable","a","b","c","d","groupTransform","dx","sqrt","dy","worldScale","abs","container","proxy","groupColorAlpha","groupColor","groupBlendMode","globalDisplayStatus","localDisplayStatus","groupAlpha","_roundPixels","extension","WebGLPipes","WebGPUPipes","CanvasPipes","add","genericFontFamilies","fontSizeString","fontFamilies","split","trim","fontVariant","fontWeight","localUniformBit","localUniformBitGroup2","replace","localUniformBitGl","updateTextBounds","batchableSprite","bounds","_getFinalPadding","paddingOffset","paddingOffsetY","minX","minY","maxX","maxY","tempBounds","getPo2TextureFromSource","image","getOptimalTexture","uploadMethodId","updateUvs","BatchableHTMLText","BatchableSprite","generatingTexture","currentKey","runners","resolutionChange","renderable","_autoResolution","onViewUpdate","htmlText","getReferenceCount","returnTexturePromise","texturePromise","decreaseReferenceCount","HTMLTextPipe","gpuText","_getGpuText","newKey","batchableHTMLText","_updateGpuText","catch","e","console","error","batch","addToBatch","_batcher","updateElement","oldTexturePromise","_resolution","getTexturePromise","finally","renderGroup","parentRenderGroup","structureDidChange","transform","EMPTY","roundPixels","nssvg","nsxhtml","HTMLTextRenderData","svgRoot","document","createElementNS","foreignObject","domElement","styleElement","setAttribute","overflow","appendChild","createImage","src","FontStylePromiseCache","Map","tempHTMLTextRenderData","HTMLTextSystem","_activeTextures","_createCanvas","WEBGPU","getTexture","getManagedTexture","textKey","_increaseReferenceCount","promise","_buildTexturePromise","then","usageCount","activeTexture","_cleanUp","htmlTextData","dedupe","matches","match","addFontFamily","fontFamily2","tagStyles","extractFontFamilies","fontCSS","async","fontPromises","map","entries","promises","entry","url","out","faces","face","weight","dataSrc","response","fetch","blob","reader","FileReader","Promise","resolve","reject","onloadend","onerror","readAsDataURL","loadFontAsBase64","loadFontCSS","all","css","getFontCss","measured","fontStyleCSS","htmlTextRenderData","innerHTML","cssStyle","textContent","body","contentBounds","getBoundingClientRect","doublePadding","measureHtmlText","svgURL","toString","XMLSerializer","serializeToString","getSVGUrl","delay","resolve2","setTimeout","onload","encodeURIComponent","crossOrigin","loadSVGImage","userAgent","getNavigator","isSafari","clearRect","drawImage","getTemporaryCanvasFromImage","initSource","return","TexturePool","returnTexture","key","WebGLSystem","WebGPUSystem","CanvasSystem","color32BitToUniform","abgr","PRECISION","textMetrics","setAlpha","toHexa","pattern","createPattern","tempMatrix","matrix","copyTo","setTransform","fillPattern","fillGradient","isLinear","isLocal","textureSpace","gradient","isNearlyVertical","createLinearGradient","center","innerRadius","outerCenter","outerRadius","createRadialGradient","ratio","colorStops","stop","globalStop","addColorStop","floor","toHex","FilterPipe","filterEffect","break","renderPipeId","canBundle","action","pop","_filterEffect","_container","execute","instruction","PassthroughFilter","Filter","GpuProgram","GlProgram","tempProjectionMatrix","quadGeometry","Geometry","attributes","aPosition","buffer","format","stride","indexBuffer","Uint32Array","FilterData","skip","inputTexture","backTexture","filters","Bounds","blendRequired","outputRenderSurface","globalFrame","firstEnabledIndex","lastEnabledIndex","FilterSystem","_filterStackIndex","_filterStack","_filterGlobalUniforms","uInputSize","uInputPixel","uInputClamp","uOutputFrame","uGlobalFrame","uOutputTexture","_globalFilterBindGroup","BindGroup","activeBackTexture","_activeFilterData","filterData","_pushFilterData","renderTarget","renderSurface","colorTextureSource","colorTexture","rootResolution","rootAntialias","antialias","every","enabled","_calculateFilterArea","_calculateFilterBounds","rootViewPort","previousFilterData","_getPreviousFilterData","globalResolution","_findFilterResolution","offsetX","_calculateGlobalFrame","_setupFilterTextures","generateFilteredTexture","addRect","rectangle","finishRenderPass","_applyFiltersToTexture","outputTexture","_popFilterData","globalUniforms","getBackTexture","lastRenderSurface","previousBounds","backgroundResolution","copyToTexture","applyFilter","input","output","isFinalTarget","rootRenderTarget","_findPreviousFilterOffset","_updateFilterUniforms","filterToApply","_getPassthroughFilter","_setupBindGroupsAndRender","calculateSpriteMatrix","outputMatrix","sprite","data","mappedMatrix","_source","worldTransform","cacheToLocalTransform","prepend","invert","anchor","_passthroughFilter","uniformBatch","batchUniforms","getUboResource","setResource","groups","encoder","draw","geometry","shader","state","_state","topology","WEBGL","getRenderTarget","bind","sourceWidth","sourceHeight","outputFrame","inputSize","inputPixel","inputClamp","pixelWidth","pixelHeight","rootTexture","isRoot","currentIndex","lastIndex","prevFilterData","renderables","actualMatrix","isCachedAsTexture","copyFrom","textureOffsetInverseTransform","append","_parentCacheAsTextureRenderGroup","inverseWorldTransform","addBounds","getGlobalRenderableBounds","filterArea","applyMatrix","getFastGlobalBounds","filterFrameTransform","firstEnabled","lastEnabled","apply","flip","tempTexture","flop","t","viewPort","paddingMultiplier","Infinity","clipToViewport","min","compatibleRenderers","backBuffer","useBackBuffer","fitBounds","pad","isPositive","contextSettings","willReadFrequently","_CanvasTextMetrics","experimentalLetterSpacingSupported","_experimentalLetterSpacingSupported","proto","getCanvasRenderingContext2D","prototype","lineWidths","maxLineWidth","_canvas","_measurementCache","__context","_wordWrap","_measureText","strokeWidth","leading","measurements","useExperimentalLetterSpacing","experimentalLetterSpacing","textLetterSpacing","metricWidth","actualBoundingBoxLeft","boundsWidth","actualBoundingBoxRight","val","getContext","cache","whiteSpace","collapseSpaces","_collapseSpaces","collapseNewlines","_collapseNewlines","canPrependSpaces","tokens","_tokenize","token","_isNewline","_addLine","currIsBreakingSpace","isBreakingSpace","lastIsBreakingSpace","tokenWidth","_getFromCache","canBreakWords","characters","wordWrapSplit","k","nextChar","canBreakChars","characterWidth","isLastToken","newLine","_trimRight","slice","_newlines","_nextChar","_breakingSpaces","_token","_char","_index","_breakWords","_fonts","_context","METRICS_STRING","BASELINE_SYMBOL","properties","actualBoundingBoxAscent","actualBoundingBoxDescent","clearMetrics","__canvas","OffscreenCanvas","createCanvas","_cx","BASELINE_MULTIPLIER","HEIGHT_MULTIPLIER","Intl","Segmenter","segmenter","s","segments","segment","ResizePlugin","init","defineProperty","dom","globalThis","removeEventListener","queueResize","_resizeTo","addEventListener","resize","_cancelResize","_resizeId","requestAnimationFrame","cancelAnimationFrame","window","innerWidth","innerHeight","clientWidth","clientHeight","render","resizeTo","Application","TickerPlugin","assign","autoStart","sharedTicker","ticker","_ticker","LOW","Ticker","oldTicker","_MeshGeometry","uvs","indices","shrinkToFit","shrinkBuffersToFit","label","usage","VERTEX","COPY_DST","aUV","INDEX","batchMode","MeshGeometry","BatchableText","canvasText","CanvasTextPipe","batchableText","_internalCanvas","_internalContext","checkRow","checkColumn","top","bottom","getCanvasBoundingBox","globalCompositeOperation","globalAlpha","ensureInternalCanvas","TypeError","getImageData","left","right","strokeRect","tempRect","CanvasTextGenerator","getCanvasAndContext","_renderTextToCanvas","resetTransform","lineCap","cap","linePositionX","linePositionY","passesCount","isShadowPass","dsOffsetText","dsOffsetShadow","dropShadowColor","dropShadowAlpha","toRgbaString","strokePadding","_drawLetterSpacing","isStroke","currentPosition","stringArray","previousWidth","currentWidth","currentChar","textStr","CanvasTextSystem","_textKey","filteredTexture","_applyFilters","renderTextToCanvas","currentRenderTarget","resultTexture","MeshGpuData","MeshPipe","adaptor","localUniformsBindGroup","_adaptor","mesh","meshData","_getMeshData","wasBatched","batched","isBatched","_geometry","indexSize","vertexSize","batchableMesh","_getBatchableMesh","_texture","_textureMatrixUpdateId","checkAndUpdateTexture","batcher","didViewUpdate","gpuBatchableMesh","setTexture","isRenderable","blendMode","getAdjustedBlendModeBlend","_a","_b","_initMeshData","_initBatchableMesh","gpuMesh","BatchableMesh","LRU","ttl","resetTtl","items","last","prev","next","keys","evict","bypass","expiresAt","expiry","undefined","Date","now","delete","moveToEnd","setWithEvicted","evicted","values","lru","isNaN","_Filter","for2d","addResource","filterManager","clearMode","gpu","gl","rest","_PlaneGeometry","verticesX","verticesY","build","verts","sizeX","sizeY","totalSub","xpos","ypos","value2","value3","value4","buffers","PlaneGeometry","_NineSliceGeometry","_originalWidth","originalWidth","_originalHeight","originalHeight","_leftWidth","leftWidth","_rightWidth","rightWidth","_topHeight","topHeight","_bottomHeight","bottomHeight","_anchorX","_anchorY","updatePositions","p","w","scaleW","h","scaleH","anchorOffsetX","anchorOffsetY","getBuffer","_uvw","_uvh","NineSliceGeometry","NineSliceSpriteGpuData","NineSliceSpritePipe","gpuSprite","_getGpuSprite","_updateBatchableSprite","_initGPUSprite","gpuData","blendModeIds","normal","multiply","screen","overlay","erase","_State","polygonOffset","blend","depthMask","offsets","cullMode","culling","clockwiseFrontFace","depthTest","_blendMode","_blendModeId","_polygonOffset","default2d","State","canvasOptions","_canvasPool","enableFullScreen","_createCanvasAndContext","minWidth","minHeight","register","_TextStyle","_tick","oldStyle","defaults","defaultDropShadow","dropShadowAngle","obj","isColorLike","hasOwnProperty","call","fillGradientStops","gradientFill","fills","toNumber","convertV7Tov8Style","fullStyle","defaultTextStyle","_align","_dropShadow","_createProxy","_fontFamily","_fontSize","parseInt","_fontStyle","toLowerCase","_fontVariant","_fontWeight","_leading","_letterSpacing","_lineHeight","_filters","freeze","_trim","_textBaseline","_whiteSpace","_wordWrapWidth","_originalFill","_isFillStyle","defaultFillStyle","_originalStroke","defaultStrokeStyle","reset","defaultStyle","filterPadding","destroyTextureSource","cb","Proxy","target","property","newValue","PI","batcherName","attributeSize","packAsQuad","_attributeStart","_batch","tilingBit","tilingBitGl","TilingSpriteShader","tilingUniforms","uMapCoord","uClampFrame","uClampOffset","uTextureTransform","uSizeAnchor","uTexture","uSampler","updateUniforms","anchorX","anchorY","textureWidth","textureHeight","textureMatrix","mapCoord","QuadGeometry","sharedQuad","TilingSpriteGpuData","canBatch","TilingSpritePipe","tilingSpriteData","_getTilingSpriteData","couldBatch","_updateCanBatch","tilingSprite","_updateBatchableMesh","bindGroup","_tileTransform","_initTilingSpriteData","renderableData","addressMode","applyAnchorToTexture","array","setUvs","setPositions","_nonPowOf2wrapping","supports","nonPowOf2wrapping","isSimple","isPowerOfTwo","indexOffset","attributeOffset","_uvUpdateId","_topology","uvBuffer","transformedUvs","_transformedUvs","_updateID","multiplyUvs","GraphicsGpuData","batches","GraphicsPipe","contextChange","gpuContext","graphicsContext","updateGpuContext","isBatchable","_rebuild","_addToBatcher","_getGpuDataForRenderable","getGpuContext","_updateBatchesForRenderable","batchPipe","_initGpuDataForRenderable","batchClone","BatchableGraphics","GraphicsContextSystem","GlParticleContainerAdaptor","particleContainerPipe","defaultShader","getBuffers","glType","BYTES_PER_ELEMENT","UNSIGNED_SHORT","UNSIGNED_INT","drawElements","TRIANGLES","particleChildren","createIndicesForQuads","outBuffer","totalIndices","Uint16Array","generateUpdateFunction","dynamic","funcFragments","code","getAttributeInfoFromFormat","unshift","functionSource","Function","ParticleBuffer","_size","_generateParticleUpdateCache","staticVertexSize","dynamicVertexSize","attributeInfo","_dynamicStride","_staticStride","staticAttributeBuffer","ViewableBuffer","dynamicAttributeBuffer","dynamicOffset","staticOffset","_staticBuffer","Buffer","_dynamicBuffer","addAttribute","attributeName","addIndex","uploadFunction","getParticleUpdate","_dynamicUpload","dynamicUpdate","_staticUpload","staticUpdate","keyGen","getParticleSyncKey","generateParticleUpdate","generateParticleUpdateFunction","particles","uploadStatic","setDataWithSize","byteLength","float32View","uint32View","wgsl","ParticleShader","entryPoint","uTranslationMatrix","uResolution","ParticleContainerPipe","_renderable","_initBuffer","_properties","children","_childrenDirty","transformationMatrix","globalUniformData","projectionMatrix","GlParticleContainerPipe","GpuParticleContainerAdaptor","getUniformBindGroup","getTextureBindGroup","GpuParticleContainerPipe"],"sourceRoot":""}